/*! For license information please see taskpane.js.LICENSE.txt */
(self.webpackChunkoffice_addin_taskpane_react=self.webpackChunkoffice_addin_taskpane_react||[]).push([[926],{2694:function(e,t,r){"use strict";var n=r(6925);function o(){}function i(){}i.resetWarningCache=o,e.exports=function(){function e(e,t,r,o,i,a){if(a!==n){var s=new Error("Calling PropTypes validators directly is not supported by the `prop-types` package. Use PropTypes.checkPropTypes() to call them. Read more at http://fb.me/use-check-prop-types");throw s.name="Invariant Violation",s}}function t(){return e}e.isRequired=e;var r={array:e,bigint:e,bool:e,func:e,number:e,object:e,string:e,symbol:e,any:e,arrayOf:t,element:e,elementType:e,instanceOf:t,node:e,objectOf:t,oneOf:t,oneOfType:t,shape:t,exact:t,checkPropTypes:i,resetWarningCache:o};return r.PropTypes=r,r}},5338:function(e,t,r){"use strict";var n=r(40961);t.H=n.createRoot,n.hydrateRoot},5556:function(e,t,r){e.exports=r(2694)()},6925:function(e){"use strict";e.exports="SECRET_DO_NOT_PASS_THIS_OR_YOU_WILL_BE_FIRED"},20311:function(e){"use strict";e.exports=function(e,t,r,n,o,i,a,s){if(!e){var c;if(void 0===t)c=new Error("Minified exception occurred; use the non-minified dev environment for the full error message and additional helpful warnings.");else{var l=[r,n,o,i,a,s],u=0;(c=new Error(t.replace(/%s/g,function(){return l[u++]}))).name="Invariant Violation"}throw c.framesToPop=1,c}}},21020:function(e,t,r){"use strict";var n=r(96540),o=Symbol.for("react.element"),i=Symbol.for("react.fragment"),a=Object.prototype.hasOwnProperty,s=n.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,c={key:!0,ref:!0,__self:!0,__source:!0};function l(e,t,r){var n,i={},l=null,u=null;for(n in void 0!==r&&(l=""+r),void 0!==t.key&&(l=""+t.key),void 0!==t.ref&&(u=t.ref),t)a.call(t,n)&&!c.hasOwnProperty(n)&&(i[n]=t[n]);if(e&&e.defaultProps)for(n in t=e.defaultProps)void 0===i[n]&&(i[n]=t[n]);return{$$typeof:o,type:e,key:l,ref:u,props:i,_owner:s.current}}t.Fragment=i,t.jsx=l,t.jsxs=l},22799:function(e,t){"use strict";if("function"==typeof Symbol&&Symbol.for){var r=Symbol.for;r("react.element"),r("react.portal"),r("react.fragment"),r("react.strict_mode"),r("react.profiler"),r("react.provider"),r("react.context"),r("react.forward_ref"),r("react.suspense"),r("react.suspense_list"),r("react.memo"),r("react.lazy"),r("react.block"),r("react.server.block"),r("react.fundamental"),r("react.debug_trace_mode"),r("react.legacy_hidden")}},39046:function(){},44363:function(e,t,r){"use strict";r(22799)},48561:function(e,t,r){"use strict";var n=r(96540),o=r.t(n,2),i=r(5338);const a=()=>{const e={};return function(t,r){void 0===e[t.id]&&(t.insertCSSRules(r),e[t.id]=!0)}};function s(e){for(var t,r=0,n=0,o=e.length;o>=4;++n,o-=4)t=1540483477*(65535&(t=255&e.charCodeAt(n)|(255&e.charCodeAt(++n))<<8|(255&e.charCodeAt(++n))<<16|(255&e.charCodeAt(++n))<<24))+(59797*(t>>>16)<<16),r=1540483477*(65535&(t^=t>>>24))+(59797*(t>>>16)<<16)^1540483477*(65535&r)+(59797*(r>>>16)<<16);switch(o){case 3:r^=(255&e.charCodeAt(n+2))<<16;case 2:r^=(255&e.charCodeAt(n+1))<<8;case 1:r=1540483477*(65535&(r^=255&e.charCodeAt(n)))+(59797*(r>>>16)<<16)}return(((r=1540483477*(65535&(r^=r>>>13))+(59797*(r>>>16)<<16))^r>>>15)>>>0).toString(36)}function c(e){return e.reduce(function(e,t){var r=t[0],n=t[1];return e[r]=n,e[n]=r,e},{})}function l(e){return"number"==typeof e}function u(e,t){return-1!==e.indexOf(t)}function d(e,t,r,n){return t+(o=r,0===parseFloat(o)?o:"-"===o[0]?o.slice(1):"-"+o)+n;var o}function h(e){return e.replace(/ +/g," ").split(" ").map(function(e){return e.trim()}).filter(Boolean).reduce(function(e,t){var r=e.list,n=e.state,o=(t.match(/\(/g)||[]).length,i=(t.match(/\)/g)||[]).length;return n.parensDepth>0?r[r.length-1]=r[r.length-1]+" "+t:r.push(t),n.parensDepth+=o-i,{list:r,state:n}},{list:[],state:{parensDepth:0}}).list}function g(e){var t=h(e);if(t.length<=3||t.length>4)return e;var r=t[0],n=t[1],o=t[2];return[r,t[3],o,n].join(" ")}var p={padding:function(e){var t=e.value;return l(t)?t:g(t)},textShadow:function(e){return function(e){for(var t=[],r=0,n=0,o=!1;n<e.length;)o||","!==e[n]?"("===e[n]?(o=!0,n++):")"===e[n]?(o=!1,n++):n++:(t.push(e.substring(r,n).trim()),r=++n);return r!=n&&t.push(e.substring(r,n+1)),t}(e.value).map(function(e){return e.replace(/(^|\s)(-*)([.|\d]+)/,function(e,t,r,n){return"0"===n?e:t+(""===r?"-":"")+n})}).join(",")},borderColor:function(e){return g(e.value)},borderRadius:function(e){var t=e.value;if(l(t))return t;if(u(t,"/")){var r=t.split("/"),n=r[0],o=r[1];return p.borderRadius({value:n.trim()})+" / "+p.borderRadius({value:o.trim()})}var i=h(t);switch(i.length){case 2:return i.reverse().join(" ");case 4:var a=i[0],s=i[1],c=i[2];return[s,a,i[3],c].join(" ");default:return t}},background:function(e){var t=e.value,r=e.valuesToConvert,n=e.isRtl,o=e.bgImgDirectionRegex,i=e.bgPosDirectionRegex;if(l(t))return t;var a=t.replace(/(url\(.*?\))|(rgba?\(.*?\))|(hsl\(.*?\))|(#[a-fA-F0-9]+)|((^| )(\D)+( |$))/g,"").trim();return t=t.replace(a,p.backgroundPosition({value:a,valuesToConvert:r,isRtl:n,bgPosDirectionRegex:i})),p.backgroundImage({value:t,valuesToConvert:r,bgImgDirectionRegex:o})},backgroundImage:function(e){var t=e.value,r=e.valuesToConvert,n=e.bgImgDirectionRegex;return u(t,"url(")||u(t,"linear-gradient(")?t.replace(n,function(e,t,n){return e.replace(n,r[n])}):t},backgroundPosition:function(e){var t=e.value,r=e.valuesToConvert,n=e.isRtl,o=e.bgPosDirectionRegex;return t.replace(n?/^((-|\d|\.)+%)/:null,function(e,t){return function(e){var t=e.indexOf(".");if(-1===t)e=100-parseFloat(e)+"%";else{var r=e.length-t-2;e=(e=100-parseFloat(e)).toFixed(r)+"%"}return e}(t)}).replace(o,function(e){return r[e]})},backgroundPositionX:function(e){var t=e.value,r=e.valuesToConvert,n=e.isRtl,o=e.bgPosDirectionRegex;return l(t)?t:p.backgroundPosition({value:t,valuesToConvert:r,isRtl:n,bgPosDirectionRegex:o})},transition:function(e){var t=e.value,r=e.propertiesToConvert;return t.split(/,\s*/g).map(function(e){var t=e.split(" ");return t[0]=r[t[0]]||t[0],t.join(" ")}).join(", ")},transitionProperty:function(e){var t=e.value,r=e.propertiesToConvert;return t.split(/,\s*/g).map(function(e){return r[e]||e}).join(", ")},transform:function(e){var t=e.value,r="[^\\u0020-\\u007e]",n="(?:(?:(?:\\[0-9a-f]{1,6})(?:\\r\\n|\\s)?)|\\\\[^\\r\\n\\f0-9a-f])",o="((?:-?(?:[0-9]*\\.[0-9]+|[0-9]+)(?:\\s*(?:em|ex|px|cm|mm|in|pt|pc|deg|rad|grad|ms|s|hz|khz|%)|-?(?:[_a-z]|"+r+"|"+n+")(?:[_a-z0-9-]|"+r+"|"+n+")*)?)|(?:inherit|auto))",i=new RegExp("(translateX\\s*\\(\\s*)"+o+"(\\s*\\))","gi"),a=new RegExp("(translate\\s*\\(\\s*)"+o+"((?:\\s*,\\s*"+o+"){0,1}\\s*\\))","gi"),s=new RegExp("(translate3d\\s*\\(\\s*)"+o+"((?:\\s*,\\s*"+o+"){0,2}\\s*\\))","gi"),c=new RegExp("(rotate[ZY]?\\s*\\(\\s*)"+o+"(\\s*\\))","gi");return t.replace(i,d).replace(a,d).replace(s,d).replace(c,d)}};p.objectPosition=p.backgroundPosition,p.margin=p.padding,p.borderWidth=p.padding,p.boxShadow=p.textShadow,p.webkitBoxShadow=p.boxShadow,p.mozBoxShadow=p.boxShadow,p.WebkitBoxShadow=p.boxShadow,p.MozBoxShadow=p.boxShadow,p.borderStyle=p.borderColor,p.webkitTransform=p.transform,p.mozTransform=p.transform,p.WebkitTransform=p.transform,p.MozTransform=p.transform,p.transformOrigin=p.backgroundPosition,p.webkitTransformOrigin=p.transformOrigin,p.mozTransformOrigin=p.transformOrigin,p.WebkitTransformOrigin=p.transformOrigin,p.MozTransformOrigin=p.transformOrigin,p.webkitTransition=p.transition,p.mozTransition=p.transition,p.WebkitTransition=p.transition,p.MozTransition=p.transition,p.webkitTransitionProperty=p.transitionProperty,p.mozTransitionProperty=p.transitionProperty,p.WebkitTransitionProperty=p.transitionProperty,p.MozTransitionProperty=p.transitionProperty,p["text-shadow"]=p.textShadow,p["border-color"]=p.borderColor,p["border-radius"]=p.borderRadius,p["background-image"]=p.backgroundImage,p["background-position"]=p.backgroundPosition,p["background-position-x"]=p.backgroundPositionX,p["object-position"]=p.objectPosition,p["border-width"]=p.padding,p["box-shadow"]=p.textShadow,p["-webkit-box-shadow"]=p.textShadow,p["-moz-box-shadow"]=p.textShadow,p["border-style"]=p.borderColor,p["-webkit-transform"]=p.transform,p["-moz-transform"]=p.transform,p["transform-origin"]=p.transformOrigin,p["-webkit-transform-origin"]=p.transformOrigin,p["-moz-transform-origin"]=p.transformOrigin,p["-webkit-transition"]=p.transition,p["-moz-transition"]=p.transition,p["transition-property"]=p.transitionProperty,p["-webkit-transition-property"]=p.transitionProperty,p["-moz-transition-property"]=p.transitionProperty;var f=c([["paddingLeft","paddingRight"],["marginLeft","marginRight"],["left","right"],["borderLeft","borderRight"],["borderLeftColor","borderRightColor"],["borderLeftStyle","borderRightStyle"],["borderLeftWidth","borderRightWidth"],["borderTopLeftRadius","borderTopRightRadius"],["borderBottomLeftRadius","borderBottomRightRadius"],["padding-left","padding-right"],["margin-left","margin-right"],["border-left","border-right"],["border-left-color","border-right-color"],["border-left-style","border-right-style"],["border-left-width","border-right-width"],["border-top-left-radius","border-top-right-radius"],["border-bottom-left-radius","border-bottom-right-radius"]]),m=["content"],y=c([["ltr","rtl"],["left","right"],["w-resize","e-resize"],["sw-resize","se-resize"],["nw-resize","ne-resize"]]),v=new RegExp("(^|\\W|_)((ltr)|(rtl)|(left)|(right))(\\W|_|$)","g"),b=new RegExp("(left)|(right)");function C(e){return Object.keys(e).reduce(function(t,r){var n=e[r];if("string"==typeof n&&(n=n.trim()),u(m,r))return t[r]=n,t;var o=w(r,n),i=o.key,a=o.value;return t[i]=a,t},Array.isArray(e)?[]:{})}function w(e,t){var r,n=/\/\*\s?@noflip\s?\*\//.test(t),o=n?e:f[r=e]||r,i=n?t:function(e,t){if(!function(e){return!("boolean"==typeof e||function(e){return null==e}(e))}(t))return t;if((r=t)&&"object"==typeof r)return C(t);var r,n,o=l(t),i=function(e){return"function"==typeof e}(t),a=o||i?t:t.replace(/ !important.*?$/,""),s=!o&&a.length!==t.length,c=p[e];return n=c?c({value:a,valuesToConvert:y,propertiesToConvert:f,isRtl:!0,bgImgDirectionRegex:v,bgPosDirectionRegex:b}):y[a]||a,s?n+" !important":n}(o,t);return{key:o,value:i}}const k="undefined"==typeof window?r.g:window,I="@griffel/";function A(e,t){return k[Symbol.for(I+e)]||(k[Symbol.for(I+e)]=t),k[Symbol.for(I+e)]}const T=A("DEFINITION_LOOKUP_TABLE",{}),S="data-make-styles-bucket",E={all:1,borderColor:1,borderStyle:1,borderWidth:1,borderBlock:1,borderBlockEnd:1,borderBlockStart:1,borderInline:1,borderInlineEnd:1,borderInlineStart:1},_="DO_NOT_USE_DIRECTLY: @griffel/reset-value",P=/[A-Z]/g,R=/^ms-/,O={};function M(e){return"-"+e.toLowerCase()}function N(e){if(Object.prototype.hasOwnProperty.call(O,e))return O[e];if("--"===e.substr(0,2))return e;const t=e.replace(P,M);return O[e]=R.test(t)?"-"+t:t}function x(e){return"&"===e.charAt(0)?e.slice(1):e}var F="-moz-",B="-webkit-",D="comm",q="rule",L="decl",H="@layer",U=Math.abs,j=String.fromCharCode,$=Object.assign;function z(e){return e.trim()}function K(e,t){return(e=t.exec(e))?e[0]:e}function W(e,t,r){return e.replace(t,r)}function G(e,t,r){return e.indexOf(t,r)}function V(e,t){return 0|e.charCodeAt(t)}function Q(e,t,r){return e.slice(t,r)}function J(e){return e.length}function Y(e){return e.length}function X(e,t){return t.push(e),e}function Z(e,t){for(var r="",n=0;n<e.length;n++)r+=t(e[n],n,e,t)||"";return r}function ee(e,t,r,n){switch(e.type){case H:if(e.children.length)break;case"@import":case"@namespace":case L:return e.return=e.return||e.value;case D:return"";case"@keyframes":return e.return=e.value+"{"+Z(e.children,n)+"}";case q:if(!J(e.value=e.props.join(",")))return""}return J(r=Z(e.children,n))?e.return=e.value+"{"+r+"}":""}var te=1,re=1,ne=0,oe=0,ie=0,ae="";function se(e,t,r,n,o,i,a,s){return{value:e,root:t,parent:r,type:n,props:o,children:i,line:te,column:re,length:a,return:"",siblings:s}}function ce(e,t){return $(se("",null,null,"",null,null,0,e.siblings),e,{length:-e.length},t)}function le(){return ie=oe>0?V(ae,--oe):0,re--,10===ie&&(re=1,te--),ie}function ue(){return ie=oe<ne?V(ae,oe++):0,re++,10===ie&&(re=1,te++),ie}function de(){return V(ae,oe)}function he(){return oe}function ge(e,t){return Q(ae,e,t)}function pe(e){switch(e){case 0:case 9:case 10:case 13:case 32:return 5;case 33:case 43:case 44:case 47:case 62:case 64:case 126:case 59:case 123:case 125:return 4;case 58:return 3;case 34:case 39:case 40:case 91:return 2;case 41:case 93:return 1}return 0}function fe(e){return te=re=1,ne=J(ae=e),oe=0,[]}function me(e){return ae="",e}function ye(e){return z(ge(oe-1,Ce(91===e?e+2:40===e?e+1:e)))}function ve(e){for(;(ie=de())&&ie<33;)ue();return pe(e)>2||pe(ie)>3?"":" "}function be(e,t){for(;--t&&ue()&&!(ie<48||ie>102||ie>57&&ie<65||ie>70&&ie<97););return ge(e,he()+(t<6&&32==de()&&32==ue()))}function Ce(e){for(;ue();)switch(ie){case e:return oe;case 34:case 39:34!==e&&39!==e&&Ce(ie);break;case 40:41===e&&Ce(e);break;case 92:ue()}return oe}function we(e,t){for(;ue()&&e+ie!==57&&(e+ie!==84||47!==de()););return"/*"+ge(t,oe-1)+"*"+j(47===e?e:ue())}function ke(e){for(;!pe(de());)ue();return ge(e,oe)}function Ie(e){return me(Ae("",null,null,null,[""],e=fe(e),0,[0],e))}function Ae(e,t,r,n,o,i,a,s,c){for(var l=0,u=0,d=a,h=0,g=0,p=0,f=1,m=1,y=1,v=0,b="",C=o,w=i,k=n,I=b;m;)switch(p=v,v=ue()){case 40:if(108!=p&&58==V(I,d-1)){-1!=G(I+=W(ye(v),"&","&\f"),"&\f",U(l?s[l-1]:0))&&(y=-1);break}case 34:case 39:case 91:I+=ye(v);break;case 9:case 10:case 13:case 32:I+=ve(p);break;case 92:I+=be(he()-1,7);continue;case 47:switch(de()){case 42:case 47:X(Se(we(ue(),he()),t,r,c),c),5!=pe(p||1)&&5!=pe(de()||1)||!J(I)||" "===Q(I,-1,void 0)||(I+=" ");break;default:I+="/"}break;case 123*f:s[l++]=J(I)*y;case 125*f:case 59:case 0:switch(v){case 0:case 125:m=0;case 59+u:-1==y&&(I=W(I,/\f/g,"")),g>0&&(J(I)-d||0===f&&47===p)&&X(g>32?Ee(I+";",n,r,d-1,c):Ee(W(I," ","")+";",n,r,d-2,c),c);break;case 59:I+=";";default:if(X(k=Te(I,t,r,l,u,o,s,b,C=[],w=[],d,i),i),123===v)if(0===u)Ae(I,t,k,k,C,i,d,s,w);else{switch(h){case 99:if(110===V(I,3))break;case 108:if(97===V(I,2))break;default:u=0;case 100:case 109:case 115:}u?Ae(e,k,k,n&&X(Te(e,k,k,0,0,o,s,b,o,C=[],d,w),w),o,w,d,s,n?C:w):Ae(I,k,k,k,[""],w,0,s,w)}}l=u=g=0,f=y=1,b=I="",d=a;break;case 58:d=1+J(I),g=p;default:if(f<1)if(123==v)--f;else if(125==v&&0==f++&&125==le())continue;switch(I+=j(v),v*f){case 38:y=u>0?1:(I+="\f",-1);break;case 44:s[l++]=(J(I)-1)*y,y=1;break;case 64:45===de()&&(I+=ye(ue())),h=de(),u=d=J(b=I+=ke(he())),v++;break;case 45:45===p&&2==J(I)&&(f=0)}}return i}function Te(e,t,r,n,o,i,a,s,c,l,u,d){for(var h=o-1,g=0===o?i:[""],p=Y(g),f=0,m=0,y=0;f<n;++f)for(var v=0,b=Q(e,h+1,h=U(m=a[f])),C=e;v<p;++v)(C=z(m>0?g[v]+" "+b:W(b,/&\f/g,g[v])))&&(c[y++]=C);return se(e,t,r,0===o?q:s,c,l,u,d)}function Se(e,t,r,n){return se(e,t,r,D,j(ie),Q(e,2,-2),0,n)}function Ee(e,t,r,n,o){return se(e,t,r,L,Q(e,0,n),Q(e,n+1,-1),n,o)}function _e(e){var t=Y(e);return function(r,n,o,i){for(var a="",s=0;s<t;s++)a+=e[s](r,n,o,i)||"";return a}}function Pe(e){return function(t){t.root||(t=t.return)&&e(t)}}const Re=e=>{if(e.type===q){if("string"==typeof e.props)return;e.props=e.props.map(e=>-1===e.indexOf(":global(")?e:function(e){return me(function(e){for(;ue();)switch(pe(ie)){case 0:X(ke(oe-1),e);break;case 2:X(ye(ie),e);break;default:X(j(ie),e)}return e}(fe(e)))}(e).reduce((e,t,r,n)=>{if(""===t)return e;if(":"===t&&"global"===n[r+1]){const t=n[r+2].slice(1,-1)+" ";return e.unshift(t),n[r+1]="",n[r+2]="",e}return e.push(t),e},[]).join(""))}};function Oe(e,t,r){switch(function(e,t){return 45^V(e,0)?(((t<<2^V(e,0))<<2^V(e,1))<<2^V(e,2))<<2^V(e,3):0}(e,t)){case 5103:return B+"print-"+e+e;case 3191:case 6645:case 3005:case 6391:case 5879:case 5623:case 6135:case 4599:case 4855:return B+e+e;case 4215:if(102===V(e,9))return B+e+e;if(116===V(e,t+1))return B+e+e;break;case 4789:return F+e+e;case 5349:case 4246:case 6968:return B+e+F+e+e;case 6187:if(!K(e,/grab/))return W(W(W(e,/(zoom-|grab)/,B+"$1"),/(image-set)/,B+"$1"),e,"")+e;case 5495:case 3959:return W(e,/(image-set\([^]*)/,B+"$1$`$1");case 4095:case 3583:case 4068:case 2532:return W(e,/(.+)-inline(.+)/,B+"$1$2")+e;case 8116:case 7059:case 5753:case 5535:case 5445:case 5701:case 4933:case 4677:case 5533:case 5789:case 5021:case 4765:if(J(e)-1-t>6)switch(V(e,t+1)){case 102:if(108===V(e,t+3))return W(e,/(.+:)(.+)-([^]+)/,"$1"+B+"$2-$3$1"+F+(108==V(e,t+3)?"$3":"$2-$3"))+e;case 115:return~G(e,"stretch")?Oe(W(e,"stretch","fill-available"),t)+e:e}}return e}function Me(e,t,r,n){if(e.length>-1&&!e.return)switch(e.type){case L:return void(e.return=Oe(e.value,e.length));case q:if(e.length)return function(e,t){return e.map(t).join("")}(e.props,function(t){switch(K(t,/(::plac\w+|:read-\w+)/)){case":read-only":case":read-write":return Z([ce(e,{props:[W(t,/:(read-\w+)/,":-moz-$1")]})],n);case"::placeholder":return Z([ce(e,{props:[W(t,/:(plac\w+)/,":"+B+"input-$1")]}),ce(e,{props:[W(t,/:(plac\w+)/,":-moz-$1")]})],n)}return""})}}const Ne=e=>{(function(e){switch(e.type){case"@container":case"@media":case"@supports":case H:return!0}return!1})(e)&&Array.isArray(e.children)&&e.children.sort((e,t)=>e.props[0]>t.props[0]?1:-1)};const xe=/,( *[^ &])/g;function Fe(e,t,r){let n=t;return r.length>0&&(n=r.reduceRight((e,t)=>{return`${r=t,"&"+x(r.replace(xe,",&$1"))} { ${e} }`;var r},t)),`${e}{${n}}`}function Be(e,t){const{className:r,selectors:n,property:o,rtlClassName:i,rtlProperty:a,rtlValue:s,value:c}=e,{container:l,layer:u,media:d,supports:h}=t;let g=Fe(`.${r}`,Array.isArray(c)?`${c.map(e=>`${N(o)}: ${e}`).join(";")};`:`${N(o)}: ${c};`,n);return a&&i&&(g+=Fe(`.${i}`,Array.isArray(s)?`${s.map(e=>`${N(a)}: ${e}`).join(";")};`:`${N(a)}: ${s};`,n)),d&&(g=`@media ${d} { ${g} }`),u&&(g=`@layer ${u} { ${g} }`),h&&(g=`@supports ${h} { ${g} }`),l&&(g=`@container ${l} { ${g} }`),function(e){const t=[];return Z(Ie(e),_e([Re,Ne,Me,ee,Pe(e=>t.push(e))])),t}(g)}function De(e){let t="";for(const r in e){const n=e[r];if("string"!=typeof n&&"number"!=typeof n){if(Array.isArray(n))for(const e of n)t+=N(r)+":"+e+";"}else t+=N(r)+":"+n+";"}return t}function qe(e){let t="";for(const r in e)t+=`${r}{${De(e[r])}}`;return t}function Le(e,t){const r=[];return Z(Ie(`@keyframes ${e} {${t}}`),_e([ee,Me,Pe(e=>r.push(e))])),r}const He={animation:[-1,["animationDelay","animationDirection","animationDuration","animationFillMode","animationIterationCount","animationName","animationPlayState","animationTimeline","animationTimingFunction"]],animationRange:[-1,["animationRangeEnd","animationRangeStart"]],background:[-2,["backgroundAttachment","backgroundClip","backgroundColor","backgroundImage","backgroundOrigin","backgroundPosition","backgroundPositionX","backgroundPositionY","backgroundRepeat","backgroundSize"]],backgroundPosition:[-1,["backgroundPositionX","backgroundPositionY"]],border:[-2,["borderBottom","borderBottomColor","borderBottomStyle","borderBottomWidth","borderLeft","borderLeftColor","borderLeftStyle","borderLeftWidth","borderRight","borderRightColor","borderRightStyle","borderRightWidth","borderTop","borderTopColor","borderTopStyle","borderTopWidth"]],borderBottom:[-1,["borderBottomColor","borderBottomStyle","borderBottomWidth"]],borderImage:[-1,["borderImageOutset","borderImageRepeat","borderImageSlice","borderImageSource","borderImageWidth"]],borderLeft:[-1,["borderLeftColor","borderLeftStyle","borderLeftWidth"]],borderRadius:[-1,["borderBottomLeftRadius","borderBottomRightRadius","borderTopLeftRadius","borderTopRightRadius"]],borderRight:[-1,["borderRightColor","borderRightStyle","borderRightWidth"]],borderTop:[-1,["borderTopColor","borderTopStyle","borderTopWidth"]],caret:[-1,["caretColor","caretShape"]],columnRule:[-1,["columnRuleColor","columnRuleStyle","columnRuleWidth"]],columns:[-1,["columnCount","columnWidth"]],containIntrinsicSize:[-1,["containIntrinsicHeight","containIntrinsicWidth"]],container:[-1,["containerName","containerType"]],flex:[-1,["flexBasis","flexGrow","flexShrink"]],flexFlow:[-1,["flexDirection","flexWrap"]],font:[-1,["fontFamily","fontSize","fontStretch","fontStyle","fontVariant","fontWeight","lineHeight"]],gap:[-1,["columnGap","rowGap"]],grid:[-1,["columnGap","gridAutoColumns","gridAutoFlow","gridAutoRows","gridColumnGap","gridRowGap","gridTemplateAreas","gridTemplateColumns","gridTemplateRows","rowGap"]],gridArea:[-1,["gridColumnEnd","gridColumnStart","gridRowEnd","gridRowStart"]],gridColumn:[-1,["gridColumnEnd","gridColumnStart"]],gridRow:[-1,["gridRowEnd","gridRowStart"]],gridTemplate:[-1,["gridTemplateAreas","gridTemplateColumns","gridTemplateRows"]],inset:[-1,["bottom","left","right","top"]],insetBlock:[-1,["insetBlockEnd","insetBlockStart"]],insetInline:[-1,["insetInlineEnd","insetInlineStart"]],listStyle:[-1,["listStyleImage","listStylePosition","listStyleType"]],margin:[-1,["marginBottom","marginLeft","marginRight","marginTop"]],marginBlock:[-1,["marginBlockEnd","marginBlockStart"]],marginInline:[-1,["marginInlineEnd","marginInlineStart"]],mask:[-1,["maskClip","maskComposite","maskImage","maskMode","maskOrigin","maskPosition","maskRepeat","maskSize"]],maskBorder:[-1,["maskBorderMode","maskBorderOutset","maskBorderRepeat","maskBorderSlice","maskBorderSource","maskBorderWidth"]],offset:[-1,["offsetAnchor","offsetDistance","offsetPath","offsetPosition","offsetRotate"]],outline:[-1,["outlineColor","outlineStyle","outlineWidth"]],overflow:[-1,["overflowX","overflowY"]],overscrollBehavior:[-1,["overscrollBehaviorX","overscrollBehaviorY"]],padding:[-1,["paddingBottom","paddingLeft","paddingRight","paddingTop"]],paddingBlock:[-1,["paddingBlockEnd","paddingBlockStart"]],paddingInline:[-1,["paddingInlineEnd","paddingInlineStart"]],placeContent:[-1,["alignContent","justifyContent"]],placeItems:[-1,["alignItems","justifyItems"]],placeSelf:[-1,["alignSelf","justifySelf"]],scrollMargin:[-1,["scrollMarginBottom","scrollMarginLeft","scrollMarginRight","scrollMarginTop"]],scrollMarginBlock:[-1,["scrollMarginBlockEnd","scrollMarginBlockStart"]],scrollMarginInline:[-1,["scrollMarginInlineEnd","scrollMarginInlineStart"]],scrollPadding:[-1,["scrollPaddingBottom","scrollPaddingLeft","scrollPaddingRight","scrollPaddingTop"]],scrollPaddingBlock:[-1,["scrollPaddingBlockEnd","scrollPaddingBlockStart"]],scrollPaddingInline:[-1,["scrollPaddingInlineEnd","scrollPaddingInlineStart"]],scrollTimeline:[-1,["scrollTimelineAxis","scrollTimelineName"]],textDecoration:[-1,["textDecorationColor","textDecorationLine","textDecorationStyle","textDecorationThickness"]],textEmphasis:[-1,["textEmphasisColor","textEmphasisStyle"]],transition:[-1,["transitionBehavior","transitionDelay","transitionDuration","transitionProperty","transitionTimingFunction"]],viewTimeline:[-1,["viewTimelineAxis","viewTimelineName"]]};function Ue(e,t){return 0===e.length?t:`${e} and ${t}`}function je(e){return"@media"===e.substr(0,6)}function $e(e){return"@layer"===e.substr(0,6)}const ze=/^(:|\[|>|&)/;function Ke(e){return ze.test(e)}function We(e){return"@supports"===e.substr(0,9)}function Ge(e){return"@container"===e.substring(0,10)}function Ve(e){return null!=e&&"object"==typeof e&&!1===Array.isArray(e)}const Qe={"us-w":"w","us-v":"i",nk:"l",si:"v",cu:"f",ve:"h",ti:"a"};function Je(e,t){if(t.media)return"m";if(t.layer||t.supports)return"t";if(t.container)return"c";if(e.length>0){const t=e[0].trim();if(58===t.charCodeAt(0))return Qe[t.slice(4,8)]||Qe[t.slice(3,5)]||"d"}return"d"}function Ye(e,t){return e?t+e:e}function Xe(e){return Ye(e.container,"c")+Ye(e.media,"m")+Ye(e.layer,"l")+Ye(e.supports,"s")}function Ze(e,t,r){const n=s(e+Xe(r)+t),o=n.charCodeAt(0);return o>=48&&o<=57?String.fromCharCode(o+17)+n.slice(1):n}function et({property:e,selector:t,salt:r,value:n},o){return"f"+s(r+t+Xe(o)+e+n.trim())}function tt(e){return e===_}function rt(e){return e.replace(/>\s+/g,">")}function nt(e,t){}function ot(e,t){}function it(e){return He[e]}function at(e){var t;return null!==(t=null==e?void 0:e[0])&&void 0!==t?t:0}function st(e,t,r,n){e[t]=n?[r,n]:r}function ct(e,t){return t.length>0?[e,Object.fromEntries(t)]:e}function lt(e,t,r,n,o,i){var a;const s=[];0!==i&&s.push(["p",i]),"m"===t&&o&&s.push(["m",o]),null!==(a=e[t])&&void 0!==a||(e[t]=[]),r&&e[t].push(ct(r,s)),n&&e[t].push(ct(n,s))}function ut(e,t="",r=[],n={container:"",layer:"",media:"",supports:""},o={},i={},a){for(const c in e){if(E.hasOwnProperty(c)){ot(0,e[c]);continue}const l=e[c];if(null!=l){if(tt(l)){st(o,Ze(rt(r.join("")),c,n),0,void 0);continue}if("string"==typeof l||"number"==typeof l){const e=rt(r.join("")),s=it(c);if(s){const e=s[1],a=Object.fromEntries(e.map(e=>[e,_]));ut(a,t,r,n,o,i)}const u=Ze(e,c,n),d=et({value:l.toString(),salt:t,selector:e,property:c},n),h=a&&{key:c,value:a}||w(c,l),g=h.key!==c||h.value!==l,p=g?et({value:h.value.toString(),property:h.key,salt:t,selector:e},n):void 0,f=g?{rtlClassName:p,rtlProperty:h.key,rtlValue:h.value}:void 0,m=Je(r,n),[y,v]=Be(Object.assign({className:d,selectors:r,property:c,value:l},f),n);st(o,u,d,p),lt(i,m,y,v,n.media,at(s))}else if("animationName"===c){const e=Array.isArray(l)?l:[l],a=[],c=[];for(const t of e){const e=qe(t),r=qe(C(t)),o="f"+s(e);let l;const u=Le(o,e);let d=[];e===r?l=o:(l="f"+s(r),d=Le(l,r));for(let e=0;e<u.length;e++)lt(i,"k",u[e],d[e],n.media,0);a.push(o),c.push(l)}ut({animationName:a.join(", ")},t,r,n,o,i,c.join(", "))}else if(Array.isArray(l)){if(0===l.length)continue;const e=rt(r.join("")),a=it(c);if(a){const e=a[1],s=Object.fromEntries(e.map(e=>[e,_]));ut(s,t,r,n,o,i)}const s=Ze(e,c,n),u=et({value:l.map(e=>(null!=e?e:"").toString()).join(";"),salt:t,selector:e,property:c},n),d=l.map(e=>w(c,e));if(d.some(e=>e.key!==d[0].key))continue;const h=d[0].key!==c||d.some((e,t)=>e.value!==l[t]),g=h?et({value:d.map(e=>{var t;return(null!==(t=null==e?void 0:e.value)&&void 0!==t?t:"").toString()}).join(";"),salt:t,property:d[0].key,selector:e},n):void 0,p=h?{rtlClassName:g,rtlProperty:d[0].key,rtlValue:d.map(e=>e.value)}:void 0,f=Je(r,n),[m,y]=Be(Object.assign({className:u,selectors:r,property:c,value:l},p),n);st(o,s,u,g),lt(i,f,m,y,n.media,at(a))}else if(Ve(l))if(Ke(c))ut(l,t,r.concat(x(c)),n,o,i);else if(je(c)){const e=Ue(n.media,c.slice(6).trim());ut(l,t,r,Object.assign({},n,{media:e}),o,i)}else if($e(c)){const e=(n.layer?`${n.layer}.`:"")+c.slice(6).trim();ut(l,t,r,Object.assign({},n,{layer:e}),o,i)}else if(We(c)){const e=Ue(n.supports,c.slice(9).trim());ut(l,t,r,Object.assign({},n,{supports:e}),o,i)}else if(Ge(c)){const e=c.slice(10).trim();ut(l,t,r,Object.assign({},n,{container:e}),o,i)}else nt()}}return[o,i]}function dt(e,t,r=[]){return"___"+function(e){const t=e.length;if(7===t)return e;for(let r=t;r<7;r++)e+="0";return e}(s(e+t))}function ht(e,t){let r="",n="";for(const o in e){const i=e[o];if(0===i){n+=o+" ";continue}const a=Array.isArray(i),s="rtl"===t?(a?i[1]:i)+" ":(a?i[0]:i)+" ";r+=s,n+=s}return[r.slice(0,-1),n.slice(0,-1)]}function gt(e,t){const r={};for(const n in e){const[o,i]=ht(e[n],t);if(""===i){r[n]="";continue}const a=dt(i,t),s=a+(""===o?"":" "+o);T[a]=[e[n],t],r[n]=s}return r}const pt=o.useInsertionEffect?o.useInsertionEffect:void 0,ft=()=>{const e={};return function(t,r){pt&&"undefined"!=typeof window&&window.document&&window.document.createElement?pt(()=>{t.insertCSSRules(r)},[t,r]):void 0===e[t.id]&&(t.insertCSSRules(r),e[t.id]=!0)}};function mt(e){return Array.isArray(e)?e:[e]}const yt=["r","d","l","v","w","f","i","h","a","s","k","t","m","c"].reduce((e,t,r)=>(e[t]=r,e),{});function vt(e,t,r,n,o={}){var i,a;const s="m"===e,c=null!==(i=o.m)&&void 0!==i?i:"0",l=null!==(a=o.p)&&void 0!==a?a:0,u=function(e,t,r){return("m"===e?e+t:e)+r}(e,c,l);if(!n.stylesheets[u]){const i=t&&t.createElement("style"),a=function(e,t,r,n){const o=[];if(n[S]=t,n["data-priority"]=String(r),e)for(const t in n)e.setAttribute(t,n[t]);return{elementAttributes:n,insertRule:function(t){return(null==e?void 0:e.sheet)?e.sheet.insertRule(t,e.sheet.cssRules.length):o.push(t)},element:e,bucketName:t,cssRules(){return(null==e?void 0:e.sheet)?Array.from(e.sheet.cssRules).map(e=>e.cssText):o}}}(i,e,l,Object.assign({},n.styleElementAttributes,s&&{media:c}));n.stylesheets[u]=a,(null==t?void 0:t.head)&&i&&t.head.insertBefore(i,function(e,t,r,n,o={}){var i,a;const s=yt[r],c=null!==(i=o.m)&&void 0!==i?i:"",l=null!==(a=o.p)&&void 0!==a?a:0;let u=e=>s-yt[e.getAttribute(S)],d=e.head.querySelectorAll(`[${S}]`);if("m"===r){const t=e.head.querySelectorAll(`[${S}="${r}"]`);t.length&&(d=t,u=e=>n.compareMediaQueries(c,e.media))}const h=e=>function(e,t,r){var n,o;return t+(null!==(n=r.m)&&void 0!==n?n:"")===e.getAttribute(S)+(null!==(o=e.media)&&void 0!==o?o:"")}(e,r,o)?l-Number(e.getAttribute("data-priority")):u(e),g=d.length;let p=g-1;for(;p>=0;){const e=d.item(p);if(h(e)>0)return e.nextSibling;p--}return g>0?d.item(0):t?t.nextSibling:null}(t,r,e,n,o))}return n.stylesheets[u]}function bt(e,t){try{e.insertRule(t)}catch(e){}}let Ct=0;const wt=(e,t)=>e<t?-1:e>t?1:0;function kt(e=("undefined"==typeof document?void 0:document),t={}){const{classNameHashSalt:r,unstable_filterCSSRule:n,insertionPoint:o,styleElementAttributes:i,compareMediaQueries:a=wt}=t,s={classNameHashSalt:r,insertionCache:{},stylesheets:{},styleElementAttributes:Object.freeze(i),compareMediaQueries:a,id:"d"+Ct++,insertCSSRules(t){for(const r in t){const i=t[r];for(let t=0,a=i.length;t<a;t++){const[a,c]=mt(i[t]),l=vt(r,e,o||null,s,c);s.insertionCache[a]||(s.insertionCache[a]=r,n?n(a)&&bt(l,a):bt(l,a))}}}};return s}const It=n.createContext(kt());function At(){return n.useContext(It)}const Tt=n.createContext("ltr"),St=({children:e,dir:t})=>n.createElement(Tt.Provider,{value:t},e);function Et(e){return function(e){if(Array.isArray(e)){for(var t=0,r=new Array(e.length);t<e.length;t++)r[t]=e[t];return r}}(e)||function(e){if(Symbol.iterator in Object(e)||"[object Arguments]"===Object.prototype.toString.call(e))return Array.from(e)}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance")}()}function _t(){return _t=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},_t.apply(this,arguments)}function Pt(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function Rt(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function Ot(e,t){return Ot=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e},Ot(e,t)}function Mt(e){return Mt="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Mt(e)}function Nt(e){return Nt="function"==typeof Symbol&&"symbol"===Mt(Symbol.iterator)?function(e){return Mt(e)}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":Mt(e)},Nt(e)}function xt(e){return xt=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},xt(e)}function Ft(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}var Bt=r(20311),Dt=r.n(Bt);function qt(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var r=[],n=!0,o=!1,i=void 0;try{for(var a,s=e[Symbol.iterator]();!(n=(a=s.next()).done)&&(r.push(a.value),!t||r.length!==t);n=!0);}catch(e){o=!0,i=e}finally{try{n||null==s.return||s.return()}finally{if(o)throw i}}return r}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}()}function Lt(e){return Lt="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Lt(e)}function Ht(e,t,r){return(t=function(e){var t=function(e){if("object"!=Lt(e)||!e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var r=t.call(e,"string");if("object"!=Lt(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==Lt(t)?t:t+""}(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function Ut(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=Array(t);r<t;r++)n[r]=e[r];return n}function jt(e){return function(e){if(Array.isArray(e))return Ut(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||function(e,t){if(e){if("string"==typeof e)return Ut(e,t);var r={}.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?Ut(e,t):void 0}}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}var $t=function(e){return e===Object(e)?Object.keys(e):[]},zt=function(e){return e===Object(e)?Object.values(e):[]};function Kt(e,t){var r=Object.assign({},e);return Vt(e)&&Vt(t)&&$t(t).forEach(function(n){Vt(t[n])&&n in e?r[n]=Kt(e[n],t[n]):Object.assign(r,Ht({},n,t[n]))}),r}var Wt=function(e){for(var t=arguments.length,r=new Array(t>1?t-1:0),n=1;n<t;n++)r[n-1]=arguments[n];return r.reduce(function(e,t){return Kt(e,t)},e)},Gt=function(e,t){var r=Object.assign({},e);if(t)for(var n=0;n<t.length;n++)delete r[t[n]];return r},Vt=function(e){return!(e!==Object(e)||e instanceof Date||Array.isArray(e))},Qt=function(e){return"&"===e[0]},Jt=function(e){return!Qt(e)},Yt=function(e){return e.replace(/-(\w)/g,function(e,t){return t.toUpperCase()})},Xt=function(e){for(var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],r=$t(e),n={},o=0,i=r.length;o<i;o+=1){var a=r[o];("[object Object]"!==Object.prototype.toString.call(e[a])||":"===a[0]||"@"===a[0]||t.indexOf(a)>=0)&&(n[a]=e[a])}return n},Zt=function(e,t){for(var r=t.map(Yt),n=$t(e),o={},i=0,a=n.length;i<a;i+=1){var s=n[i];(t.indexOf(s)>=0||r.indexOf(Yt(s))>=0)&&(o[s]=e[s])}return o},er=function e(t,r){for(var n=Wt.apply(void 0,[{},Gt(t,r)].concat(jt(zt(Zt(t,r))))),o=$t(n).filter(Qt),i=0,a=o.length;i<a;i+=1){var s=o[i],c=e(n[s],r);r.indexOf(s)>=0?(delete n[s],n=Wt({},n,c)):n[s]=c}return n};function tr(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),r.push.apply(r,n)}return r}function rr(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?tr(Object(r),!0).forEach(function(t){Ht(e,t,r[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):tr(Object(r)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))})}return e}var nr=["animationName"],or=function(e){var t=e.style,r=e.className;return rr(rr({},t?{style:Xt(t,nr)}:{}),r?{className:r}:{})},ir=(0,n.createContext)(or),ar=(ir.Provider,function(e){if(!e)return[];if("string"==typeof e)return[e];if(!Array.isArray(e)){var t=e;return $t(e).reduce(function(e,r){return e.concat(t[r]?[r]:[])},[])}return e}),sr={};function cr(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),r.push.apply(r,n)}return r}function lr(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?cr(Object(r),!0).forEach(function(t){Ht(e,t,r[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):cr(Object(r)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))})}return e}var ur=function e(t){var r=t.style,n=t.className,o=t.classNames,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:or,a=n||function(e){var t=e&&$t(e)[0];return t&&t.split("__")[0].split("--")[0]}(o)||(null==r?void 0:r.className),s="function"==typeof r?r:function(e){return function(t,r){var n,o=r||sr;e.memoize=e.memoize||new WeakMap,e.memoize.has(o)?n=e.memoize.get(o):(n={},e.memoize.set(o,n));var i=ar(t).join(" ");return i in n?n[i]:n[i]=e(t||[],r)}}(function(t,n){var s=ar(t);Dt()(Array.isArray(s),"First parameter must be a string, an array of strings, a plain object with boolean values, or a falsy value."),Dt()(!n||Vt(n),"Optional second parameter must be a plain object.");var c=s.filter(Qt),l=s.filter(Jt),u=l.length>0?function(e){return zt(Zt(e,l))}:function(e){return[e]},d=function(){return u(er(arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},c))},h=function(e,t,r){if(e){var n=e.split(" ")[0],o=[].concat(jt(0===t.length?r.map(function(e){return"".concat(n,"--").concat(e.substring(1))}):[]),jt(t.map(function(e){return"".concat(n,"__").concat(e)})));return 0===t.length?[e].concat(jt(o)):o}}(a,l,c);return e(lr(lr(lr({},(r||n)&&{style:Wt.apply(void 0,[{}].concat(jt(d(n)),jt(d(r))))}),h&&{className:h.join(" ")}),o&&{classNames:o}),i)}),c=lr({},"function"==typeof r?r:{style:r}),l=jt(new Set([].concat(jt(c.className?c.className.split(" "):[]),jt(a?a.split(" "):[])))),u=o?(l.map(function(e){return o[e]})||[]).filter(Boolean):l,d=i(lr(lr({},c),u.length>0?{className:u.join(" ")}:{}));return Object.assign(s,d),s},dr=function(e,t,r){var o=t.style,i=t.className,a=t.classNames,s=(0,n.useContext)(ir);return(0,n.useMemo)(function(){return ur({style:o,className:i,classNames:a},s)},[o,i,a,s])(r,e)};function hr(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),r.push.apply(r,n)}return r}function gr(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?hr(Object(r),!0).forEach(function(t){Ht(e,t,r[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):hr(Object(r)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))})}return e}var pr=r(5556),fr=r.n(pr),mr=r(40961),yr=function(e){return e.replace(/[-[\]{}()*+?.,\\^$|#\s]/g,"\\$&")},vr="__id__",br="__display__",Cr=function(e,t){Dt()("id"===t||"display"===t,'Second arg must be either "id" or "display", got: "'.concat(t,'"'));var r=e.indexOf(br),n=e.indexOf(vr);return r<0&&(r=null),n<0&&(n=null),Dt()(null!==r||null!==n,"The markup '".concat(e,"' does not contain either of the placeholders '__id__' or '__display__'")),null!==r&&null!==n?"id"===t&&n<=r||"display"===t&&r<=n?0:1:0},wr=function(e){var t=0;return e.indexOf("__id__")>=0&&t++,e.indexOf("__display__")>=0&&t++,t},kr=function(){},Ir=function(e,t,r){for(var n,o,i,a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:kr,s=(n=t.map(function(e){return e.regex}),o=/^\/(.+)\/(\w+)?$/,new RegExp(n.map(function(e){var t=qt(o.exec(e.toString()),3),r=t[1],n=t[2];return Dt()(!n,"RegExp flags are not supported. Change /".concat(r,"/").concat(n," into /").concat(r,"/")),"(".concat(r,")")}).join("|"),"g")),c=2,l=t.map(function(e){var t=e.markup,r=c;return c+=wr(t)+1,r}),u=0,d=0;null!==(i=s.exec(e));){var h=l.find(function(e){return!!i[e]}),g=l.indexOf(h),p=t[g],f=p.markup,m=p.displayTransform,y=h+Cr(f,"id"),v=h+Cr(f,"display"),b=i[y],C=m(b,i[v]),w=e.substring(u,i.index);a(w,u,d),d+=w.length,r(i[0],i.index,d,b,C,g,u),d+=C.length,u=s.lastIndex}u<e.length&&a(e.substring(u),u,d)},Ar=function(e,t){var r="";return Ir(e,t,function(e,t,n,o,i){r+=i},function(e){r+=e}),r},Tr=function(e,t,r){var n,o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"START";return"number"!=typeof r?r:(Ir(e,t,function(e,t,i,a,s,c,l){void 0===n&&i+s.length>r&&(n="NULL"===o?null:t+("END"===o?e.length:0))},function(e,t,o){void 0===n&&o+e.length>=r&&(n=t+r-o)}),void 0===n?e.length:n)},Sr=function(e,t,r,n){return e.substring(0,t)+n+e.substring(r)},Er=function(e,t,r){var n=r,o=!1;if(Ir(e,t,function(e,t,i,a,s,c,l){i<=r&&i+s.length>r&&(n=i,o=!0)}),o)return n},_r=function(e,t){var r=[];return Ir(e,t,function(e,t,n,o,i,a,s){r.push({id:o,display:i,childIndex:a,index:t,plainTextIndex:n})}),r},Pr=function(e,t){return"".concat(e,"-").concat(t)},Rr=function(e){return Object.values(e).reduce(function(e,t){return e+t.results.length},0)},Or=function(e){var t=yr(e),r=e[e.indexOf(br)+11],n=e[e.indexOf(vr)+6];return new RegExp(t.replace(br,"([^".concat(yr(r||""),"]+?)")).replace(vr,"([^".concat(yr(n||""),"]+?)")))},Mr=function(e){return n.Children.toArray(e).map(function(e){var t=e.props,r=t.markup,n=t.regex,o=t.displayTransform;return{markup:r,regex:n?Nr(n,r):Or(r),displayTransform:o||function(e,t){return t||e}}})},Nr=function(e,t){var r=new RegExp(e.toString()+"|").exec("").length-1,n=wr(t);return Dt()(r===n,"Number of capturing groups in RegExp ".concat(e.toString()," (").concat(r,") does not match the number of placeholders in the markup '").concat(t,"' (").concat(n,")")),e},xr=[{base:"A",letters:/(&#65;|&#9398;|&#65313;|&#192;|&#193;|&#194;|&#7846;|&#7844;|&#7850;|&#7848;|&#195;|&#256;|&#258;|&#7856;|&#7854;|&#7860;|&#7858;|&#550;|&#480;|&#196;|&#478;|&#7842;|&#197;|&#506;|&#461;|&#512;|&#514;|&#7840;|&#7852;|&#7862;|&#7680;|&#260;|&#570;|&#11375;|[\u0041\u24B6\uFF21\u00C0\u00C1\u00C2\u1EA6\u1EA4\u1EAA\u1EA8\u00C3\u0100\u0102\u1EB0\u1EAE\u1EB4\u1EB2\u0226\u01E0\u00C4\u01DE\u1EA2\u00C5\u01FA\u01CD\u0200\u0202\u1EA0\u1EAC\u1EB6\u1E00\u0104\u023A\u2C6F])/g},{base:"AA",letters:/(&#42802;|[\uA732])/g},{base:"AE",letters:/(&#198;|&#508;|&#482;|[\u00C6\u01FC\u01E2])/g},{base:"AO",letters:/(&#42804;|[\uA734])/g},{base:"AU",letters:/(&#42806;|[\uA736])/g},{base:"AV",letters:/(&#42808;|&#42810;|[\uA738\uA73A])/g},{base:"AY",letters:/(&#42812;|[\uA73C])/g},{base:"B",letters:/(&#66;|&#9399;|&#65314;|&#7682;|&#7684;|&#7686;|&#579;|&#386;|&#385;|[\u0042\u24B7\uFF22\u1E02\u1E04\u1E06\u0243\u0182\u0181])/g},{base:"C",letters:/(&#67;|&#9400;|&#65315;|&#262;|&#264;|&#266;|&#268;|&#199;|&#7688;|&#391;|&#571;|&#42814;|[\u0043\u24B8\uFF23\u0106\u0108\u010A\u010C\u00C7\u1E08\u0187\u023B\uA73E])/g},{base:"D",letters:/(&#68;|&#9401;|&#65316;|&#7690;|&#270;|&#7692;|&#7696;|&#7698;|&#7694;|&#272;|&#395;|&#394;|&#393;|&#42873;|&#208;|[\u0044\u24B9\uFF24\u1E0A\u010E\u1E0C\u1E10\u1E12\u1E0E\u0110\u018B\u018A\u0189\uA779\u00D0])/g},{base:"DZ",letters:/(&#497;|&#452;|[\u01F1\u01C4])/g},{base:"Dz",letters:/(&#498;|&#453;|[\u01F2\u01C5])/g},{base:"E",letters:/(&#69;|&#9402;|&#65317;|&#200;|&#201;|&#202;|&#7872;|&#7870;|&#7876;|&#7874;|&#7868;|&#274;|&#7700;|&#7702;|&#276;|&#278;|&#203;|&#7866;|&#282;|&#516;|&#518;|&#7864;|&#7878;|&#552;|&#7708;|&#280;|&#7704;|&#7706;|&#400;|&#398;|[\u0045\u24BA\uFF25\u00C8\u00C9\u00CA\u1EC0\u1EBE\u1EC4\u1EC2\u1EBC\u0112\u1E14\u1E16\u0114\u0116\u00CB\u1EBA\u011A\u0204\u0206\u1EB8\u1EC6\u0228\u1E1C\u0118\u1E18\u1E1A\u0190\u018E])/g},{base:"F",letters:/(&#70;|&#9403;|&#65318;|&#7710;|&#401;|&#42875;|[\u0046\u24BB\uFF26\u1E1E\u0191\uA77B])/g},{base:"G",letters:/(&#71;|&#9404;|&#65319;|&#500;|&#284;|&#7712;|&#286;|&#288;|&#486;|&#290;|&#484;|&#403;|&#42912;|&#42877;|&#42878;|[\u0047\u24BC\uFF27\u01F4\u011C\u1E20\u011E\u0120\u01E6\u0122\u01E4\u0193\uA7A0\uA77D\uA77E])/g},{base:"H",letters:/(&#72;|&#9405;|&#65320;|&#292;|&#7714;|&#7718;|&#542;|&#7716;|&#7720;|&#7722;|&#294;|&#11367;|&#11381;|&#42893;|[\u0048\u24BD\uFF28\u0124\u1E22\u1E26\u021E\u1E24\u1E28\u1E2A\u0126\u2C67\u2C75\uA78D])/g},{base:"I",letters:/(&#73;|&#9406;|&#65321;|&#204;|&#205;|&#206;|&#296;|&#298;|&#300;|&#304;|&#207;|&#7726;|&#7880;|&#463;|&#520;|&#522;|&#7882;|&#302;|&#7724;|&#407;|[\u0049\u24BE\uFF29\u00CC\u00CD\u00CE\u0128\u012A\u012C\u0130\u00CF\u1E2E\u1EC8\u01CF\u0208\u020A\u1ECA\u012E\u1E2C\u0197])/g},{base:"J",letters:/(&#74;|&#9407;|&#65322;|&#308;|&#584;|[\u004A\u24BF\uFF2A\u0134\u0248])/g},{base:"K",letters:/(&#75;|&#9408;|&#65323;|&#7728;|&#488;|&#7730;|&#310;|&#7732;|&#408;|&#11369;|&#42816;|&#42818;|&#42820;|&#42914;|[\u004B\u24C0\uFF2B\u1E30\u01E8\u1E32\u0136\u1E34\u0198\u2C69\uA740\uA742\uA744\uA7A2])/g},{base:"L",letters:/(&#76;|&#9409;|&#65324;|&#319;|&#313;|&#317;|&#7734;|&#7736;|&#315;|&#7740;|&#7738;|&#321;|&#573;|&#11362;|&#11360;|&#42824;|&#42822;|&#42880;|[\u004C\u24C1\uFF2C\u013F\u0139\u013D\u1E36\u1E38\u013B\u1E3C\u1E3A\u0141\u023D\u2C62\u2C60\uA748\uA746\uA780])/g},{base:"LJ",letters:/(&#455;|[\u01C7])/g},{base:"Lj",letters:/(&#456;|[\u01C8])/g},{base:"M",letters:/(&#77;|&#9410;|&#65325;|&#7742;|&#7744;|&#7746;|&#11374;|&#412;|[\u004D\u24C2\uFF2D\u1E3E\u1E40\u1E42\u2C6E\u019C])/g},{base:"N",letters:/(&#78;|&#9411;|&#65326;|&#504;|&#323;|&#209;|&#7748;|&#327;|&#7750;|&#325;|&#7754;|&#7752;|&#544;|&#413;|&#42896;|&#42916;|&#330;|[\u004E\u24C3\uFF2E\u01F8\u0143\u00D1\u1E44\u0147\u1E46\u0145\u1E4A\u1E48\u0220\u019D\uA790\uA7A4\u014A])/g},{base:"NJ",letters:/(&#458;|[\u01CA])/g},{base:"Nj",letters:/(&#459;|[\u01CB])/g},{base:"O",letters:/(&#79;|&#9412;|&#65327;|&#210;|&#211;|&#212;|&#7890;|&#7888;|&#7894;|&#7892;|&#213;|&#7756;|&#556;|&#7758;|&#332;|&#7760;|&#7762;|&#334;|&#558;|&#560;|&#214;|&#554;|&#7886;|&#336;|&#465;|&#524;|&#526;|&#416;|&#7900;|&#7898;|&#7904;|&#7902;|&#7906;|&#7884;|&#7896;|&#490;|&#492;|&#216;|&#510;|&#390;|&#415;|&#42826;|&#42828;|[\u004F\u24C4\uFF2F\u00D2\u00D3\u00D4\u1ED2\u1ED0\u1ED6\u1ED4\u00D5\u1E4C\u022C\u1E4E\u014C\u1E50\u1E52\u014E\u022E\u0230\u00D6\u022A\u1ECE\u0150\u01D1\u020C\u020E\u01A0\u1EDC\u1EDA\u1EE0\u1EDE\u1EE2\u1ECC\u1ED8\u01EA\u01EC\u00D8\u01FE\u0186\u019F\uA74A\uA74C])/g},{base:"OE",letters:/(&#338;|[\u0152])/g},{base:"OI",letters:/(&#418;|[\u01A2])/g},{base:"OO",letters:/(&#42830;|[\uA74E])/g},{base:"OU",letters:/(&#546;|[\u0222])/g},{base:"P",letters:/(&#80;|&#9413;|&#65328;|&#7764;|&#7766;|&#420;|&#11363;|&#42832;|&#42834;|&#42836;|[\u0050\u24C5\uFF30\u1E54\u1E56\u01A4\u2C63\uA750\uA752\uA754])/g},{base:"Q",letters:/(&#81;|&#9414;|&#65329;|&#42838;|&#42840;|&#586;|[\u0051\u24C6\uFF31\uA756\uA758\u024A])/g},{base:"R",letters:/(&#82;|&#9415;|&#65330;|&#340;|&#7768;|&#344;|&#528;|&#530;|&#7770;|&#7772;|&#342;|&#7774;|&#588;|&#11364;|&#42842;|&#42918;|&#42882;|[\u0052\u24C7\uFF32\u0154\u1E58\u0158\u0210\u0212\u1E5A\u1E5C\u0156\u1E5E\u024C\u2C64\uA75A\uA7A6\uA782])/g},{base:"S",letters:/(&#83;|&#9416;|&#65331;|&#7838;|&#346;|&#7780;|&#348;|&#7776;|&#352;|&#7782;|&#7778;|&#7784;|&#536;|&#350;|&#11390;|&#42920;|&#42884;|[\u0053\u24C8\uFF33\u1E9E\u015A\u1E64\u015C\u1E60\u0160\u1E66\u1E62\u1E68\u0218\u015E\u2C7E\uA7A8\uA784])/g},{base:"T",letters:/(&#84;|&#9417;|&#65332;|&#7786;|&#356;|&#7788;|&#538;|&#354;|&#7792;|&#7790;|&#358;|&#428;|&#430;|&#574;|&#42886;|[\u0054\u24C9\uFF34\u1E6A\u0164\u1E6C\u021A\u0162\u1E70\u1E6E\u0166\u01AC\u01AE\u023E\uA786])/g},{base:"TH",letters:/(&#222;|[\u00DE])/g},{base:"TZ",letters:/(&#42792;|[\uA728])/g},{base:"U",letters:/(&#85;|&#9418;|&#65333;|&#217;|&#218;|&#219;|&#360;|&#7800;|&#362;|&#7802;|&#364;|&#220;|&#475;|&#471;|&#469;|&#473;|&#7910;|&#366;|&#368;|&#467;|&#532;|&#534;|&#431;|&#7914;|&#7912;|&#7918;|&#7916;|&#7920;|&#7908;|&#7794;|&#370;|&#7798;|&#7796;|&#580;|[\u0055\u24CA\uFF35\u00D9\u00DA\u00DB\u0168\u1E78\u016A\u1E7A\u016C\u00DC\u01DB\u01D7\u01D5\u01D9\u1EE6\u016E\u0170\u01D3\u0214\u0216\u01AF\u1EEA\u1EE8\u1EEE\u1EEC\u1EF0\u1EE4\u1E72\u0172\u1E76\u1E74\u0244])/g},{base:"V",letters:/(&#86;|&#9419;|&#65334;|&#7804;|&#7806;|&#434;|&#42846;|&#581;|[\u0056\u24CB\uFF36\u1E7C\u1E7E\u01B2\uA75E\u0245])/g},{base:"VY",letters:/(&#42848;|[\uA760])/g},{base:"W",letters:/(&#87;|&#9420;|&#65335;|&#7808;|&#7810;|&#372;|&#7814;|&#7812;|&#7816;|&#11378;|[\u0057\u24CC\uFF37\u1E80\u1E82\u0174\u1E86\u1E84\u1E88\u2C72])/g},{base:"X",letters:/(&#88;|&#9421;|&#65336;|&#7818;|&#7820;|[\u0058\u24CD\uFF38\u1E8A\u1E8C])/g},{base:"Y",letters:/(&#89;|&#9422;|&#65337;|&#7922;|&#221;|&#374;|&#7928;|&#562;|&#7822;|&#376;|&#7926;|&#7924;|&#435;|&#590;|&#7934;|[\u0059\u24CE\uFF39\u1EF2\u00DD\u0176\u1EF8\u0232\u1E8E\u0178\u1EF6\u1EF4\u01B3\u024E\u1EFE])/g},{base:"Z",letters:/(&#90;|&#9423;|&#65338;|&#377;|&#7824;|&#379;|&#381;|&#7826;|&#7828;|&#437;|&#548;|&#11391;|&#11371;|&#42850;|[\u005A\u24CF\uFF3A\u0179\u1E90\u017B\u017D\u1E92\u1E94\u01B5\u0224\u2C7F\u2C6B\uA762])/g},{base:"a",letters:/(&#97;|&#9424;|&#65345;|&#7834;|&#224;|&#225;|&#226;|&#7847;|&#7845;|&#7851;|&#7849;|&#227;|&#257;|&#259;|&#7857;|&#7855;|&#7861;|&#7859;|&#551;|&#481;|&#228;|&#479;|&#7843;|&#229;|&#507;|&#462;|&#513;|&#515;|&#7841;|&#7853;|&#7863;|&#7681;|&#261;|&#11365;|&#592;|[\u0061\u24D0\uFF41\u1E9A\u00E0\u00E1\u00E2\u1EA7\u1EA5\u1EAB\u1EA9\u00E3\u0101\u0103\u1EB1\u1EAF\u1EB5\u1EB3\u0227\u01E1\u00E4\u01DF\u1EA3\u00E5\u01FB\u01CE\u0201\u0203\u1EA1\u1EAD\u1EB7\u1E01\u0105\u2C65\u0250])/g},{base:"aa",letters:/(&#42803;|[\uA733])/g},{base:"ae",letters:/(&#230;|&#509;|&#483;|[\u00E6\u01FD\u01E3])/g},{base:"ao",letters:/(&#42805;|[\uA735])/g},{base:"au",letters:/(&#42807;|[\uA737])/g},{base:"av",letters:/(&#42809;|&#42811;|[\uA739\uA73B])/g},{base:"ay",letters:/(&#42813;|[\uA73D])/g},{base:"b",letters:/(&#98;|&#9425;|&#65346;|&#7683;|&#7685;|&#7687;|&#384;|&#387;|&#595;|[\u0062\u24D1\uFF42\u1E03\u1E05\u1E07\u0180\u0183\u0253])/g},{base:"c",letters:/(&#99;|&#9426;|&#65347;|&#263;|&#265;|&#267;|&#269;|&#231;|&#7689;|&#392;|&#572;|&#42815;|&#8580;|[\u0063\u24D2\uFF43\u0107\u0109\u010B\u010D\u00E7\u1E09\u0188\u023C\uA73F\u2184])/g},{base:"d",letters:/(&#100;|&#9427;|&#65348;|&#7691;|&#271;|&#7693;|&#7697;|&#7699;|&#7695;|&#273;|&#396;|&#598;|&#599;|&#42874;|&#240;|[\u0064\u24D3\uFF44\u1E0B\u010F\u1E0D\u1E11\u1E13\u1E0F\u0111\u018C\u0256\u0257\uA77A\u00F0])/g},{base:"dz",letters:/(&#499;|&#454;|[\u01F3\u01C6])/g},{base:"e",letters:/(&#101;|&#9428;|&#65349;|&#232;|&#233;|&#234;|&#7873;|&#7871;|&#7877;|&#7875;|&#7869;|&#275;|&#7701;|&#7703;|&#277;|&#279;|&#235;|&#7867;|&#283;|&#517;|&#519;|&#7865;|&#7879;|&#553;|&#7709;|&#281;|&#7705;|&#7707;|&#583;|&#603;|&#477;|[\u0065\u24D4\uFF45\u00E8\u00E9\u00EA\u1EC1\u1EBF\u1EC5\u1EC3\u1EBD\u0113\u1E15\u1E17\u0115\u0117\u00EB\u1EBB\u011B\u0205\u0207\u1EB9\u1EC7\u0229\u1E1D\u0119\u1E19\u1E1B\u0247\u025B\u01DD])/g},{base:"f",letters:/(&#102;|&#9429;|&#65350;|&#7711;|&#402;|&#42876;|[\u0066\u24D5\uFF46\u1E1F\u0192\uA77C])/g},{base:"g",letters:/(&#103;|&#9430;|&#65351;|&#501;|&#285;|&#7713;|&#287;|&#289;|&#487;|&#291;|&#485;|&#608;|&#42913;|&#7545;|&#42879;|[\u0067\u24D6\uFF47\u01F5\u011D\u1E21\u011F\u0121\u01E7\u0123\u01E5\u0260\uA7A1\u1D79\uA77F])/g},{base:"h",letters:/(&#104;|&#9431;|&#65352;|&#293;|&#7715;|&#7719;|&#543;|&#7717;|&#7721;|&#7723;|&#7830;|&#295;|&#11368;|&#11382;|&#613;|[\u0068\u24D7\uFF48\u0125\u1E23\u1E27\u021F\u1E25\u1E29\u1E2B\u1E96\u0127\u2C68\u2C76\u0265])/g},{base:"hv",letters:/(&#405;|[\u0195])/g},{base:"i",letters:/(&#105;|&#9432;|&#65353;|&#236;|&#237;|&#238;|&#297;|&#299;|&#301;|&#239;|&#7727;|&#7881;|&#464;|&#521;|&#523;|&#7883;|&#303;|&#7725;|&#616;|&#305;|[\u0069\u24D8\uFF49\u00EC\u00ED\u00EE\u0129\u012B\u012D\u00EF\u1E2F\u1EC9\u01D0\u0209\u020B\u1ECB\u012F\u1E2D\u0268\u0131])/g},{base:"ij",letters:/(&#307;|[\u0133])/g},{base:"j",letters:/(&#106;|&#9433;|&#65354;|&#309;|&#496;|&#585;|[\u006A\u24D9\uFF4A\u0135\u01F0\u0249])/g},{base:"k",letters:/(&#107;|&#9434;|&#65355;|&#7729;|&#489;|&#7731;|&#311;|&#7733;|&#409;|&#11370;|&#42817;|&#42819;|&#42821;|&#42915;|[\u006B\u24DA\uFF4B\u1E31\u01E9\u1E33\u0137\u1E35\u0199\u2C6A\uA741\uA743\uA745\uA7A3])/g},{base:"l",letters:/(&#108;|&#9435;|&#65356;|&#320;|&#314;|&#318;|&#7735;|&#7737;|&#316;|&#7741;|&#7739;|&#322;|&#410;|&#619;|&#11361;|&#42825;|&#42881;|&#42823;|[\u006C\u24DB\uFF4C\u0140\u013A\u013E\u1E37\u1E39\u013C\u1E3D\u1E3B\u0142\u019A\u026B\u2C61\uA749\uA781\uA747])/g},{base:"lj",letters:/(&#457;|[\u01C9])/g},{base:"m",letters:/(&#109;|&#9436;|&#65357;|&#7743;|&#7745;|&#7747;|&#625;|&#623;|[\u006D\u24DC\uFF4D\u1E3F\u1E41\u1E43\u0271\u026F])/g},{base:"n",letters:/(&#110;|&#9437;|&#65358;|&#505;|&#324;|&#241;|&#7749;|&#328;|&#7751;|&#326;|&#7755;|&#7753;|&#414;|&#626;|&#329;|&#42897;|&#42917;|&#331;|[\u006E\u24DD\uFF4E\u01F9\u0144\u00F1\u1E45\u0148\u1E47\u0146\u1E4B\u1E49\u019E\u0272\u0149\uA791\uA7A5\u014B])/g},{base:"nj",letters:/(&#460;|[\u01CC])/g},{base:"o",letters:/(&#111;|&#9438;|&#65359;|&#242;|&#243;|&#244;|&#7891;|&#7889;|&#7895;|&#7893;|&#245;|&#7757;|&#557;|&#7759;|&#333;|&#7761;|&#7763;|&#335;|&#559;|&#561;|&#246;|&#555;|&#7887;|&#337;|&#466;|&#525;|&#527;|&#417;|&#7901;|&#7899;|&#7905;|&#7903;|&#7907;|&#7885;|&#7897;|&#491;|&#493;|&#248;|&#511;|&#596;|&#42827;|&#42829;|&#629;|[\u006F\u24DE\uFF4F\u00F2\u00F3\u00F4\u1ED3\u1ED1\u1ED7\u1ED5\u00F5\u1E4D\u022D\u1E4F\u014D\u1E51\u1E53\u014F\u022F\u0231\u00F6\u022B\u1ECF\u0151\u01D2\u020D\u020F\u01A1\u1EDD\u1EDB\u1EE1\u1EDF\u1EE3\u1ECD\u1ED9\u01EB\u01ED\u00F8\u01FF\u0254\uA74B\uA74D\u0275])/g},{base:"oe",letters:/(&#339;|[\u0153])/g},{base:"oi",letters:/(&#419;|[\u01A3])/g},{base:"ou",letters:/(&#547;|[\u0223])/g},{base:"oo",letters:/(&#42831;|[\uA74F])/g},{base:"p",letters:/(&#112;|&#9439;|&#65360;|&#7765;|&#7767;|&#421;|&#7549;|&#42833;|&#42835;|&#42837;|[\u0070\u24DF\uFF50\u1E55\u1E57\u01A5\u1D7D\uA751\uA753\uA755])/g},{base:"q",letters:/(&#113;|&#9440;|&#65361;|&#587;|&#42839;|&#42841;|[\u0071\u24E0\uFF51\u024B\uA757\uA759])/g},{base:"r",letters:/(&#114;|&#9441;|&#65362;|&#341;|&#7769;|&#345;|&#529;|&#531;|&#7771;|&#7773;|&#343;|&#7775;|&#589;|&#637;|&#42843;|&#42919;|&#42883;|[\u0072\u24E1\uFF52\u0155\u1E59\u0159\u0211\u0213\u1E5B\u1E5D\u0157\u1E5F\u024D\u027D\uA75B\uA7A7\uA783])/g},{base:"s",letters:/(&#115;|&#9442;|&#65363;|&#347;|&#7781;|&#349;|&#7777;|&#353;|&#7783;|&#7779;|&#7785;|&#537;|&#351;|&#575;|&#42921;|&#42885;|&#7835;|&#383;|[\u0073\u24E2\uFF53\u015B\u1E65\u015D\u1E61\u0161\u1E67\u1E63\u1E69\u0219\u015F\u023F\uA7A9\uA785\u1E9B\u017F])/g},{base:"ss",letters:/(&#223;|[\u00DF])/g},{base:"t",letters:/(&#116;|&#9443;|&#65364;|&#7787;|&#7831;|&#357;|&#7789;|&#539;|&#355;|&#7793;|&#7791;|&#359;|&#429;|&#648;|&#11366;|&#42887;|[\u0074\u24E3\uFF54\u1E6B\u1E97\u0165\u1E6D\u021B\u0163\u1E71\u1E6F\u0167\u01AD\u0288\u2C66\uA787])/g},{base:"th",letters:/(&#254;|[\u00FE])/g},{base:"tz",letters:/(&#42793;|[\uA729])/g},{base:"u",letters:/(&#117;|&#9444;|&#65365;|&#249;|&#250;|&#251;|&#361;|&#7801;|&#363;|&#7803;|&#365;|&#252;|&#476;|&#472;|&#470;|&#474;|&#7911;|&#367;|&#369;|&#468;|&#533;|&#535;|&#432;|&#7915;|&#7913;|&#7919;|&#7917;|&#7921;|&#7909;|&#7795;|&#371;|&#7799;|&#7797;|&#649;|[\u0075\u24E4\uFF55\u00F9\u00FA\u00FB\u0169\u1E79\u016B\u1E7B\u016D\u00FC\u01DC\u01D8\u01D6\u01DA\u1EE7\u016F\u0171\u01D4\u0215\u0217\u01B0\u1EEB\u1EE9\u1EEF\u1EED\u1EF1\u1EE5\u1E73\u0173\u1E77\u1E75\u0289])/g},{base:"v",letters:/(&#118;|&#9445;|&#65366;|&#7805;|&#7807;|&#651;|&#42847;|&#652;|[\u0076\u24E5\uFF56\u1E7D\u1E7F\u028B\uA75F\u028C])/g},{base:"vy",letters:/(&#42849;|[\uA761])/g},{base:"w",letters:/(&#119;|&#9446;|&#65367;|&#7809;|&#7811;|&#373;|&#7815;|&#7813;|&#7832;|&#7817;|&#11379;|[\u0077\u24E6\uFF57\u1E81\u1E83\u0175\u1E87\u1E85\u1E98\u1E89\u2C73])/g},{base:"x",letters:/(&#120;|&#9447;|&#65368;|&#7819;|&#7821;|[\u0078\u24E7\uFF58\u1E8B\u1E8D])/g},{base:"y",letters:/(&#121;|&#9448;|&#65369;|&#7923;|&#253;|&#375;|&#7929;|&#563;|&#7823;|&#255;|&#7927;|&#7833;|&#7925;|&#436;|&#591;|&#7935;|[\u0079\u24E8\uFF59\u1EF3\u00FD\u0177\u1EF9\u0233\u1E8F\u00FF\u1EF7\u1E99\u1EF5\u01B4\u024F\u1EFF])/g},{base:"z",letters:/(&#122;|&#9449;|&#65370;|&#378;|&#7825;|&#380;|&#382;|&#7827;|&#7829;|&#438;|&#549;|&#576;|&#11372;|&#42851;|[\u007A\u24E9\uFF5A\u017A\u1E91\u017C\u017E\u1E93\u1E95\u01B6\u0225\u0240\u2C6C\uA763])/g}],Fr=function(e){return function(e){var t=e;return xr.forEach(function(e){t=t.replace(e.letters,e.base)}),t}(e).toLowerCase()},Br=function(e,t,r){return r?Fr(e).indexOf(Fr(t)):e.toLowerCase().indexOf(t.toLowerCase())},Dr=function(e){return"number"==typeof e},qr=["style","className","classNames"];function Lr(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),r.push.apply(r,n)}return r}function Hr(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?Lr(Object(r),!0).forEach(function(t){Ft(e,t,r[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):Lr(Object(r)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))})}return e}function Ur(e,t){return function(r){var o=function(o){var i=o.style,a=o.className,s=o.classNames,c=function(e,t){if(null==e)return{};var r,n,o=function(e,t){if(null==e)return{};var r,n,o={},i=Object.keys(e);for(n=0;n<i.length;n++)r=i[n],t.indexOf(r)>=0||(o[r]=e[r]);return o}(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(n=0;n<i.length;n++)r=i[n],t.indexOf(r)>=0||Object.prototype.propertyIsEnumerable.call(e,r)&&(o[r]=e[r])}return o}(o,qr),l=t?t(c):void 0,u=dr(e,{style:i,className:a,classNames:s},l);return n.createElement(r,_t({},c,{style:u}))},i=r.displayName||r.name||"Component";return o.displayName="defaultStyle(".concat(i,")"),n.forwardRef(function(e,t){return o(Hr(Hr({},e),{},{ref:t}))})}}function jr(e){var t=e.selectionStart,r=e.selectionEnd,o=e.value,i=void 0===o?"":o,a=e.onCaretPositionChange,s=e.containerRef,c=e.children,l=(e.singleLine,e.style),u=qt((0,n.useState)({left:void 0,top:void 0}),2),d=u[0],h=u[1],g=qt((0,n.useState)(),2),p=g[0],f=g[1];(0,n.useEffect)(function(){y()});var m,y=function(){if(p){var e=p.offsetLeft,t=p.offsetTop;if(d.left!==e||d.top!==t){var r={left:e,top:t};h(r),a(r)}}},v=Mr(c);r===t&&(m=Tr(i,v,t,"START"));var b=[],C={},w=b,k=0,I=function(e,t){return n.createElement("span",_t({},l("substring"),{key:t}),e)};return Ir(i,v,function(e,t,r,o,i,a,s){var l=function(e,t){return e.hasOwnProperty(t)?e[t]++:e[t]=0,t+"_"+e[t]}(C,o);w.push(function(e,t,r,o){var i={id:e,display:t,key:o},a=n.Children.toArray(c)[r];return n.cloneElement(a,i)}(o,i,a,l))},function(e,t,r){if(Dr(m)&&m>=t&&m<=t+e.length){var n=m-t;w.push(I(e.substring(0,n),k)),w=[I(e.substring(n),k)]}else w.push(I(e,k));k++}),w.push(" "),w!==b&&b.push(function(e){return n.createElement("span",_t({},l("caret"),{ref:f,key:"caret"}),e)}(w)),n.createElement("div",_t({},l,{ref:s}),b)}jr.propTypes={selectionStart:fr().number,selectionEnd:fr().number,value:fr().string.isRequired,onCaretPositionChange:fr().func.isRequired,containerRef:fr().oneOfType([fr().func,fr().shape({current:"undefined"==typeof Element?fr().any:fr().instanceOf(Element)})]),children:fr().oneOfType([fr().element,fr().arrayOf(fr().element)]).isRequired};var $r=Ur({position:"relative",boxSizing:"border-box",width:"100%",color:"transparent",overflow:"hidden",whiteSpace:"pre-wrap",wordWrap:"break-word",border:"1px solid transparent",textAlign:"start","&singleLine":{whiteSpace:"pre",wordWrap:null},substring:{visibility:"hidden"}},function(e){return{"&singleLine":e.singleLine}})(jr);function zr(e){var t,r,o=e.id,i=e.focused,a=e.ignoreAccents,s=e.index,c=e.onClick,l=e.onMouseEnter,u=e.query,d=e.renderSuggestion,h=e.suggestion,g=e.style,p=(e.className,e.classNames,{onClick:c,onMouseEnter:l});return n.createElement("li",_t({id:o,role:"option","aria-selected":i},p,g),(t=function(){if("string"==typeof h)return h;var e=h.id,t=h.display;return void 0!==e&&t?t:e}(),r=function(e){var t=Br(e,u,a);return-1===t?n.createElement("span",g("display"),e):n.createElement("span",g("display"),e.substring(0,t),n.createElement("b",g("highlight"),e.substring(t,t+u.length)),e.substring(t+u.length))}(t),d?d(h,u,r,s,i):r))}zr.propTypes={id:fr().string.isRequired,query:fr().string.isRequired,index:fr().number.isRequired,ignoreAccents:fr().bool,suggestion:fr().oneOfType([fr().string,fr().shape({id:fr().oneOfType([fr().string,fr().number]).isRequired,display:fr().string})]).isRequired,renderSuggestion:fr().func,focused:fr().bool};var Kr=Ur({cursor:"pointer"},function(e){return{"&focused":e.focused}})(zr);function Wr(e){var t=e.style,r=e.className,o=e.classNames,i=dr(Gr,{style:t,className:r,classNames:o}),a=i("spinner");return n.createElement("div",i,n.createElement("div",a,n.createElement("div",a(["element","element1"])),n.createElement("div",a(["element","element2"])),n.createElement("div",a(["element","element3"])),n.createElement("div",a(["element","element4"])),n.createElement("div",a(["element","element5"]))))}var Gr={};function Vr(e){var t=e.id,r=e.suggestions,o=void 0===r?{}:r,i=e.a11ySuggestionsListLabel,a=e.focusIndex,s=e.position,c=e.left,l=e.right,u=e.top,d=e.scrollFocusedIntoView,h=e.isLoading,g=e.isOpened,p=e.onSelect,f=void 0===p?function(){return null}:p,m=e.ignoreAccents,y=e.containerRef,v=e.children,b=e.style,C=e.customSuggestionsContainer,w=e.onMouseDown,k=e.onMouseEnter,I=qt((0,n.useState)(void 0),2),A=I[0],T=I[1];(0,n.useEffect)(function(){if(A&&!(A.offsetHeight>=A.scrollHeight)&&d){var e=A.scrollTop,t=A.children[a].getBoundingClientRect(),r=t.top,n=t.bottom,o=A.getBoundingClientRect().top;n=n-o+e,(r=r-o+e)<e?A.scrollTop=r:n>A.offsetHeight&&(A.scrollTop=n-A.offsetHeight)}},[a,d,A]);var S,E=function(e,t){k&&k(e)},_=function(e,t){f(e,t)},P=function(e){return"string"==typeof e?e:e.id};return g?n.createElement("div",_t({},function(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];return t.reduce(function(e,t){return gr(gr(gr({},e),"function"==typeof t?t:{}),{},{style:gr(gr({},e.style),"function"==typeof t?t.style:t)})},{})}({position:s||"absolute",left:c,right:l,top:u},b),{onMouseDown:w,ref:y}),(S=n.createElement("ul",_t({ref:T,id:t,role:"listbox","aria-label":i},b("list")),Object.values(o).reduce(function(e,r){var o=r.results,i=r.queryInfo;return[].concat(Et(e),Et(o.map(function(r,o){return function(e,r,o){var i=o===a,s=r.childIndex,c=r.query,l=n.Children.toArray(v)[s].props.renderSuggestion;return n.createElement(Kr,{style:b("item"),key:"".concat(s,"-").concat(P(e)),id:Pr(t,o),query:c,index:o,ignoreAccents:m,renderSuggestion:l,suggestion:e,focused:i,onClick:function(){return _(e,r)},onMouseEnter:function(){return E(o)}})}(r,i,e.length+o)})))},[])),C?C(S):S),function(){if(h)return n.createElement(Wr,{style:b("loadingIndicator")})}()):null}Vr.propTypes={id:fr().string.isRequired,suggestions:fr().object.isRequired,a11ySuggestionsListLabel:fr().string,focusIndex:fr().number,position:fr().string,left:fr().number,right:fr().number,top:fr().number,scrollFocusedIntoView:fr().bool,isLoading:fr().bool,isOpened:fr().bool.isRequired,onSelect:fr().func,ignoreAccents:fr().bool,customSuggestionsContainer:fr().func,containerRef:fr().oneOfType([fr().func,fr().shape({current:"undefined"==typeof Element?fr().any:fr().instanceOf(Element)})])};var Qr=Ur({zIndex:1,backgroundColor:"white",marginTop:14,minWidth:100,list:{margin:0,padding:0,listStyleType:"none"}})(Vr);function Jr(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),r.push.apply(r,n)}return r}function Yr(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?Jr(Object(r),!0).forEach(function(t){Ft(e,t,r[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):Jr(Object(r)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))})}return e}var Xr={TAB:9,RETURN:13,ESC:27,UP:38,DOWN:40},Zr=!1,en={singleLine:fr().bool,allowSpaceInQuery:fr().bool,allowSuggestionsAboveCursor:fr().bool,forceSuggestionsAboveCursor:fr().bool,ignoreAccents:fr().bool,a11ySuggestionsListLabel:fr().string,value:fr().string,onKeyDown:fr().func,customSuggestionsContainer:fr().func,onSelect:fr().func,onBlur:fr().func,onChange:fr().func,suggestionsPortalHost:"undefined"==typeof Element?fr().any:fr().PropTypes.instanceOf(Element),inputRef:fr().oneOfType([fr().func,fr().shape({current:"undefined"==typeof Element?fr().any:fr().instanceOf(Element)})]),children:fr().oneOfType([fr().element,fr().arrayOf(fr().element)]).isRequired},tn=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Ot(e,t)}(s,e);var t,r,o,i,a=(o=s,i=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}(),function(){var e,t=xt(o);if(i){var r=xt(this).constructor;e=Reflect.construct(t,arguments,r)}else e=t.apply(this,arguments);return function(e,t){return!t||"object"!==Nt(t)&&"function"!=typeof t?Rt(e):t}(this,e)});function s(e){var t;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,s),Ft(Rt(t=a.call(this,e)),"setContainerElement",function(e){t.containerElement=e}),Ft(Rt(t),"getInputProps",function(){var e,r=t.props,n=r.readOnly,o=r.disabled,i=r.style,a=function(e){for(var t,r=arguments.length,n=new Array(r>1?r-1:0),o=1;o<r;o++)n[o-1]=arguments[o];var i=(t=[]).concat.apply(t,n);return Object.keys(e).reduce(function(t,r){return e.hasOwnProperty(r)&&!i.includes(r)&&void 0!==e[r]&&(t[r]=e[r]),t},{})}(t.props,["style","classNames","className"],(e=en)===Object(e)?Object.keys(e):[]);return Yr(Yr(Yr(Yr({},a),i("input")),{},{value:t.getPlainText(),onScroll:t.updateHighlighterScroll},!n&&!o&&{onChange:t.handleChange,onSelect:t.handleSelect,onKeyDown:t.handleKeyDown,onBlur:t.handleBlur,onCompositionStart:t.handleCompositionStart,onCompositionEnd:t.handleCompositionEnd}),t.isOpened()&&{role:"combobox","aria-controls":t.uuidSuggestionsOverlay,"aria-expanded":!0,"aria-autocomplete":"list","aria-haspopup":"listbox","aria-activedescendant":Pr(t.uuidSuggestionsOverlay,t.state.focusIndex)})}),Ft(Rt(t),"renderControl",function(){var e=t.props,r=e.singleLine,o=e.style,i=t.getInputProps();return n.createElement("div",o("control"),t.renderHighlighter(),r?t.renderInput(i):t.renderTextarea(i))}),Ft(Rt(t),"renderInput",function(e){return n.createElement("input",_t({type:"text",ref:t.setInputRef},e))}),Ft(Rt(t),"renderTextarea",function(e){return n.createElement("textarea",_t({ref:t.setInputRef},e))}),Ft(Rt(t),"setInputRef",function(e){t.inputElement=e;var r=t.props.inputRef;"function"==typeof r?r(e):r&&(r.current=e)}),Ft(Rt(t),"setSuggestionsElement",function(e){t.suggestionsElement=e}),Ft(Rt(t),"renderSuggestionsOverlay",function(){if(!Dr(t.state.selectionStart))return null;var e=t.state.suggestionsPosition,r=e.position,o=e.left,i=e.top,a=e.right,s=n.createElement(Qr,{id:t.uuidSuggestionsOverlay,style:t.props.style("suggestions"),position:r,left:o,top:i,right:a,focusIndex:t.state.focusIndex,scrollFocusedIntoView:t.state.scrollFocusedIntoView,containerRef:t.setSuggestionsElement,suggestions:t.state.suggestions,customSuggestionsContainer:t.props.customSuggestionsContainer,onSelect:t.addMention,onMouseDown:t.handleSuggestionsMouseDown,onMouseEnter:t.handleSuggestionsMouseEnter,isLoading:t.isLoading(),isOpened:t.isOpened(),ignoreAccents:t.props.ignoreAccents,a11ySuggestionsListLabel:t.props.a11ySuggestionsListLabel},t.props.children);return t.props.suggestionsPortalHost?mr.createPortal(s,t.props.suggestionsPortalHost):s}),Ft(Rt(t),"renderHighlighter",function(){var e=t.state,r=e.selectionStart,o=e.selectionEnd,i=t.props,a=i.singleLine,s=i.children,c=i.value,l=i.style;return n.createElement($r,{containerRef:t.setHighlighterElement,style:l("highlighter"),value:c,singleLine:a,selectionStart:r,selectionEnd:o,onCaretPositionChange:t.handleCaretPositionChange},s)}),Ft(Rt(t),"setHighlighterElement",function(e){t.highlighterElement=e}),Ft(Rt(t),"handleCaretPositionChange",function(e){t.setState({caretPosition:e})}),Ft(Rt(t),"getPlainText",function(){return Ar(t.props.value||"",Mr(t.props.children))}),Ft(Rt(t),"executeOnChange",function(e){for(var r=arguments.length,n=new Array(r>1?r-1:0),o=1;o<r;o++)n[o-1]=arguments[o];var i,a;return t.props.onChange?(i=t.props).onChange.apply(i,[e].concat(n)):t.props.valueLink?(a=t.props.valueLink).requestChange.apply(a,[e.target.value].concat(n)):void 0}),Ft(Rt(t),"handleChange",function(e){if(Zr=!1,!document.documentMode||(document.activeElement&&document.activeElement.contentDocument||document).activeElement===e.target){var r=t.props.value||"",n=Mr(t.props.children),o=e.target.value,i=t.state.selectionStart;null==i&&(i=e.target.selectionStart);var a=t.state.selectionEnd;null==a&&(a=e.target.selectionEnd);var s=function(e,t,r,n){var o=r.selectionStartBefore,i=r.selectionEndBefore,a=r.selectionEndAfter,s=Ar(e,n),c=s.length-t.length;"undefined"===o&&(o=a+c),"undefined"===i&&(i=o),o===i&&i===a&&s.length===t.length&&(o-=1);var l=t.slice(o,a),u=Math.min(o,a),d=i;o===a&&(d=Math.max(i,o+c));var h=Tr(e,n,u,"START"),g=Tr(e,n,d,"END"),p=Tr(e,n,u,"NULL"),f=Tr(e,n,d,"NULL"),m=null===p||null===f,y=Sr(e,h,g,l);if(!m){var v=Ar(y,n);if(v!==t){for(u=0;t[u]===v[u];)u++;l=t.slice(u,a),d=s.lastIndexOf(t.substring(a)),h=Tr(e,n,u,"START"),g=Tr(e,n,d,"END"),y=Sr(e,h,g,l)}}return y}(r,o,{selectionStartBefore:i,selectionEndBefore:a,selectionEndAfter:e.target.selectionEnd},n);o=Ar(s,n);var c=e.target.selectionStart,l=e.target.selectionEnd,u=!1,d=Er(r,n,c);void 0!==d&&t.state.selectionEnd>d&&(l=c=d+(e.nativeEvent.data?e.nativeEvent.data.length:0),u=!0),t.setState({selectionStart:c,selectionEnd:l,setSelectionAfterMentionChange:u});var h=_r(s,n);e.nativeEvent.isComposing&&c===l&&t.updateMentionsQueries(t.inputElement.value,c);var g={target:{value:s}};t.executeOnChange(g,s,o,h)}}),Ft(Rt(t),"handleSelect",function(e){if(t.setState({selectionStart:e.target.selectionStart,selectionEnd:e.target.selectionEnd}),!Zr){var r=t.inputElement;e.target.selectionStart===e.target.selectionEnd?t.updateMentionsQueries(r.value,e.target.selectionStart):t.clearSuggestions(),t.updateHighlighterScroll(),t.props.onSelect(e)}}),Ft(Rt(t),"handleKeyDown",function(e){if(0!==Rr(t.state.suggestions)&&t.suggestionsElement)switch(Object.values(Xr).indexOf(e.keyCode)>=0&&(e.preventDefault(),e.stopPropagation()),e.keyCode){case Xr.ESC:return void t.clearSuggestions();case Xr.DOWN:return void t.shiftFocus(1);case Xr.UP:return void t.shiftFocus(-1);case Xr.RETURN:case Xr.TAB:return void t.selectFocused();default:return}else t.props.onKeyDown(e)}),Ft(Rt(t),"shiftFocus",function(e){var r=Rr(t.state.suggestions);t.setState({focusIndex:(r+t.state.focusIndex+e)%r,scrollFocusedIntoView:!0})}),Ft(Rt(t),"selectFocused",function(){var e=t.state,r=e.suggestions,n=e.focusIndex,o=Object.values(r).reduce(function(e,t){var r=t.results,n=t.queryInfo;return[].concat(Et(e),Et(r.map(function(e){return{result:e,queryInfo:n}})))},[])[n],i=o.result,a=o.queryInfo;t.addMention(i,a),t.setState({focusIndex:0})}),Ft(Rt(t),"handleBlur",function(e){var r=t._suggestionsMouseDown;t._suggestionsMouseDown=!1,r||t.setState({selectionStart:null,selectionEnd:null}),window.setTimeout(function(){t.updateHighlighterScroll()},1),t.props.onBlur(e,r)}),Ft(Rt(t),"handleSuggestionsMouseDown",function(e){t._suggestionsMouseDown=!0}),Ft(Rt(t),"handleSuggestionsMouseEnter",function(e){t.setState({focusIndex:e,scrollFocusedIntoView:!1})}),Ft(Rt(t),"updateSuggestionsPosition",function(){var e=t.state.caretPosition,r=t.props,n=r.suggestionsPortalHost,o=r.allowSuggestionsAboveCursor,i=r.forceSuggestionsAboveCursor;if(e&&t.suggestionsElement){var a=t.suggestionsElement,s=t.highlighterElement,c=s.getBoundingClientRect(),l=rn(s,"font-size"),u={left:c.left+e.left,top:c.top+e.top+l},d=Math.max(document.documentElement.clientHeight,window.innerHeight||0);if(a){var h={};if(n){h.position="fixed";var g=u.left,p=u.top;g-=rn(a,"margin-left"),p-=rn(a,"margin-top"),g-=s.scrollLeft,p-=s.scrollTop;var f=Math.max(document.documentElement.clientWidth,window.innerWidth||0);g+a.offsetWidth>f?h.left=Math.max(0,f-a.offsetWidth):h.left=g,o&&p+a.offsetHeight>d&&a.offsetHeight<p-l||i?h.top=Math.max(0,p-a.offsetHeight-l):h.top=p}else{var m=e.left-s.scrollLeft,y=e.top-s.scrollTop;m+a.offsetWidth>t.containerElement.offsetWidth?h.right=0:h.left=m,o&&u.top-s.scrollTop+a.offsetHeight>d&&a.offsetHeight<c.top-l-s.scrollTop||i?h.top=y-a.offsetHeight-l:h.top=y}h.left===t.state.suggestionsPosition.left&&h.top===t.state.suggestionsPosition.top&&h.position===t.state.suggestionsPosition.position||t.setState({suggestionsPosition:h})}}}),Ft(Rt(t),"updateHighlighterScroll",function(){var e=t.inputElement,r=t.highlighterElement;e&&r&&(r.scrollLeft=e.scrollLeft,r.scrollTop=e.scrollTop,r.height=e.height)}),Ft(Rt(t),"handleCompositionStart",function(){Zr=!0}),Ft(Rt(t),"handleCompositionEnd",function(){Zr=!1}),Ft(Rt(t),"setSelection",function(e,r){if(null!==e&&null!==r){var n=t.inputElement;if(n.setSelectionRange)n.setSelectionRange(e,r);else if(n.createTextRange){var o=n.createTextRange();o.collapse(!0),o.moveEnd("character",r),o.moveStart("character",e),o.select()}}}),Ft(Rt(t),"updateMentionsQueries",function(e,r){t._queryId++,t.suggestions={},t.setState({suggestions:{}});var o=t.props.value||"",i=t.props.children,a=Mr(i),s=Tr(o,a,r,"NULL");if(null!==s){var c=function(e,t){var r=_r(e,t),n=r[r.length-1];return n?n.plainTextIndex+n.display.length:0}(o.substring(0,s),a),l=e.substring(c,r);n.Children.forEach(i,function(r,n){if(r){var o=function(e){if(e instanceof RegExp)return e;var t=(arguments.length>1&&void 0!==arguments[1]?arguments[1]:{}).allowSpaceInQuery,r=yr(e);return new RegExp("(?:^|\\s)(".concat(r,"([^").concat(t?"":"\\s").concat(r,"]*))$"))}(r.props.trigger,t.props),i=l.match(o);if(i){var a=c+l.indexOf(i[1],i.index);t.queryData(i[2],n,a,a+i[1].length,e)}}})}}),Ft(Rt(t),"clearSuggestions",function(){t._queryId++,t.suggestions={},t.setState({suggestions:{},focusIndex:0})}),Ft(Rt(t),"queryData",function(e,r,o,i,a){var s=t.props,c=s.children,l=s.ignoreAccents,u=function(e,t){return e instanceof Array?function(r,n){for(var o=[],i=0,a=e.length;i<a;++i){var s=e[i].display||e[i].id;Br(s,r,t)>=0&&o.push(e[i])}return o}:e}(n.Children.toArray(c)[r].props.data,l),d=u(e,t.updateSuggestions.bind(null,t._queryId,r,e,o,i,a));d instanceof Array&&t.updateSuggestions(t._queryId,r,e,o,i,a,d)}),Ft(Rt(t),"updateSuggestions",function(e,r,n,o,i,a,s){if(e===t._queryId){t.suggestions=Yr(Yr({},t.suggestions),{},Ft({},r,{queryInfo:{childIndex:r,query:n,querySequenceStart:o,querySequenceEnd:i,plainTextValue:a},results:s}));var c=t.state.focusIndex,l=Rr(t.suggestions);t.setState({suggestions:t.suggestions,focusIndex:c>=l?Math.max(l-1,0):c})}}),Ft(Rt(t),"addMention",function(e,r){var o=e.id,i=e.display,a=r.childIndex,s=r.querySequenceStart,c=r.querySequenceEnd,l=r.plainTextValue,u=t.props.value||"",d=Mr(t.props.children),h=n.Children.toArray(t.props.children)[a].props,g=h.markup,p=h.displayTransform,f=h.appendSpaceOnAdd,m=h.onAdd,y=Tr(u,d,s,"START"),v=y+c-s,b=function(e,t,r){return e.replace(vr,t).replace(br,r)}(g,o,i);f&&(b+=" ");var C=Sr(u,y,v,b);t.inputElement.focus();var w=p(o,i);f&&(w+=" ");var k=s+w.length;t.setState({selectionStart:k,selectionEnd:k,setSelectionAfterMentionChange:!0});var I={target:{value:C}},A=_r(C,d),T=Sr(l,s,c,w);t.executeOnChange(I,C,T,A),m&&m(o,i,y,v),t.clearSuggestions()}),Ft(Rt(t),"isLoading",function(){var e=!1;return n.Children.forEach(t.props.children,function(t){e=e||t&&t.props.isLoading}),e}),Ft(Rt(t),"isOpened",function(){return Dr(t.state.selectionStart)&&(0!==Rr(t.state.suggestions)||t.isLoading())}),Ft(Rt(t),"_queryId",0),t.suggestions={},t.uuidSuggestionsOverlay=Math.random().toString(16).substring(2),t.handleCopy=t.handleCopy.bind(Rt(t)),t.handleCut=t.handleCut.bind(Rt(t)),t.handlePaste=t.handlePaste.bind(Rt(t)),t.state={focusIndex:0,selectionStart:null,selectionEnd:null,suggestions:{},caretPosition:null,suggestionsPosition:{},setSelectionAfterHandlePaste:!1},t}return t=s,(r=[{key:"componentDidMount",value:function(){document.addEventListener("copy",this.handleCopy),document.addEventListener("cut",this.handleCut),document.addEventListener("paste",this.handlePaste),this.updateSuggestionsPosition()}},{key:"componentDidUpdate",value:function(e,t){t.suggestionsPosition===this.state.suggestionsPosition&&this.updateSuggestionsPosition(),this.state.setSelectionAfterMentionChange&&(this.setState({setSelectionAfterMentionChange:!1}),this.setSelection(this.state.selectionStart,this.state.selectionEnd)),this.state.setSelectionAfterHandlePaste&&(this.setState({setSelectionAfterHandlePaste:!1}),this.setSelection(this.state.selectionStart,this.state.selectionEnd))}},{key:"componentWillUnmount",value:function(){document.removeEventListener("copy",this.handleCopy),document.removeEventListener("cut",this.handleCut),document.removeEventListener("paste",this.handlePaste)}},{key:"render",value:function(){return n.createElement("div",_t({ref:this.setContainerElement},this.props.style),this.renderControl(),this.renderSuggestionsOverlay())}},{key:"handlePaste",value:function(e){if(e.target===this.inputElement&&this.supportsClipboardActions(e)){e.preventDefault();var t=this.state,r=t.selectionStart,n=t.selectionEnd,o=this.props,i=o.value,a=o.children,s=Mr(a),c=Tr(i,s,r,"START"),l=Tr(i,s,n,"END"),u=e.clipboardData.getData("text/react-mentions"),d=e.clipboardData.getData("text/plain"),h=Sr(i,c,l,u||d).replace(/\r/g,""),g=Ar(h,s),p={target:Yr(Yr({},e.target),{},{value:h})};this.executeOnChange(p,h,g,_r(h,s));var f=(Er(i,s,r)||r)+Ar(u||d,s).length;this.setState({selectionStart:f,selectionEnd:f,setSelectionAfterHandlePaste:!0})}}},{key:"saveSelectionToClipboard",value:function(e){var t=this.inputElement.selectionStart,r=this.inputElement.selectionEnd,n=this.props,o=n.children,i=n.value,a=Mr(o),s=Tr(i,a,t,"START"),c=Tr(i,a,r,"END");e.clipboardData.setData("text/plain",e.target.value.slice(t,r)),e.clipboardData.setData("text/react-mentions",i.slice(s,c))}},{key:"supportsClipboardActions",value:function(e){return!!e.clipboardData}},{key:"handleCopy",value:function(e){e.target===this.inputElement&&this.supportsClipboardActions(e)&&(e.preventDefault(),this.saveSelectionToClipboard(e))}},{key:"handleCut",value:function(e){if(e.target===this.inputElement&&this.supportsClipboardActions(e)){e.preventDefault(),this.saveSelectionToClipboard(e);var t=this.state,r=t.selectionStart,n=t.selectionEnd,o=this.props,i=o.children,a=o.value,s=Mr(i),c=Tr(a,s,r,"START"),l=Tr(a,s,n,"END"),u=[a.slice(0,c),a.slice(l)].join(""),d=Ar(u,s),h={target:Yr(Yr({},e.target),{},{value:d})};this.executeOnChange(h,u,d,_r(a,s))}}}])&&Pt(t.prototype,r),s}(n.Component);Ft(tn,"propTypes",en),Ft(tn,"defaultProps",{ignoreAccents:!1,singleLine:!1,allowSuggestionsAboveCursor:!1,onKeyDown:function(){return null},onSelect:function(){return null},onBlur:function(){return null}});var rn=function(e,t){var r=parseFloat(window.getComputedStyle(e,null).getPropertyValue(t));return isFinite(r)?r:0},nn=Ur({position:"relative",overflowY:"visible",input:{display:"block",width:"100%",position:"absolute",margin:0,top:0,left:0,boxSizing:"border-box",backgroundColor:"transparent",fontFamily:"inherit",fontSize:"inherit",letterSpacing:"inherit"},"&multiLine":{input:Yr({height:"100%",bottom:0,overflow:"hidden",resize:"none"},"undefined"!=typeof navigator&&/iPhone|iPad|iPod/i.test(navigator.userAgent)?{marginTop:1,marginLeft:-3}:null)}},function(e){var t=e.singleLine;return{"&singleLine":t,"&multiLine":!t}})(tn),on={fontWeight:"inherit"},an=function(e){var t=e.display,r=e.style,o=e.className,i=e.classNames,a=dr(on,{style:r,className:o,classNames:i});return n.createElement("strong",a,t)};an.propTypes={onAdd:fr().func,onRemove:fr().func,renderSuggestion:fr().func,trigger:fr().oneOfType([fr().string,fr().instanceOf(RegExp)]),markup:fr().string,displayTransform:fr().func,allowSpaceInQuery:fr().bool,isLoading:fr().bool},an.defaultProps={trigger:"@",markup:"@[__display__](__id__)",displayTransform:function(e,t){return t||e},onAdd:function(){return null},onRemove:function(){return null},renderSuggestion:null,isLoading:!1,appendSpaceOnAdd:!1};const sn={LIBRARY_NAME:"MSAL.JS",SKU:"msal.js.common",CACHE_PREFIX:"msal",DEFAULT_AUTHORITY:"https://login.microsoftonline.com/common/",DEFAULT_AUTHORITY_HOST:"login.microsoftonline.com",DEFAULT_COMMON_TENANT:"common",ADFS:"adfs",DSTS:"dstsv2",AAD_INSTANCE_DISCOVERY_ENDPT:"https://login.microsoftonline.com/common/discovery/instance?api-version=1.1&authorization_endpoint=",CIAM_AUTH_URL:".ciamlogin.com",AAD_TENANT_DOMAIN_SUFFIX:".onmicrosoft.com",RESOURCE_DELIM:"|",NO_ACCOUNT:"NO_ACCOUNT",CLAIMS:"claims",CONSUMER_UTID:"9188040d-6c67-4c5b-b112-36a304b66dad",OPENID_SCOPE:"openid",PROFILE_SCOPE:"profile",OFFLINE_ACCESS_SCOPE:"offline_access",EMAIL_SCOPE:"email",CODE_GRANT_TYPE:"authorization_code",RT_GRANT_TYPE:"refresh_token",S256_CODE_CHALLENGE_METHOD:"S256",URL_FORM_CONTENT_TYPE:"application/x-www-form-urlencoded;charset=utf-8",AUTHORIZATION_PENDING:"authorization_pending",NOT_DEFINED:"not_defined",EMPTY_STRING:"",NOT_APPLICABLE:"N/A",NOT_AVAILABLE:"Not Available",FORWARD_SLASH:"/",IMDS_ENDPOINT:"http://169.254.169.254/metadata/instance/compute/location",IMDS_VERSION:"2020-06-01",IMDS_TIMEOUT:2e3,AZURE_REGION_AUTO_DISCOVER_FLAG:"TryAutoDetect",REGIONAL_AUTH_PUBLIC_CLOUD_SUFFIX:"login.microsoft.com",KNOWN_PUBLIC_CLOUDS:["login.microsoftonline.com","login.windows.net","login.microsoft.com","sts.windows.net"],SHR_NONCE_VALIDITY:240,INVALID_INSTANCE:"invalid_instance"},cn=[sn.OPENID_SCOPE,sn.PROFILE_SCOPE,sn.OFFLINE_ACCESS_SCOPE],ln=[...cn,sn.EMAIL_SCOPE],un="Content-Type",dn="Retry-After",hn="X-AnchorMailbox",gn="x-ms-request-id",pn="x-ms-httpver",fn="active-account-filters",mn="common",yn="organizations",vn="consumers",bn="access_token",Cn="login",wn="consent",kn="none",In="query",An="Generic",Tn="-",Sn={ID_TOKEN:"IdToken",ACCESS_TOKEN:"AccessToken",ACCESS_TOKEN_WITH_AUTH_SCHEME:"AccessToken_With_AuthScheme",REFRESH_TOKEN:"RefreshToken"},En="appmetadata",_n="1",Pn="authority-metadata",Rn="config",On="cache",Mn="network",Nn="hardcoded_values",xn={SCHEMA_VERSION:5,MAX_LAST_HEADER_BYTES:330,MAX_CACHED_ERRORS:50,CACHE_KEY:"server-telemetry",CATEGORY_SEPARATOR:"|",VALUE_SEPARATOR:",",OVERFLOW_TRUE:"1",OVERFLOW_FALSE:"0",UNKNOWN_ERROR:"unknown_error"},Fn={BEARER:"Bearer",POP:"pop",SSH:"ssh-cert"},Bn="throttling";var Dn;!function(e){e[e.Error=0]="Error",e[e.Warning=1]="Warning",e[e.Info=2]="Info",e[e.Verbose=3]="Verbose",e[e.Trace=4]="Trace"}(Dn||(Dn={}));class qn{constructor(e,t,r){this.level=Dn.Info;const n=e||qn.createDefaultLoggerOptions();this.localCallback=n.loggerCallback||(()=>{}),this.piiLoggingEnabled=n.piiLoggingEnabled||!1,this.level="number"==typeof n.logLevel?n.logLevel:Dn.Info,this.correlationId=n.correlationId||sn.EMPTY_STRING,this.packageName=t||sn.EMPTY_STRING,this.packageVersion=r||sn.EMPTY_STRING}static createDefaultLoggerOptions(){return{loggerCallback:()=>{},piiLoggingEnabled:!1,logLevel:Dn.Info}}clone(e,t,r){return new qn({loggerCallback:this.localCallback,piiLoggingEnabled:this.piiLoggingEnabled,logLevel:this.level,correlationId:r||this.correlationId},e,t)}logMessage(e,t){if(t.logLevel>this.level||!this.piiLoggingEnabled&&t.containsPii)return;const r=`[${(new Date).toUTCString()}] : [${t.correlationId||this.correlationId||""}] : ${this.packageName}@${this.packageVersion} : ${Dn[t.logLevel]} - ${e}`;this.executeCallback(t.logLevel,r,t.containsPii||!1)}executeCallback(e,t,r){this.localCallback&&this.localCallback(e,t,r)}error(e,t){this.logMessage(e,{logLevel:Dn.Error,containsPii:!1,correlationId:t||sn.EMPTY_STRING})}errorPii(e,t){this.logMessage(e,{logLevel:Dn.Error,containsPii:!0,correlationId:t||sn.EMPTY_STRING})}warning(e,t){this.logMessage(e,{logLevel:Dn.Warning,containsPii:!1,correlationId:t||sn.EMPTY_STRING})}warningPii(e,t){this.logMessage(e,{logLevel:Dn.Warning,containsPii:!0,correlationId:t||sn.EMPTY_STRING})}info(e,t){this.logMessage(e,{logLevel:Dn.Info,containsPii:!1,correlationId:t||sn.EMPTY_STRING})}infoPii(e,t){this.logMessage(e,{logLevel:Dn.Info,containsPii:!0,correlationId:t||sn.EMPTY_STRING})}verbose(e,t){this.logMessage(e,{logLevel:Dn.Verbose,containsPii:!1,correlationId:t||sn.EMPTY_STRING})}verbosePii(e,t){this.logMessage(e,{logLevel:Dn.Verbose,containsPii:!0,correlationId:t||sn.EMPTY_STRING})}trace(e,t){this.logMessage(e,{logLevel:Dn.Trace,containsPii:!1,correlationId:t||sn.EMPTY_STRING})}tracePii(e,t){this.logMessage(e,{logLevel:Dn.Trace,containsPii:!0,correlationId:t||sn.EMPTY_STRING})}isPiiLoggingEnabled(){return this.piiLoggingEnabled||!1}}const Ln="OIDC",Hn="EAR",Un="none",jn="unexpected_error",$n="post_request_failed",zn={[jn]:"Unexpected error in authentication.",[$n]:"Post request failed from the network, could be a 4xx/5xx or a network unavailability. Please check the exact error code for details."};class Kn extends Error{constructor(e,t,r){super(t?`${e}: ${t}`:e),Object.setPrototypeOf(this,Kn.prototype),this.errorCode=e||sn.EMPTY_STRING,this.errorMessage=t||sn.EMPTY_STRING,this.subError=r||sn.EMPTY_STRING,this.name="AuthError"}setCorrelationId(e){this.correlationId=e}}function Wn(e,t){return new Kn(e,t?`${zn[e]} ${t}`:zn[e])}const Gn="client_info_decoding_error",Vn="client_info_empty_error",Qn="token_parsing_error",Jn="null_or_empty_token",Yn="endpoints_resolution_error",Xn="network_error",Zn="openid_config_error",eo="hash_not_deserialized",to="invalid_state",ro="state_mismatch",no="state_not_found",oo="nonce_mismatch",io="auth_time_not_found",ao="max_age_transpired",so="multiple_matching_tokens",co="multiple_matching_accounts",lo="multiple_matching_appMetadata",uo="request_cannot_be_made",ho="cannot_remove_empty_scope",go="cannot_append_scopeset",po="empty_input_scopeset",fo="device_code_polling_cancelled",mo="device_code_expired",yo="device_code_unknown_error",vo="no_account_in_silent_request",bo="invalid_cache_record",Co="invalid_cache_environment",wo="no_account_found",ko="no_crypto_object",Io="unexpected_credential_type",Ao="invalid_assertion",To="invalid_client_credential",So="token_refresh_required",Eo="user_timeout_reached",_o="token_claims_cnf_required_for_signedjwt",Po="authorization_code_missing_from_server_response",Ro="binding_key_not_removed",Oo="end_session_endpoint_not_supported",Mo="key_id_missing",No="no_network_connectivity",xo="user_canceled",Fo="missing_tenant_id_error",Bo="method_not_implemented",Do="nested_app_auth_bridge_disabled",qo={[Gn]:"The client info could not be parsed/decoded correctly",[Vn]:"The client info was empty",[Qn]:"Token cannot be parsed",[Jn]:"The token is null or empty",[Yn]:"Endpoints cannot be resolved",[Xn]:"Network request failed",[Zn]:"Could not retrieve endpoints. Check your authority and verify the .well-known/openid-configuration endpoint returns the required endpoints.",[eo]:"The hash parameters could not be deserialized",[to]:"State was not the expected format",[ro]:"State mismatch error",[no]:"State not found",[oo]:"Nonce mismatch error",[io]:"Max Age was requested and the ID token is missing the auth_time variable. auth_time is an optional claim and is not enabled by default - it must be enabled. See https://aka.ms/msaljs/optional-claims for more information.",[ao]:"Max Age is set to 0, or too much time has elapsed since the last end-user authentication.",[so]:"The cache contains multiple tokens satisfying the requirements. Call AcquireToken again providing more requirements such as authority or account.",[co]:"The cache contains multiple accounts satisfying the given parameters. Please pass more info to obtain the correct account",[lo]:"The cache contains multiple appMetadata satisfying the given parameters. Please pass more info to obtain the correct appMetadata",[uo]:"Token request cannot be made without authorization code or refresh token.",[ho]:"Cannot remove null or empty scope from ScopeSet",[go]:"Cannot append ScopeSet",[po]:"Empty input ScopeSet cannot be processed",[fo]:"Caller has cancelled token endpoint polling during device code flow by setting DeviceCodeRequest.cancel = true.",[mo]:"Device code is expired.",[yo]:"Device code stopped polling for unknown reasons.",[vo]:"Please pass an account object, silent flow is not supported without account information",[bo]:"Cache record object was null or undefined.",[Co]:"Invalid environment when attempting to create cache entry",[wo]:"No account found in cache for given key.",[ko]:"No crypto object detected.",[Io]:"Unexpected credential type.",[Ao]:"Client assertion must meet requirements described in https://tools.ietf.org/html/rfc7515",[To]:"Client credential (secret, certificate, or assertion) must not be empty when creating a confidential client. An application should at most have one credential",[So]:"Cannot return token from cache because it must be refreshed. This may be due to one of the following reasons: forceRefresh parameter is set to true, claims have been requested, there is no cached access token or it is expired.",[Eo]:"User defined timeout for device code polling reached",[_o]:"Cannot generate a POP jwt if the token_claims are not populated",[Po]:"Server response does not contain an authorization code to proceed",[Ro]:"Could not remove the credential's binding key from storage.",[Oo]:"The provided authority does not support logout",[Mo]:"A keyId value is missing from the requested bound token's cache record and is required to match the token to it's stored binding key.",[No]:"No network connectivity. Check your internet connection.",[xo]:"User cancelled the flow.",[Fo]:"A tenant id - not common, organizations, or consumers - must be specified when using the client_credentials flow.",[Bo]:"This method has not been implemented",[Do]:"The nested app auth bridge is disabled"};class Lo extends Kn{constructor(e,t){super(e,t?`${qo[e]}: ${t}`:qo[e]),this.name="ClientAuthError",Object.setPrototypeOf(this,Lo.prototype)}}function Ho(e,t){return new Lo(e,t)}const Uo={createNewGuid:()=>{throw Ho(Bo)},base64Decode:()=>{throw Ho(Bo)},base64Encode:()=>{throw Ho(Bo)},base64UrlEncode:()=>{throw Ho(Bo)},encodeKid:()=>{throw Ho(Bo)},async getPublicKeyThumbprint(){throw Ho(Bo)},async removeTokenBindingKey(){throw Ho(Bo)},async clearKeystore(){throw Ho(Bo)},async signJwt(){throw Ho(Bo)},async hashString(){throw Ho(Bo)}},jo="@azure/msal-common",$o="15.8.1";function zo(e,t){const r=function(e){if(!e)throw Ho(Jn);const t=/^([^\.\s]*)\.([^\.\s]+)\.([^\.\s]*)$/.exec(e);if(!t||t.length<4)throw Ho(Qn);return t[2]}(e);try{const e=t(r);return JSON.parse(e)}catch(e){throw Ho(Qn)}}function Ko(e,t){if(0===t||Date.now()-3e5>e+t)throw Ho(ao)}function Wo(){return Math.round((new Date).getTime()/1e3)}function Go(e){return e.getTime()/1e3}function Vo(e){return e?new Date(1e3*Number(e)):new Date}function Qo(e,t){const r=Number(e)||0;return Wo()+t>r}function Jo(e){return[ti(e),ri(e),ni(e),oi(e),ii(e)].join(Tn).toLowerCase()}function Yo(e,t,r,n,o){return{credentialType:Sn.ID_TOKEN,homeAccountId:e,environment:t,clientId:n,secret:r,realm:o}}function Xo(e,t,r,n,o,i,a,s,c,l,u,d,h,g,p){const f={homeAccountId:e,credentialType:Sn.ACCESS_TOKEN,secret:r,cachedAt:Wo().toString(),expiresOn:a.toString(),extendedExpiresOn:s.toString(),environment:t,clientId:n,realm:o,target:i,tokenType:u||Fn.BEARER};if(d&&(f.userAssertionHash=d),l&&(f.refreshOn=l.toString()),g&&(f.requestedClaims=g,f.requestedClaimsHash=p),f.tokenType?.toLowerCase()!==Fn.BEARER.toLowerCase())switch(f.credentialType=Sn.ACCESS_TOKEN_WITH_AUTH_SCHEME,f.tokenType){case Fn.POP:const e=zo(r,c);if(!e?.cnf?.kid)throw Ho(_o);f.keyId=e.cnf.kid;break;case Fn.SSH:f.keyId=h}return f}function Zo(e,t,r,n,o,i,a){const s={credentialType:Sn.REFRESH_TOKEN,homeAccountId:e,environment:t,clientId:n,secret:r};return i&&(s.userAssertionHash=i),o&&(s.familyId=o),a&&(s.expiresOn=a.toString()),s}function ei(e){return e.hasOwnProperty("homeAccountId")&&e.hasOwnProperty("environment")&&e.hasOwnProperty("credentialType")&&e.hasOwnProperty("clientId")&&e.hasOwnProperty("secret")}function ti(e){return[e.homeAccountId,e.environment].join(Tn).toLowerCase()}function ri(e){const t=e.credentialType===Sn.REFRESH_TOKEN&&e.familyId||e.clientId;return[e.credentialType,t,e.realm||""].join(Tn).toLowerCase()}function ni(e){return(e.target||"").toLowerCase()}function oi(e){return(e.requestedClaimsHash||"").toLowerCase()}function ii(e){return e.tokenType&&e.tokenType.toLowerCase()!==Fn.BEARER.toLowerCase()?e.tokenType.toLowerCase():""}function ai(){return Wo()+86400}function si(e,t,r){e.authorization_endpoint=t.authorization_endpoint,e.token_endpoint=t.token_endpoint,e.end_session_endpoint=t.end_session_endpoint,e.issuer=t.issuer,e.endpointsFromNetwork=r,e.jwks_uri=t.jwks_uri}function ci(e,t,r){e.aliases=t.aliases,e.preferred_cache=t.preferred_cache,e.preferred_network=t.preferred_network,e.aliasesFromNetwork=r}function li(e){return e.expiresAt<=Wo()}r(64583).Promise;const ui="redirect_uri_empty",di="claims_request_parsing_error",hi="authority_uri_insecure",gi="url_parse_error",pi="empty_url_error",fi="empty_input_scopes_error",mi="invalid_claims",yi="token_request_empty",vi="logout_request_empty",bi="invalid_code_challenge_method",Ci="pkce_params_missing",wi="invalid_cloud_discovery_metadata",ki="invalid_authority_metadata",Ii="untrusted_authority",Ai="missing_ssh_jwk",Ti="missing_ssh_kid",Si="missing_nonce_authentication_header",Ei="invalid_authentication_header",_i="cannot_set_OIDCOptions",Pi="cannot_allow_platform_broker",Ri="authority_mismatch",Oi={[ui]:"A redirect URI is required for all calls, and none has been set.",[di]:"Could not parse the given claims request object.",[hi]:"Authority URIs must use https.  Please see here for valid authority configuration options: https://docs.microsoft.com/en-us/azure/active-directory/develop/msal-js-initializing-client-applications#configuration-options",[gi]:"URL could not be parsed into appropriate segments.",[pi]:"URL was empty or null.",[fi]:"Scopes cannot be passed as null, undefined or empty array because they are required to obtain an access token.",[mi]:"Given claims parameter must be a stringified JSON object.",[yi]:"Token request was empty and not found in cache.",[vi]:"The logout request was null or undefined.",[bi]:'code_challenge_method passed is invalid. Valid values are "plain" and "S256".',[Ci]:"Both params: code_challenge and code_challenge_method are to be passed if to be sent in the request",[wi]:"Invalid cloudDiscoveryMetadata provided. Must be a stringified JSON object containing tenant_discovery_endpoint and metadata fields",[ki]:"Invalid authorityMetadata provided. Must by a stringified JSON object containing authorization_endpoint, token_endpoint, issuer fields.",[Ii]:"The provided authority is not a trusted authority. Please include this authority in the knownAuthorities config parameter.",[Ai]:"Missing sshJwk in SSH certificate request. A stringified JSON Web Key is required when using the SSH authentication scheme.",[Ti]:"Missing sshKid in SSH certificate request. A string that uniquely identifies the public SSH key is required when using the SSH authentication scheme.",[Si]:"Unable to find an authentication header containing server nonce. Either the Authentication-Info or WWW-Authenticate headers must be present in order to obtain a server nonce.",[Ei]:"Invalid authentication header provided",[_i]:"Cannot set OIDCOptions parameter. Please change the protocol mode to OIDC or use a non-Microsoft authority.",[Pi]:"Cannot set allowPlatformBroker parameter to true when not in AAD protocol mode.",[Ri]:"Authority mismatch error. Authority provided in login request or PublicClientApplication config does not match the environment of the provided account. Please use a matching account or make an interactive request to login to this authority."};class Mi extends Kn{constructor(e){super(e,Oi[e]),this.name="ClientConfigurationError",Object.setPrototypeOf(this,Mi.prototype)}}function Ni(e){return new Mi(e)}class xi{static isEmptyObj(e){if(e)try{const t=JSON.parse(e);return 0===Object.keys(t).length}catch(e){}return!0}static startsWith(e,t){return 0===e.indexOf(t)}static endsWith(e,t){return e.length>=t.length&&e.lastIndexOf(t)===e.length-t.length}static queryStringToObject(e){const t={},r=e.split("&"),n=e=>decodeURIComponent(e.replace(/\+/g," "));return r.forEach(e=>{if(e.trim()){const[r,o]=e.split(/=(.+)/g,2);r&&o&&(t[n(r)]=n(o))}}),t}static trimArrayEntries(e){return e.map(e=>e.trim())}static removeEmptyStringsFromArray(e){return e.filter(e=>!!e)}static jsonParseHelper(e){try{return JSON.parse(e)}catch(e){return null}}static matchPattern(e,t){return new RegExp(e.replace(/\\/g,"\\\\").replace(/\*/g,"[^ ]*").replace(/\?/g,"\\?")).test(t)}}class Fi{constructor(e){const t=e?xi.trimArrayEntries([...e]):[],r=t?xi.removeEmptyStringsFromArray(t):[];if(!r||!r.length)throw Ni(fi);this.scopes=new Set,r.forEach(e=>this.scopes.add(e))}static fromString(e){const t=(e||sn.EMPTY_STRING).split(" ");return new Fi(t)}static createSearchScopes(e){const t=new Fi(e);return t.containsOnlyOIDCScopes()?t.removeScope(sn.OFFLINE_ACCESS_SCOPE):t.removeOIDCScopes(),t}containsScope(e){const t=this.printScopesLowerCase().split(" "),r=new Fi(t);return!!e&&r.scopes.has(e.toLowerCase())}containsScopeSet(e){return!(!e||e.scopes.size<=0)&&this.scopes.size>=e.scopes.size&&e.asArray().every(e=>this.containsScope(e))}containsOnlyOIDCScopes(){let e=0;return ln.forEach(t=>{this.containsScope(t)&&(e+=1)}),this.scopes.size===e}appendScope(e){e&&this.scopes.add(e.trim())}appendScopes(e){try{e.forEach(e=>this.appendScope(e))}catch(e){throw Ho(go)}}removeScope(e){if(!e)throw Ho(ho);this.scopes.delete(e.trim())}removeOIDCScopes(){ln.forEach(e=>{this.scopes.delete(e)})}unionScopeSets(e){if(!e)throw Ho(po);const t=new Set;return e.scopes.forEach(e=>t.add(e.toLowerCase())),this.scopes.forEach(e=>t.add(e.toLowerCase())),t}intersectingScopeSets(e){if(!e)throw Ho(po);e.containsOnlyOIDCScopes()||e.removeOIDCScopes();const t=this.unionScopeSets(e),r=e.getScopeCount(),n=this.getScopeCount();return t.size<n+r}getScopeCount(){return this.scopes.size}asArray(){const e=[];return this.scopes.forEach(t=>e.push(t)),e}printScopes(){return this.scopes?this.asArray().join(" "):sn.EMPTY_STRING}printScopesLowerCase(){return this.printScopes().toLowerCase()}}function Bi(e,t){if(!e)throw Ho(Vn);try{const r=t(e);return JSON.parse(r)}catch(e){throw Ho(Gn)}}function Di(e){if(!e)throw Ho(Gn);const t=e.split(".",2);return{uid:t[0],utid:t.length<2?sn.EMPTY_STRING:t[1]}}function qi(e,t){return!!e&&!!t&&e===t.split(".")[1]}function Li(e,t,r,n){if(n){const{oid:t,sub:r,tid:o,name:i,tfp:a,acr:s}=n,c=o||a||s||"";return{tenantId:c,localAccountId:t||r||"",name:i,isHomeTenant:qi(c,e)}}return{tenantId:r,localAccountId:t,isHomeTenant:qi(r,e)}}function Hi(e,t,r,n){let o=e;if(t){const{isHomeTenant:r,...n}=t;o={...e,...n}}if(r){const{isHomeTenant:t,...i}=Li(e.homeAccountId,e.localAccountId,e.tenantId,r);return o={...o,...i,idTokenClaims:r,idToken:n},o}return o}function Ui(e){return e&&(e.tid||e.tfp||e.acr)||null}class ji{generateAccountId(){return[this.homeAccountId,this.environment].join(Tn).toLowerCase()}generateAccountKey(){return ji.generateAccountCacheKey({homeAccountId:this.homeAccountId,environment:this.environment,tenantId:this.realm,username:this.username,localAccountId:this.localAccountId})}getAccountInfo(){return{homeAccountId:this.homeAccountId,environment:this.environment,tenantId:this.realm,username:this.username,localAccountId:this.localAccountId,name:this.name,nativeAccountId:this.nativeAccountId,authorityType:this.authorityType,tenantProfiles:new Map((this.tenantProfiles||[]).map(e=>[e.tenantId,e]))}}isSingleTenant(){return!this.tenantProfiles}static generateAccountCacheKey(e){const t=e.homeAccountId.split(".")[1];return[e.homeAccountId,e.environment||"",t||e.tenantId||""].join(Tn).toLowerCase()}static createAccount(e,t,r){const n=new ji;let o;1===t.authorityType?n.authorityType="ADFS":t.protocolMode===Ln?n.authorityType=An:n.authorityType="MSSTS",e.clientInfo&&r&&(o=Bi(e.clientInfo,r)),n.clientInfo=e.clientInfo,n.homeAccountId=e.homeAccountId,n.nativeAccountId=e.nativeAccountId;const i=e.environment||t&&t.getPreferredCache();if(!i)throw Ho(Co);n.environment=i,n.realm=o?.utid||Ui(e.idTokenClaims)||"",n.localAccountId=o?.uid||e.idTokenClaims?.oid||e.idTokenClaims?.sub||"";const a=e.idTokenClaims?.preferred_username||e.idTokenClaims?.upn,s=e.idTokenClaims?.emails?e.idTokenClaims.emails[0]:null;if(n.username=a||s||"",n.name=e.idTokenClaims?.name||"",n.cloudGraphHostName=e.cloudGraphHostName,n.msGraphHost=e.msGraphHost,e.tenantProfiles)n.tenantProfiles=e.tenantProfiles;else{const t=Li(e.homeAccountId,n.localAccountId,n.realm,e.idTokenClaims);n.tenantProfiles=[t]}return n}static createFromAccountInfo(e,t,r){const n=new ji;return n.authorityType=e.authorityType||An,n.homeAccountId=e.homeAccountId,n.localAccountId=e.localAccountId,n.nativeAccountId=e.nativeAccountId,n.realm=e.tenantId,n.environment=e.environment,n.username=e.username,n.name=e.name,n.cloudGraphHostName=t,n.msGraphHost=r,n.tenantProfiles=Array.from(e.tenantProfiles?.values()||[]),n}static generateHomeAccountId(e,t,r,n,o){if(1!==t&&2!==t){if(e)try{const t=Bi(e,n.base64Decode);if(t.uid&&t.utid)return`${t.uid}.${t.utid}`}catch(e){}r.warning("No client info in response")}return o?.sub||""}static isAccountEntity(e){return!!e&&e.hasOwnProperty("homeAccountId")&&e.hasOwnProperty("environment")&&e.hasOwnProperty("realm")&&e.hasOwnProperty("localAccountId")&&e.hasOwnProperty("username")&&e.hasOwnProperty("authorityType")}static accountInfoIsEqual(e,t,r){if(!e||!t)return!1;let n=!0;if(r){const r=e.idTokenClaims||{},o=t.idTokenClaims||{};n=r.iat===o.iat&&r.nonce===o.nonce}return e.homeAccountId===t.homeAccountId&&e.localAccountId===t.localAccountId&&e.username===t.username&&e.tenantId===t.tenantId&&e.environment===t.environment&&e.nativeAccountId===t.nativeAccountId&&n}}function $i(e){return e.startsWith("#/")?e.substring(2):e.startsWith("#")||e.startsWith("?")?e.substring(1):e}function zi(e){if(!e||e.indexOf("=")<0)return null;try{const t=$i(e),r=Object.fromEntries(new URLSearchParams(t));if(r.code||r.ear_jwe||r.error||r.error_description||r.state)return r}catch(e){throw Ho(eo)}return null}function Ki(e,t=!0,r){const n=new Array;return e.forEach((e,o)=>{!t&&r&&o in r?n.push(`${o}=${e}`):n.push(`${o}=${encodeURIComponent(e)}`)}),n.join("&")}class Wi{get urlString(){return this._urlString}constructor(e){if(this._urlString=e,!this._urlString)throw Ni(pi);e.includes("#")||(this._urlString=Wi.canonicalizeUri(e))}static canonicalizeUri(e){if(e){let t=e.toLowerCase();return xi.endsWith(t,"?")?t=t.slice(0,-1):xi.endsWith(t,"?/")&&(t=t.slice(0,-2)),xi.endsWith(t,"/")||(t+="/"),t}return e}validateAsUri(){let e;try{e=this.getUrlComponents()}catch(e){throw Ni(gi)}if(!e.HostNameAndPort||!e.PathSegments)throw Ni(gi);if(!e.Protocol||"https:"!==e.Protocol.toLowerCase())throw Ni(hi)}static appendQueryString(e,t){return t?e.indexOf("?")<0?`${e}?${t}`:`${e}&${t}`:e}static removeHashFromUrl(e){return Wi.canonicalizeUri(e.split("#")[0])}replaceTenantPath(e){const t=this.getUrlComponents(),r=t.PathSegments;return!e||0===r.length||r[0]!==mn&&r[0]!==yn||(r[0]=e),Wi.constructAuthorityUriFromObject(t)}getUrlComponents(){const e=RegExp("^(([^:/?#]+):)?(//([^/?#]*))?([^?#]*)(\\?([^#]*))?(#(.*))?"),t=this.urlString.match(e);if(!t)throw Ni(gi);const r={Protocol:t[1],HostNameAndPort:t[4],AbsolutePath:t[5],QueryString:t[7]};let n=r.AbsolutePath.split("/");return n=n.filter(e=>e&&e.length>0),r.PathSegments=n,r.QueryString&&r.QueryString.endsWith("/")&&(r.QueryString=r.QueryString.substring(0,r.QueryString.length-1)),r}static getDomainFromUrl(e){const t=RegExp("^([^:/?#]+://)?([^/?#]*)"),r=e.match(t);if(!r)throw Ni(gi);return r[2]}static getAbsoluteUrl(e,t){if(e[0]===sn.FORWARD_SLASH){const r=new Wi(t).getUrlComponents();return r.Protocol+"//"+r.HostNameAndPort+e}return e}static constructAuthorityUriFromObject(e){return new Wi(e.Protocol+"//"+e.HostNameAndPort+"/"+e.PathSegments.join("/"))}static hashContainsKnownProperties(e){return!!zi(e)}}const Gi={"login.microsoftonline.com":{token_endpoint:"https://login.microsoftonline.com/{tenantid}/oauth2/v2.0/token",jwks_uri:"https://login.microsoftonline.com/{tenantid}/discovery/v2.0/keys",issuer:"https://login.microsoftonline.com/{tenantid}/v2.0",authorization_endpoint:"https://login.microsoftonline.com/{tenantid}/oauth2/v2.0/authorize",end_session_endpoint:"https://login.microsoftonline.com/{tenantid}/oauth2/v2.0/logout"},"login.chinacloudapi.cn":{token_endpoint:"https://login.chinacloudapi.cn/{tenantid}/oauth2/v2.0/token",jwks_uri:"https://login.chinacloudapi.cn/{tenantid}/discovery/v2.0/keys",issuer:"https://login.partner.microsoftonline.cn/{tenantid}/v2.0",authorization_endpoint:"https://login.chinacloudapi.cn/{tenantid}/oauth2/v2.0/authorize",end_session_endpoint:"https://login.chinacloudapi.cn/{tenantid}/oauth2/v2.0/logout"},"login.microsoftonline.us":{token_endpoint:"https://login.microsoftonline.us/{tenantid}/oauth2/v2.0/token",jwks_uri:"https://login.microsoftonline.us/{tenantid}/discovery/v2.0/keys",issuer:"https://login.microsoftonline.us/{tenantid}/v2.0",authorization_endpoint:"https://login.microsoftonline.us/{tenantid}/oauth2/v2.0/authorize",end_session_endpoint:"https://login.microsoftonline.us/{tenantid}/oauth2/v2.0/logout"}},Vi={metadata:[{preferred_network:"login.microsoftonline.com",preferred_cache:"login.windows.net",aliases:["login.microsoftonline.com","login.windows.net","login.microsoft.com","sts.windows.net"]},{preferred_network:"login.partner.microsoftonline.cn",preferred_cache:"login.partner.microsoftonline.cn",aliases:["login.partner.microsoftonline.cn","login.chinacloudapi.cn"]},{preferred_network:"login.microsoftonline.de",preferred_cache:"login.microsoftonline.de",aliases:["login.microsoftonline.de"]},{preferred_network:"login.microsoftonline.us",preferred_cache:"login.microsoftonline.us",aliases:["login.microsoftonline.us","login.usgovcloudapi.net"]},{preferred_network:"login-us.microsoftonline.com",preferred_cache:"login-us.microsoftonline.com",aliases:["login-us.microsoftonline.com"]}]},Qi=new Set;function Ji(e,t,r,n){if(n?.trace(`getAliasesFromMetadata called with source: ${r}`),e&&t){const o=Yi(t,e);if(o)return n?.trace(`getAliasesFromMetadata: found cloud discovery metadata in ${r}, returning aliases`),o.aliases;n?.trace(`getAliasesFromMetadata: did not find cloud discovery metadata in ${r}`)}return null}function Yi(e,t){for(let r=0;r<e.length;r++){const n=e[r];if(n.aliases.includes(t))return n}return null}Vi.metadata.forEach(e=>{e.aliases.forEach(e=>{Qi.add(e)})});const Xi="cache_quota_exceeded",Zi="cache_error_unknown",ea={[Xi]:"Exceeded cache storage capacity.",[Zi]:"Unexpected error occurred when using cache storage."};class ta extends Kn{constructor(e,t){const r=t||(ea[e]?ea[e]:ea[Zi]);super(`${e}: ${r}`),Object.setPrototypeOf(this,ta.prototype),this.name="CacheError",this.errorCode=e,this.errorMessage=r}}function ra(e){return e instanceof Error?"QuotaExceededError"===e.name||"NS_ERROR_DOM_QUOTA_REACHED"===e.name||e.message.includes("exceeded the quota")?new ta(Xi):new ta(e.name,e.message):new ta(Zi)}class na{constructor(e,t,r,n,o){this.clientId=e,this.cryptoImpl=t,this.commonLogger=r.clone(jo,$o),this.staticAuthorityOptions=o,this.performanceClient=n}getAllAccounts(e,t){return this.buildTenantProfiles(this.getAccountsFilteredBy(e,t),t,e)}getAccountInfoFilteredBy(e,t){const r=this.getAllAccounts(e,t);return r.length>1?r.sort(e=>e.idTokenClaims?-1:1)[0]:1===r.length?r[0]:null}getBaseAccountInfo(e,t){const r=this.getAccountsFilteredBy(e,t);return r.length>0?r[0].getAccountInfo():null}buildTenantProfiles(e,t,r){return e.flatMap(e=>this.getTenantProfilesFromAccountEntity(e,t,r?.tenantId,r))}getTenantedAccountInfoByFilter(e,t,r,n,o){let i,a=null;if(o&&!this.tenantProfileMatchesFilter(r,o))return null;const s=this.getIdToken(e,n,t,r.tenantId);return s&&(i=zo(s.secret,this.cryptoImpl.base64Decode),!this.idTokenClaimsMatchTenantProfileFilter(i,o))?null:(a=Hi(e,r,i,s?.secret),a)}getTenantProfilesFromAccountEntity(e,t,r,n){const o=e.getAccountInfo();let i=o.tenantProfiles||new Map;const a=this.getTokenKeys();if(r){const e=i.get(r);if(!e)return[];i=new Map([[r,e]])}const s=[];return i.forEach(e=>{const r=this.getTenantedAccountInfoByFilter(o,a,e,t,n);r&&s.push(r)}),s}tenantProfileMatchesFilter(e,t){return!(t.localAccountId&&!this.matchLocalAccountIdFromTenantProfile(e,t.localAccountId)||t.name&&e.name!==t.name||void 0!==t.isHomeTenant&&e.isHomeTenant!==t.isHomeTenant)}idTokenClaimsMatchTenantProfileFilter(e,t){if(t){if(t.localAccountId&&!this.matchLocalAccountIdFromTokenClaims(e,t.localAccountId))return!1;if(t.loginHint&&!this.matchLoginHintFromTokenClaims(e,t.loginHint))return!1;if(t.username&&!this.matchUsername(e.preferred_username,t.username))return!1;if(t.name&&!this.matchName(e,t.name))return!1;if(t.sid&&!this.matchSid(e,t.sid))return!1}return!0}async saveCacheRecord(e,t,r){if(!e)throw Ho(bo);try{e.account&&await this.setAccount(e.account,t),e.idToken&&!1!==r?.idToken&&await this.setIdTokenCredential(e.idToken,t),e.accessToken&&!1!==r?.accessToken&&await this.saveAccessToken(e.accessToken,t),e.refreshToken&&!1!==r?.refreshToken&&await this.setRefreshTokenCredential(e.refreshToken,t),e.appMetadata&&this.setAppMetadata(e.appMetadata,t)}catch(e){throw this.commonLogger?.error("CacheManager.saveCacheRecord: failed"),e instanceof Kn?e:ra(e)}}async saveAccessToken(e,t){const r={clientId:e.clientId,credentialType:e.credentialType,environment:e.environment,homeAccountId:e.homeAccountId,realm:e.realm,tokenType:e.tokenType,requestedClaimsHash:e.requestedClaimsHash},n=this.getTokenKeys(),o=Fi.fromString(e.target);n.accessToken.forEach(e=>{if(!this.accessTokenKeyMatchesFilter(e,r,!1))return;const n=this.getAccessTokenCredential(e,t);n&&this.credentialMatchesFilter(n,r)&&Fi.fromString(n.target).intersectingScopeSets(o)&&this.removeAccessToken(e,t)}),await this.setAccessTokenCredential(e,t)}getAccountsFilteredBy(e,t){const r=this.getAccountKeys(),n=[];return r.forEach(r=>{if(!this.isAccountKey(r,e.homeAccountId))return;const o=this.getAccount(r,t);if(!o)return;if(e.homeAccountId&&!this.matchHomeAccountId(o,e.homeAccountId))return;if(e.username&&!this.matchUsername(o.username,e.username))return;if(e.environment&&!this.matchEnvironment(o,e.environment))return;if(e.realm&&!this.matchRealm(o,e.realm))return;if(e.nativeAccountId&&!this.matchNativeAccountId(o,e.nativeAccountId))return;if(e.authorityType&&!this.matchAuthorityType(o,e.authorityType))return;const i={localAccountId:e?.localAccountId,name:e?.name},a=o.tenantProfiles?.filter(e=>this.tenantProfileMatchesFilter(e,i));a&&0===a.length||n.push(o)}),n}isAccountKey(e,t,r){return!(e.split(Tn).length<3||t&&!e.toLowerCase().includes(t.toLowerCase())||r&&!e.toLowerCase().includes(r.toLowerCase()))}isCredentialKey(e){if(e.split(Tn).length<6)return!1;const t=e.toLowerCase();if(-1===t.indexOf(Sn.ID_TOKEN.toLowerCase())&&-1===t.indexOf(Sn.ACCESS_TOKEN.toLowerCase())&&-1===t.indexOf(Sn.ACCESS_TOKEN_WITH_AUTH_SCHEME.toLowerCase())&&-1===t.indexOf(Sn.REFRESH_TOKEN.toLowerCase()))return!1;if(t.indexOf(Sn.REFRESH_TOKEN.toLowerCase())>-1){const e=`${Sn.REFRESH_TOKEN}${Tn}${this.clientId}${Tn}`,r=`${Sn.REFRESH_TOKEN}${Tn}${_n}${Tn}`;if(-1===t.indexOf(e.toLowerCase())&&-1===t.indexOf(r.toLowerCase()))return!1}else if(-1===t.indexOf(this.clientId.toLowerCase()))return!1;return!0}credentialMatchesFilter(e,t){if(t.clientId&&!this.matchClientId(e,t.clientId))return!1;if(t.userAssertionHash&&!this.matchUserAssertionHash(e,t.userAssertionHash))return!1;if("string"==typeof t.homeAccountId&&!this.matchHomeAccountId(e,t.homeAccountId))return!1;if(t.environment&&!this.matchEnvironment(e,t.environment))return!1;if(t.realm&&!this.matchRealm(e,t.realm))return!1;if(t.credentialType&&!this.matchCredentialType(e,t.credentialType))return!1;if(t.familyId&&!this.matchFamilyId(e,t.familyId))return!1;if(t.target&&!this.matchTarget(e,t.target))return!1;if((t.requestedClaimsHash||e.requestedClaimsHash)&&e.requestedClaimsHash!==t.requestedClaimsHash)return!1;if(e.credentialType===Sn.ACCESS_TOKEN_WITH_AUTH_SCHEME){if(t.tokenType&&!this.matchTokenType(e,t.tokenType))return!1;if(t.tokenType===Fn.SSH&&t.keyId&&!this.matchKeyId(e,t.keyId))return!1}return!0}getAppMetadataFilteredBy(e){const t=this.getKeys(),r={};return t.forEach(t=>{if(!this.isAppMetadata(t))return;const n=this.getAppMetadata(t);n&&(e.environment&&!this.matchEnvironment(n,e.environment)||e.clientId&&!this.matchClientId(n,e.clientId)||(r[t]=n))}),r}getAuthorityMetadataByAlias(e){const t=this.getAuthorityMetadataKeys();let r=null;return t.forEach(t=>{if(!this.isAuthorityMetadata(t)||-1===t.indexOf(this.clientId))return;const n=this.getAuthorityMetadata(t);n&&-1!==n.aliases.indexOf(e)&&(r=n)}),r}removeAllAccounts(e){this.getAccountKeys().forEach(t=>{this.removeAccount(t,e)})}removeAccount(e,t){const r=this.getAccount(e,t);r&&(this.removeAccountContext(r,t),this.removeItem(e,t))}removeAccountContext(e,t){const r=this.getTokenKeys(),n=e.generateAccountId();r.idToken.forEach(e=>{0===e.indexOf(n)&&this.removeIdToken(e,t)}),r.accessToken.forEach(e=>{0===e.indexOf(n)&&this.removeAccessToken(e,t)}),r.refreshToken.forEach(e=>{0===e.indexOf(n)&&this.removeRefreshToken(e,t)})}removeAccessToken(e,t){const r=this.getAccessTokenCredential(e,t);if(this.removeItem(e,t),this.performanceClient.incrementFields({accessTokensRemoved:1},t),!r||r.credentialType.toLowerCase()!==Sn.ACCESS_TOKEN_WITH_AUTH_SCHEME.toLowerCase()||r.tokenType!==Fn.POP)return;const n=r.keyId;n&&this.cryptoImpl.removeTokenBindingKey(n).catch(()=>{this.commonLogger.error(`Failed to remove token binding key ${n}`,t),this.performanceClient?.incrementFields({removeTokenBindingKeyFailure:1},t)})}removeAppMetadata(e){return this.getKeys().forEach(t=>{this.isAppMetadata(t)&&this.removeItem(t,e)}),!0}readAccountFromCache(e,t){const r=ji.generateAccountCacheKey(e);return this.getAccount(r,t)}getIdToken(e,t,r,n,o){this.commonLogger.trace("CacheManager - getIdToken called");const i={homeAccountId:e.homeAccountId,environment:e.environment,credentialType:Sn.ID_TOKEN,clientId:this.clientId,realm:n},a=this.getIdTokensByFilter(i,t,r),s=a.size;if(s<1)return this.commonLogger.info("CacheManager:getIdToken - No token found"),null;if(s>1){let r=a;if(!n){const t=new Map;a.forEach((r,n)=>{r.realm===e.tenantId&&t.set(n,r)});const n=t.size;if(n<1)return this.commonLogger.info("CacheManager:getIdToken - Multiple ID tokens found for account but none match account entity tenant id, returning first result"),a.values().next().value;if(1===n)return this.commonLogger.info("CacheManager:getIdToken - Multiple ID tokens found for account, defaulting to home tenant profile"),t.values().next().value;r=t}return this.commonLogger.info("CacheManager:getIdToken - Multiple matching ID tokens found, clearing them"),r.forEach((e,r)=>{this.removeIdToken(r,t)}),o&&t&&o.addFields({multiMatchedID:a.size},t),null}return this.commonLogger.info("CacheManager:getIdToken - Returning ID token"),a.values().next().value}getIdTokensByFilter(e,t,r){const n=r&&r.idToken||this.getTokenKeys().idToken,o=new Map;return n.forEach(r=>{if(!this.idTokenKeyMatchesFilter(r,{clientId:this.clientId,...e}))return;const n=this.getIdTokenCredential(r,t);n&&this.credentialMatchesFilter(n,e)&&o.set(r,n)}),o}idTokenKeyMatchesFilter(e,t){const r=e.toLowerCase();return!(t.clientId&&-1===r.indexOf(t.clientId.toLowerCase())||t.homeAccountId&&-1===r.indexOf(t.homeAccountId.toLowerCase()))}removeIdToken(e,t){this.removeItem(e,t)}removeRefreshToken(e,t){this.removeItem(e,t)}getAccessToken(e,t,r,n){const o=t.correlationId;this.commonLogger.trace("CacheManager - getAccessToken called",o);const i=Fi.createSearchScopes(t.scopes),a=t.authenticationScheme||Fn.BEARER,s=a&&a.toLowerCase()!==Fn.BEARER.toLowerCase()?Sn.ACCESS_TOKEN_WITH_AUTH_SCHEME:Sn.ACCESS_TOKEN,c={homeAccountId:e.homeAccountId,environment:e.environment,credentialType:s,clientId:this.clientId,realm:n||e.tenantId,target:i,tokenType:a,keyId:t.sshKid,requestedClaimsHash:t.requestedClaimsHash},l=r&&r.accessToken||this.getTokenKeys().accessToken,u=[];l.forEach(e=>{if(this.accessTokenKeyMatchesFilter(e,c,!0)){const t=this.getAccessTokenCredential(e,o);t&&this.credentialMatchesFilter(t,c)&&u.push(t)}});const d=u.length;return d<1?(this.commonLogger.info("CacheManager:getAccessToken - No token found",o),null):d>1?(this.commonLogger.info("CacheManager:getAccessToken - Multiple access tokens found, clearing them",o),u.forEach(e=>{this.removeAccessToken(Jo(e),o)}),this.performanceClient.addFields({multiMatchedAT:u.length},o),null):(this.commonLogger.info("CacheManager:getAccessToken - Returning access token",o),u[0])}accessTokenKeyMatchesFilter(e,t,r){const n=e.toLowerCase();if(t.clientId&&-1===n.indexOf(t.clientId.toLowerCase()))return!1;if(t.homeAccountId&&-1===n.indexOf(t.homeAccountId.toLowerCase()))return!1;if(t.realm&&-1===n.indexOf(t.realm.toLowerCase()))return!1;if(t.requestedClaimsHash&&-1===n.indexOf(t.requestedClaimsHash.toLowerCase()))return!1;if(t.target){const e=t.target.asArray();for(let t=0;t<e.length;t++){if(r&&!n.includes(e[t].toLowerCase()))return!1;if(!r&&n.includes(e[t].toLowerCase()))return!0}}return!0}getAccessTokensByFilter(e,t){const r=this.getTokenKeys(),n=[];return r.accessToken.forEach(r=>{if(!this.accessTokenKeyMatchesFilter(r,e,!0))return;const o=this.getAccessTokenCredential(r,t);o&&this.credentialMatchesFilter(o,e)&&n.push(o)}),n}getRefreshToken(e,t,r,n,o){this.commonLogger.trace("CacheManager - getRefreshToken called");const i=t?_n:void 0,a={homeAccountId:e.homeAccountId,environment:e.environment,credentialType:Sn.REFRESH_TOKEN,clientId:this.clientId,familyId:i},s=n&&n.refreshToken||this.getTokenKeys().refreshToken,c=[];s.forEach(e=>{if(this.refreshTokenKeyMatchesFilter(e,a)){const t=this.getRefreshTokenCredential(e,r);t&&this.credentialMatchesFilter(t,a)&&c.push(t)}});const l=c.length;return l<1?(this.commonLogger.info("CacheManager:getRefreshToken - No refresh token found."),null):(l>1&&o&&r&&o.addFields({multiMatchedRT:l},r),this.commonLogger.info("CacheManager:getRefreshToken - returning refresh token"),c[0])}refreshTokenKeyMatchesFilter(e,t){const r=e.toLowerCase();return!(t.familyId&&-1===r.indexOf(t.familyId.toLowerCase())||!t.familyId&&t.clientId&&-1===r.indexOf(t.clientId.toLowerCase())||t.homeAccountId&&-1===r.indexOf(t.homeAccountId.toLowerCase()))}readAppMetadataFromCache(e){const t={environment:e,clientId:this.clientId},r=this.getAppMetadataFilteredBy(t),n=Object.keys(r).map(e=>r[e]),o=n.length;if(o<1)return null;if(o>1)throw Ho(lo);return n[0]}isAppMetadataFOCI(e){const t=this.readAppMetadataFromCache(e);return!(!t||t.familyId!==_n)}matchHomeAccountId(e,t){return!("string"!=typeof e.homeAccountId||t!==e.homeAccountId)}matchLocalAccountIdFromTokenClaims(e,t){return t===(e.oid||e.sub)}matchLocalAccountIdFromTenantProfile(e,t){return e.localAccountId===t}matchName(e,t){return!(t.toLowerCase()!==e.name?.toLowerCase())}matchUsername(e,t){return!(!e||"string"!=typeof e||t?.toLowerCase()!==e.toLowerCase())}matchUserAssertionHash(e,t){return!(!e.userAssertionHash||t!==e.userAssertionHash)}matchEnvironment(e,t){if(this.staticAuthorityOptions){const r=function(e,t){let r;const n=e.canonicalAuthority;if(n){const o=new Wi(n).getUrlComponents().HostNameAndPort;r=Ji(o,e.cloudDiscoveryMetadata?.metadata,Rn,t)||Ji(o,Vi.metadata,Nn,t)||e.knownAuthorities}return r||[]}(this.staticAuthorityOptions,this.commonLogger);if(r.includes(t)&&r.includes(e.environment))return!0}const r=this.getAuthorityMetadataByAlias(t);return!!(r&&r.aliases.indexOf(e.environment)>-1)}matchCredentialType(e,t){return e.credentialType&&t.toLowerCase()===e.credentialType.toLowerCase()}matchClientId(e,t){return!(!e.clientId||t!==e.clientId)}matchFamilyId(e,t){return!(!e.familyId||t!==e.familyId)}matchRealm(e,t){return!(e.realm?.toLowerCase()!==t.toLowerCase())}matchNativeAccountId(e,t){return!(!e.nativeAccountId||t!==e.nativeAccountId)}matchLoginHintFromTokenClaims(e,t){return e.login_hint===t||e.preferred_username===t||e.upn===t}matchSid(e,t){return e.sid===t}matchAuthorityType(e,t){return!(!e.authorityType||t.toLowerCase()!==e.authorityType.toLowerCase())}matchTarget(e,t){return!(e.credentialType!==Sn.ACCESS_TOKEN&&e.credentialType!==Sn.ACCESS_TOKEN_WITH_AUTH_SCHEME||!e.target)&&Fi.fromString(e.target).containsScopeSet(t)}matchTokenType(e,t){return!(!e.tokenType||e.tokenType!==t)}matchKeyId(e,t){return!(!e.keyId||e.keyId!==t)}isAppMetadata(e){return-1!==e.indexOf(En)}isAuthorityMetadata(e){return-1!==e.indexOf(Pn)}generateAuthorityMetadataCacheKey(e){return`${Pn}-${this.clientId}-${e}`}static toObject(e,t){for(const r in t)e[r]=t[r];return e}}class oa extends na{async setAccount(){throw Ho(Bo)}getAccount(){throw Ho(Bo)}async setIdTokenCredential(){throw Ho(Bo)}getIdTokenCredential(){throw Ho(Bo)}async setAccessTokenCredential(){throw Ho(Bo)}getAccessTokenCredential(){throw Ho(Bo)}async setRefreshTokenCredential(){throw Ho(Bo)}getRefreshTokenCredential(){throw Ho(Bo)}setAppMetadata(){throw Ho(Bo)}getAppMetadata(){throw Ho(Bo)}setServerTelemetry(){throw Ho(Bo)}getServerTelemetry(){throw Ho(Bo)}setAuthorityMetadata(){throw Ho(Bo)}getAuthorityMetadata(){throw Ho(Bo)}getAuthorityMetadataKeys(){throw Ho(Bo)}setThrottlingCache(){throw Ho(Bo)}getThrottlingCache(){throw Ho(Bo)}removeItem(){throw Ho(Bo)}getKeys(){throw Ho(Bo)}getAccountKeys(){throw Ho(Bo)}getTokenKeys(){throw Ho(Bo)}}const ia="acquireTokenByCode",aa="acquireTokenByRefreshToken",sa="acquireTokenSilent",ca="acquireTokenSilentAsync",la="acquireTokenPopup",ua="acquireTokenRedirect",da="cryptoOptsGetPublicKeyThumbprint",ha="cryptoOptsSignJwt",ga="silentCacheClientAcquireToken",pa="silentIframeClientAcquireToken",fa="silentRefreshClientAcquireToken",ma="ssoSilent",ya="standardInteractionClientGetDiscoveredAuthority",va="nativeInteractionClientAcquireToken",ba="networkClientSendPostRequestAsync",Ca="refreshTokenClientExecutePostToTokenEndpoint",wa="authorizationCodeClientExecutePostToTokenEndpoint",ka="refreshTokenClientExecuteTokenRequest",Ia="refreshTokenClientAcquireToken",Aa="refreshTokenClientAcquireTokenWithCachedRefreshToken",Ta="refreshTokenClientAcquireTokenByRefreshToken",Sa="refreshTokenClientCreateTokenRequestBody",Ea="acquireTokenFromCache",_a="silentFlowClientAcquireCachedToken",Pa="silentFlowClientGenerateResultFromCacheRecord",Ra="acquireTokenBySilentIframe",Oa="initializeBaseRequest",Ma="initializeSilentRequest",Na="initializeClientApplication",xa="initializeCache",Fa="silentIframeClientTokenHelper",Ba="silentHandlerInitiateAuthRequest",Da="silentHandlerMonitorIframeForHash",qa="silentHandlerLoadFrame",La="silentHandlerLoadFrameSync",Ha="standardInteractionClientCreateAuthCodeClient",Ua="standardInteractionClientGetClientConfiguration",ja="standardInteractionClientInitializeAuthorizationRequest",$a="getAuthCodeUrl",za="handleCodeResponseFromServer",Ka="handleCodeResponse",Wa="handleResponseEar",Ga="handleResponsePlatformBroker",Va="handleResponseCode",Qa="updateTokenEndpointAuthority",Ja="authClientAcquireToken",Ya="authClientExecuteTokenRequest",Xa="authClientCreateTokenRequestBody",Za="popTokenGenerateCnf",es="popTokenGenerateKid",ts="handleServerTokenResponse",rs="deserializeResponse",ns="authorityFactoryCreateDiscoveredInstance",os="authorityResolveEndpointsAsync",is="authorityGetCloudDiscoveryMetadataFromNetwork",as="authorityUpdateCloudDiscoveryMetadata",ss="authorityGetEndpointMetadataFromNetwork",cs="authorityUpdateEndpointMetadata",ls="authorityUpdateMetadataWithRegionalInformation",us="regionDiscoveryDetectRegion",ds="regionDiscoveryGetRegionFromIMDS",hs="regionDiscoveryGetCurrentVersion",gs="acquireTokenByCodeAsync",ps="handleRedirectPromise",fs="handleNativeRedirectPromise",ms="nativeMessageHandlerHandshake",ys="removeHiddenIframe",vs="clearTokensAndKeysWithClaims",bs="cacheManagerGetRefreshToken",Cs="importExistingCache",ws="setUserData",ks="localStorageUpdated",Is="generatePkceCodes",As="generateCodeVerifier",Ts="generateCodeChallengeFromVerifier",Ss="sha256Digest",Es="getRandomValues",_s="generateHKDF",Ps="generateBaseKey",Rs="base64Decode",Os="urlEncodeArr",Ms="encrypt",Ns="decrypt",xs="generateEarKey",Fs="decryptEarResponse",Bs=(new Map([[ia,"ATByCode"],[aa,"ATByRT"],[sa,"ATS"],[ca,"ATSAsync"],[la,"ATPopup"],[ua,"ATRedirect"],[da,"CryptoGetPKThumb"],[ha,"CryptoSignJwt"],[ga,"SltCacheClientAT"],[pa,"SltIframeClientAT"],[fa,"SltRClientAT"],[ma,"SsoSlt"],[ya,"StdIntClientGetDiscAuth"],["fetchAccountIdWithNativeBroker","FetchAccIdWithNtvBroker"],[va,"NtvIntClientAT"],["baseClientCreateTokenRequestHeaders","BaseClientCreateTReqHead"],[ba,"NetClientSendPost"],[Ca,"RTClientExecPost"],[wa,"AuthCodeClientExecPost"],["brokerHandshake","BrokerHandshake"],["acquireTokenByRefreshTokenInBroker","ATByRTInBroker"],["acquireTokenByBroker","ATByBroker"],[ka,"RTClientExecTReq"],[Ia,"RTClientAT"],[Aa,"RTClientATWithCachedRT"],[Ta,"RTClientATByRT"],[Sa,"RTClientCreateTReqBody"],[Ea,"ATFromCache"],[_a,"SltFlowClientATCached"],[Pa,"SltFlowClientGenResFromCache"],[Ra,"ATBySltIframe"],[Oa,"InitBaseReq"],[Ma,"InitSltReq"],[Na,"InitClientApplication"],[xa,"InitCache"],[Cs,"importCache"],[ws,"setUserData"],[ks,"localStorageUpdated"],[Fa,"SIClientTHelper"],[Ba,"SHandlerInitAuthReq"],[Da,"SltHandlerMonitorIframeForHash"],[qa,"SHandlerLoadFrame"],[La,"SHandlerLoadFrameSync"],[Ha,"StdIntClientCreateAuthCodeClient"],[Ua,"StdIntClientGetClientConf"],[ja,"StdIntClientInitAuthReq"],[$a,"GetAuthCodeUrl"],[za,"HandleCodeResFromServer"],[Ka,"HandleCodeResp"],[Wa,"HandleRespEar"],[Va,"HandleRespCode"],[Ga,"HandleRespPlatBroker"],[Qa,"UpdTEndpointAuth"],[Ja,"AuthClientAT"],[Ya,"AuthClientExecTReq"],[Xa,"AuthClientCreateTReqBody"],[Za,"PopTGenCnf"],[es,"PopTGenKid"],[ts,"HandleServerTRes"],[rs,"DeserializeRes"],[ns,"AuthFactCreateDiscInst"],[os,"AuthResolveEndpointsAsync"],["authorityResolveEndpointsFromLocalSources","AuthResolveEndpointsFromLocal"],[is,"AuthGetCDMetaFromNet"],[as,"AuthUpdCDMeta"],[ss,"AuthUpdCDMetaFromNet"],[cs,"AuthUpdEndpointMeta"],[ls,"AuthUpdMetaWithRegInfo"],[us,"RegDiscDetectReg"],[ds,"RegDiscGetRegFromIMDS"],[hs,"RegDiscGetCurrentVer"],[gs,"ATByCodeAsync"],["getEndpointMetadataFromNetwork","GetEndpointMetaFromNet"],["getCloudDiscoveryMetadataFromNetworkMeasurement","GetCDMetaFromNet"],[ps,"HandleRedirectPromise"],[fs,"HandleNtvRedirectPromise"],["updateCloudDiscoveryMetadataMeasurement","UpdateCDMeta"],["usernamePasswordClientAcquireToken","UserPassClientAT"],[ms,"NtvMsgHandlerHandshake"],["nativeGenerateAuthResult","NtvGenAuthRes"],[ys,"RemoveHiddenIframe"],[vs,"ClearTAndKeysWithClaims"],[bs,"CacheManagerGetRT"],[Is,"GenPkceCodes"],[As,"GenCodeVerifier"],[Ts,"GenCodeChallengeFromVerifier"],[Ss,"Sha256Digest"],[Es,"GetRandomValues"],[_s,"genHKDF"],[Ps,"genBaseKey"],[Rs,"b64Decode"],[Os,"urlEncArr"],[Ms,"encrypt"],[Ns,"decrypt"],[xs,"genEarKey"],[Fs,"decryptEarResp"]]),1);new Set(["accessTokenSize","durationMs","idTokenSize","matsSilentStatus","matsHttpStatus","refreshTokenSize","queuedTimeMs","startTimeMs","status","multiMatchedAT","multiMatchedID","multiMatchedRT","unencryptedCacheCount","encryptedCacheExpiredCount"]);class Ds{startMeasurement(){}endMeasurement(){}flushMeasurement(){return null}}class qs{generateId(){return"callback-id"}startMeasurement(e,t){return{end:()=>null,discard:()=>{},add:()=>{},increment:()=>{},event:{eventId:this.generateId(),status:Bs,authority:"",libraryName:"",libraryVersion:"",clientId:"",name:e,startTimeMs:Date.now(),correlationId:t||""},measurement:new Ds}}startPerformanceMeasurement(){return new Ds}calculateQueuedTime(){return 0}addQueueMeasurement(){}setPreQueueTime(){}endMeasurement(){return null}discardMeasurements(){}removePerformanceCallback(){return!0}addPerformanceCallback(){return""}emitEvents(){}addFields(){}incrementFields(){}cacheEventByCorrelationId(){}}const Ls={tokenRenewalOffsetSeconds:300,preventCorsPreflight:!1},Hs={loggerCallback:()=>{},piiLoggingEnabled:!1,logLevel:Dn.Info,correlationId:sn.EMPTY_STRING},Us={claimsBasedCachingEnabled:!1},js={async sendGetRequestAsync(){throw Ho(Bo)},async sendPostRequestAsync(){throw Ho(Bo)}},$s={sku:sn.SKU,version:$o,cpu:sn.EMPTY_STRING,os:sn.EMPTY_STRING},zs={clientSecret:sn.EMPTY_STRING,clientAssertion:void 0},Ks={azureCloudInstance:Un,tenant:`${sn.DEFAULT_COMMON_TENANT}`},Ws={application:{appName:"",appVersion:""}};function Gs(e){return e.authOptions.authority.options.protocolMode===Ln}var Vs=r(64583).Promise;const Qs={sendGetRequestAsync:()=>Vs.reject(Ho(Bo)),sendPostRequestAsync:()=>Vs.reject(Ho(Bo))},Js="invalid_grant",Ys="msal",Xs="msal.js.browser",Zs="53ee284d-920a-4b59-9d30-a60315b26836",ec="ppnbnpeolgkicgegkbkbjmhlideopiji",tc="MicrosoftEntra",rc="Handshake",nc="localStorage",oc="sessionStorage",ic="memoryStorage",ac="signin",sc="signout",cc="request.origin",lc="urlHash",uc="request.params",dc="code.verifier",hc="interaction.status",gc="request.native",pc="msal.account.keys",fc="msal.token.keys",mc="msal.version",yc="wrapper.sku",vc="wrapper.version",bc=861,Cc=862;var wc;!function(e){e.Redirect="redirect",e.Popup="popup",e.Silent="silent",e.None="none"}(wc||(wc={}));const kc={scopes:cn},Ic="msal.db",Ac=`${Ic}.keys`,Tc=[0,5,4],Sc="pkce_not_created",Ec="ear_jwk_empty",_c="ear_jwe_empty",Pc="crypto_nonexistent",Rc="empty_navigate_uri",Oc="hash_empty_error",Mc="no_state_in_hash",Nc="hash_does_not_contain_known_properties",xc="unable_to_parse_state",Fc="state_interaction_type_mismatch",Bc="interaction_in_progress",Dc="popup_window_error",qc="empty_window_error",Lc="user_cancelled",Hc="monitor_popup_timeout",Uc="monitor_window_timeout",jc="redirect_in_iframe",$c="block_iframe_reload",zc="block_nested_popups",Kc="iframe_closed_prematurely",Wc="silent_logout_unsupported",Gc="no_account_error",Vc="silent_prompt_value_error",Qc="no_token_request_cache_error",Jc="unable_to_parse_token_request_cache_error",Yc="auth_request_not_set_error",Xc="invalid_cache_type",Zc="non_browser_environment",el="database_not_open",tl="no_network_connectivity",rl="post_request_failed",nl="get_request_failed",ol="failed_to_parse_response",il="unable_to_load_token",al="crypto_key_not_found",sl="auth_code_required",cl="auth_code_or_nativeAccountId_required",ll="spa_code_and_nativeAccountId_present",ul="database_unavailable",dl="unable_to_acquire_token_from_native_platform",hl="native_handshake_timeout",gl="native_extension_not_installed",pl="native_connection_not_established",fl="uninitialized_public_client_application",ml="native_prompt_not_supported",yl="invalid_base64_string",vl="invalid_pop_token_request",bl="failed_to_build_headers",Cl="failed_to_parse_headers",wl="failed_to_decrypt_ear_response",kl="timed_out",Il="For more visit: aka.ms/msaljs/browser-errors",Al={[Sc]:"The PKCE code challenge and verifier could not be generated.",[Ec]:"No EAR encryption key provided. This is unexpected.",[_c]:"Server response does not contain ear_jwe property. This is unexpected.",[Pc]:"The crypto object or function is not available.",[Rc]:"Navigation URI is empty. Please check stack trace for more info.",[Oc]:`Hash value cannot be processed because it is empty. Please verify that your redirectUri is not clearing the hash. ${Il}`,[Mc]:"Hash does not contain state. Please verify that the request originated from msal.",[Nc]:`Hash does not contain known properites. Please verify that your redirectUri is not changing the hash.  ${Il}`,[xc]:"Unable to parse state. Please verify that the request originated from msal.",[Fc]:"Hash contains state but the interaction type does not match the caller.",[Bc]:`Interaction is currently in progress. Please ensure that this interaction has been completed before calling an interactive API.   ${Il}`,[Dc]:"Error opening popup window. This can happen if you are using IE or if popups are blocked in the browser.",[qc]:"window.open returned null or undefined window object.",[Lc]:"User cancelled the flow.",[Hc]:`Token acquisition in popup failed due to timeout.  ${Il}`,[Uc]:`Token acquisition in iframe failed due to timeout.  ${Il}`,[jc]:"Redirects are not supported for iframed or brokered applications. Please ensure you are using MSAL.js in a top frame of the window if using the redirect APIs, or use the popup APIs.",[$c]:`Request was blocked inside an iframe because MSAL detected an authentication response.  ${Il}`,[zc]:"Request was blocked inside a popup because MSAL detected it was running in a popup.",[Kc]:"The iframe being monitored was closed prematurely.",[Wc]:"Silent logout not supported. Please call logoutRedirect or logoutPopup instead.",[Gc]:"No account object provided to acquireTokenSilent and no active account has been set. Please call setActiveAccount or provide an account on the request.",[Vc]:"The value given for the prompt value is not valid for silent requests - must be set to 'none' or 'no_session'.",[Qc]:"No token request found in cache.",[Jc]:"The cached token request could not be parsed.",[Yc]:"Auth Request not set. Please ensure initiateAuthRequest was called from the InteractionHandler",[Xc]:"Invalid cache type",[Zc]:"Login and token requests are not supported in non-browser environments.",[el]:"Database is not open!",[tl]:"No network connectivity. Check your internet connection.",[rl]:"Network request failed: If the browser threw a CORS error, check that the redirectUri is registered in the Azure App Portal as type 'SPA'",[nl]:"Network request failed. Please check the network trace to determine root cause.",[ol]:"Failed to parse network response. Check network trace.",[il]:"Error loading token to cache.",[al]:"Cryptographic Key or Keypair not found in browser storage.",[sl]:"An authorization code must be provided (as the `code` property on the request) to this flow.",[cl]:"An authorization code or nativeAccountId must be provided to this flow.",[ll]:"Request cannot contain both spa code and native account id.",[ul]:"IndexedDB, which is required for persistent cryptographic key storage, is unavailable. This may be caused by browser privacy features which block persistent storage in third-party contexts.",[dl]:`Unable to acquire token from native platform.  ${Il}`,[hl]:"Timed out while attempting to establish connection to browser extension",[gl]:"Native extension is not installed. If you think this is a mistake call the initialize function.",[pl]:`Connection to native platform has not been established. Please install a compatible browser extension and run initialize().  ${Il}`,[fl]:`You must call and await the initialize function before attempting to call any other MSAL API.  ${Il}`,[ml]:"The provided prompt is not supported by the native platform. This request should be routed to the web based flow.",[yl]:"Invalid base64 encoded string.",[vl]:"Invalid PoP token request. The request should not have both a popKid value and signPopToken set to true.",[bl]:"Failed to build request headers object.",[Cl]:"Failed to parse response headers",[wl]:"Failed to decrypt ear response",[kl]:"The request timed out."};class Tl extends Kn{constructor(e,t){super(e,Al[e],t),Object.setPrototypeOf(this,Tl.prototype),this.name="BrowserAuthError"}}function Sl(e,t){return new Tl(e,t)}var El=r(64583).Promise;class _l{navigateInternal(e,t){return _l.defaultNavigateWindow(e,t)}navigateExternal(e,t){return _l.defaultNavigateWindow(e,t)}static defaultNavigateWindow(e,t){return t.noHistory?window.location.replace(e):window.location.assign(e),new El((e,r)=>{setTimeout(()=>{r(Sl(kl,"failed_to_redirect"))},t.timeout)})}}class Pl extends Kn{constructor(e,t,r){super(e.errorCode,e.errorMessage,e.subError),Object.setPrototypeOf(this,Pl.prototype),this.name="NetworkError",this.error=e,this.httpStatus=t,this.responseHeaders=r}}function Rl(e,t,r,n){return e.errorMessage=`${e.errorMessage}, additionalErrorInfo: error.name:${n?.name}, error.message:${n?.message}`,new Pl(e,t,r)}class Ol{async sendGetRequestAsync(e,t){let r,n={},o=0;const i=Ml(t);try{r=await fetch(e,{method:"GET",headers:i})}catch(e){throw Rl(Sl(window.navigator.onLine?nl:tl),void 0,void 0,e)}n=Nl(r.headers);try{return o=r.status,{headers:n,body:await r.json(),status:o}}catch(e){throw Rl(Sl(ol),o,n,e)}}async sendPostRequestAsync(e,t){const r=t&&t.body||"",n=Ml(t);let o,i=0,a={};try{o=await fetch(e,{method:"POST",headers:n,body:r})}catch(e){throw Rl(Sl(window.navigator.onLine?rl:tl),void 0,void 0,e)}a=Nl(o.headers);try{return i=o.status,{headers:a,body:await o.json(),status:i}}catch(e){throw Rl(Sl(ol),i,a,e)}}}function Ml(e){try{const t=new Headers;if(!e||!e.headers)return t;const r=e.headers;return Object.entries(r).forEach(([e,r])=>{t.append(e,r)}),t}catch(e){throw Rl(Sl(bl),void 0,void 0,e)}}function Nl(e){try{const t={};return e.forEach((e,r)=>{t[r]=e}),t}catch(e){throw Sl(Cl)}}function xl(e){return encodeURIComponent(Bl(e).replace(/=/g,"").replace(/\+/g,"-").replace(/\//g,"_"))}function Fl(e){return Dl(e).replace(/=/g,"").replace(/\+/g,"-").replace(/\//g,"_")}function Bl(e){return Dl((new TextEncoder).encode(e))}function Dl(e){const t=Array.from(e,e=>String.fromCodePoint(e)).join("");return btoa(t)}function ql(e){return(new TextDecoder).decode(Ll(e))}function Ll(e){let t=e.replace(/-/g,"+").replace(/_/g,"/");switch(t.length%4){case 0:break;case 2:t+="==";break;case 3:t+="=";break;default:throw Sl(yl)}const r=atob(t);return Uint8Array.from(r,e=>e.codePointAt(0)||0)}const Hl="AES-GCM",Ul="HKDF",jl="SHA-256",$l=new Uint8Array([1,0,1]),zl="0123456789abcdef",Kl=new Uint32Array(1),Wl="raw",Gl="encrypt",Vl="decrypt",Ql={name:"RSASSA-PKCS1-v1_5",hash:jl,modulusLength:2048,publicExponent:$l};async function Jl(e,t,r){t?.addQueueMeasurement(Ss,r);const n=(new TextEncoder).encode(e);return window.crypto.subtle.digest(jl,n)}function Yl(e){return window.crypto.getRandomValues(e)}function Xl(){return window.crypto.getRandomValues(Kl),Kl[0]}function Zl(){const e=Date.now(),t=1024*Xl()+(1023&Xl()),r=new Uint8Array(16),n=Math.trunc(t/2**30),o=t&2**30-1,i=Xl();r[0]=e/2**40,r[1]=e/2**32,r[2]=e/2**24,r[3]=e/65536,r[4]=e/256,r[5]=e,r[6]=112|n>>>8,r[7]=n,r[8]=128|o>>>24,r[9]=o>>>16,r[10]=o>>>8,r[11]=o,r[12]=i>>>24,r[13]=i>>>16,r[14]=i>>>8,r[15]=i;let a="";for(let e=0;e<r.length;e++)a+=zl.charAt(r[e]>>>4),a+=zl.charAt(15&r[e]),3!==e&&5!==e&&7!==e&&9!==e||(a+="-");return a}async function eu(e){return window.crypto.subtle.exportKey("jwk",e)}async function tu(){const e=await nu(),t={alg:"dir",kty:"oct",k:Fl(new Uint8Array(e))};return Bl(JSON.stringify(t))}async function ru(e,t){const r=t.split(".");if(5!==r.length)throw Sl(wl,"jwe_length");const n=await async function(e){const t=ql(e),r=Ll(JSON.parse(t).k);return window.crypto.subtle.importKey(Wl,r,Hl,!1,[Vl])}(e).catch(()=>{throw Sl(wl,"import_key")});try{const e=(new TextEncoder).encode(r[0]),t=Ll(r[2]),o=Ll(r[3]),i=Ll(r[4]),a=8*i.byteLength,s=new Uint8Array(o.length+i.length);s.set(o),s.set(i,o.length);const c=await window.crypto.subtle.decrypt({name:Hl,iv:t,tagLength:a,additionalData:e},n,s);return(new TextDecoder).decode(c)}catch(e){throw Sl(wl,"decrypt")}}async function nu(){const e=await window.crypto.subtle.generateKey({name:Hl,length:256},!0,[Gl,Vl]);return window.crypto.subtle.exportKey(Wl,e)}async function ou(e){return window.crypto.subtle.importKey(Wl,e,Ul,!1,["deriveKey"])}async function iu(e,t,r){return window.crypto.subtle.deriveKey({name:Ul,salt:t,hash:jl,info:(new TextEncoder).encode(r)},e,{name:Hl,length:256},!1,[Gl,Vl])}async function au(e,t,r){const n=(new TextEncoder).encode(t),o=window.crypto.getRandomValues(new Uint8Array(16)),i=await iu(e,o,r),a=await window.crypto.subtle.encrypt({name:Hl,iv:new Uint8Array(12)},i,n);return{data:Fl(new Uint8Array(a)),nonce:Fl(o)}}async function su(e,t,r,n){const o=Ll(n),i=await iu(e,Ll(t),r),a=await window.crypto.subtle.decrypt({name:Hl,iv:new Uint8Array(12)},i,o);return(new TextDecoder).decode(a)}async function cu(e){const t=await Jl(e);return Fl(new Uint8Array(t))}const lu="storage_not_supported",uu="stubbed_public_client_application_called",du="in_mem_redirect_unavailable",hu={[lu]:"Given storage configuration option was not supported.",[uu]:"Stub instance of Public Client Application was called. If using msal-react, please ensure context is not used without a provider. For more visit: aka.ms/msaljs/browser-errors",[du]:"Redirect cannot be supported. In-memory storage was selected and storeAuthStateInCookie=false, which would cause the library to be unable to handle the incoming hash. If you would like to use the redirect API, please use session/localStorage or set storeAuthStateInCookie=true."};class gu extends Kn{constructor(e,t){super(e,t),this.name="BrowserConfigurationAuthError",Object.setPrototypeOf(this,gu.prototype)}}function pu(e){return new gu(e,hu[e])}function fu(e){e.location.hash="","function"==typeof e.history.replaceState&&e.history.replaceState(null,"",`${e.location.origin}${e.location.pathname}${e.location.search}`)}function mu(){return window.parent!==window}function yu(){return"undefined"!=typeof window&&window.location?window.location.href.split("?")[0].split("#")[0]:""}function vu(){if("undefined"==typeof window)throw Sl(Zc)}function bu(e){if(!e)throw Sl(fl)}function Cu(e){vu(),function(){if(Wi.hashContainsKnownProperties(window.location.hash)&&mu())throw Sl($c)}(),function(){if("undefined"!=typeof window&&window.opener&&window.opener!==window&&"string"==typeof window.name&&0===window.name.indexOf(`${Ys}.`))throw Sl(zc)}(),bu(e)}function wu(e,t){if(Cu(e),function(e){if(mu()&&!e)throw Sl(jc)}(t.system.allowRedirectInIframe),t.cache.cacheLocation===ic&&!t.cache.storeAuthStateInCookie)throw pu(du)}function ku(e){const t=document.createElement("link");t.rel="preconnect",t.href=new URL(e).origin,t.crossOrigin="anonymous",document.head.appendChild(t),window.setTimeout(()=>{try{document.head.removeChild(t)}catch{}},1e4)}const Iu="4.15.0";class Au{static loggerCallback(e,t){switch(e){case Dn.Error:return void console.error(t);case Dn.Info:return void console.info(t);case Dn.Verbose:return void console.debug(t);case Dn.Warning:return void console.warn(t);default:return void console.log(t)}}constructor(e){let t;this.browserEnvironment="undefined"!=typeof window,this.config=function({auth:e,cache:t,system:r,telemetry:n},o){const i={clientId:sn.EMPTY_STRING,authority:`${sn.DEFAULT_AUTHORITY}`,knownAuthorities:[],cloudDiscoveryMetadata:sn.EMPTY_STRING,authorityMetadata:sn.EMPTY_STRING,redirectUri:"undefined"!=typeof window?yu():"",postLogoutRedirectUri:sn.EMPTY_STRING,navigateToLoginRequestUrl:!0,clientCapabilities:[],protocolMode:"AAD",OIDCOptions:{serverResponseType:"fragment",defaultScopes:[sn.OPENID_SCOPE,sn.PROFILE_SCOPE,sn.OFFLINE_ACCESS_SCOPE]},azureCloudOptions:{azureCloudInstance:Un,tenant:sn.EMPTY_STRING},skipAuthorityMetadataCache:!1,supportsNestedAppAuth:!1,instanceAware:!1,encodeExtraQueryParams:!1},a={cacheLocation:oc,temporaryCacheLocation:oc,storeAuthStateInCookie:!1,secureCookies:!1,cacheMigrationEnabled:!(!t||t.cacheLocation!==nc),claimsBasedCachingEnabled:!1},s={loggerCallback:()=>{},logLevel:Dn.Info,piiLoggingEnabled:!1},c={...{...Ls,loggerOptions:s,networkClient:o?new Ol:Qs,navigationClient:new _l,loadFrameTimeout:0,windowHashTimeout:r?.loadFrameTimeout||6e4,iframeHashTimeout:r?.loadFrameTimeout||1e4,navigateFrameWait:0,redirectNavigationTimeout:3e4,asyncPopups:!1,allowRedirectInIframe:!1,allowPlatformBroker:!1,nativeBrokerHandshakeTimeout:r?.nativeBrokerHandshakeTimeout||2e3,pollIntervalMilliseconds:30},...r,loggerOptions:r?.loggerOptions||s},l={application:{appName:sn.EMPTY_STRING,appVersion:sn.EMPTY_STRING},client:new qs};if(e?.protocolMode!==Ln&&e?.OIDCOptions&&new qn(c.loggerOptions).warning(JSON.stringify(Ni(_i))),e?.protocolMode&&e.protocolMode===Ln&&c?.allowPlatformBroker)throw Ni(Pi);return{auth:{...i,...e,OIDCOptions:{...i.OIDCOptions,...e?.OIDCOptions}},cache:{...a,...t},system:c,telemetry:{...l,...n}}}(e,this.browserEnvironment);try{t=window[oc]}catch(e){}const r=t?.getItem("msal.browser.log.level"),n=t?.getItem("msal.browser.log.pii")?.toLowerCase(),o="true"===n||"false"!==n&&void 0,i={...this.config.system.loggerOptions},a=r&&Object.keys(Dn).includes(r)?Dn[r]:void 0;a&&(i.loggerCallback=Au.loggerCallback,i.logLevel=a),void 0!==o&&(i.piiLoggingEnabled=o),this.logger=new qn(i,"@azure/msal-browser",Iu),this.available=!1}getConfig(){return this.config}getLogger(){return this.logger}isAvailable(){return this.available}isBrowserEnvironment(){return this.browserEnvironment}}class Tu extends Au{getModuleName(){return Tu.MODULE_NAME}getId(){return Tu.ID}async initialize(){return this.available="undefined"!=typeof window,this.available}}Tu.MODULE_NAME="",Tu.ID="StandardOperatingContext";const Su="missing_kid_error",Eu="missing_alg_error",_u={[Su]:"The JOSE Header for the requested JWT, JWS or JWK object requires a keyId to be configured as the 'kid' header claim. No 'kid' value was provided.",[Eu]:"The JOSE Header for the requested JWT, JWS or JWK object requires an algorithm to be specified as the 'alg' header claim. No 'alg' value was provided."};class Pu extends Kn{constructor(e,t){super(e,t),this.name="JoseHeaderError",Object.setPrototypeOf(this,Pu.prototype)}}function Ru(e){return new Pu(e,_u[e])}class Ou{constructor(e){this.typ=e.typ,this.alg=e.alg,this.kid=e.kid}static getShrHeaderString(e){if(!e.kid)throw Ru(Su);if(!e.alg)throw Ru(Eu);const t=new Ou({typ:e.typ||"pop",kid:e.kid,alg:e.alg});return JSON.stringify(t)}}var Mu=r(64583).Promise;class Nu{constructor(){this.dbName=Ic,this.version=1,this.tableName=Ac,this.dbOpen=!1}async open(){return new Mu((e,t)=>{const r=window.indexedDB.open(this.dbName,this.version);r.addEventListener("upgradeneeded",e=>{e.target.result.createObjectStore(this.tableName)}),r.addEventListener("success",t=>{const r=t;this.db=r.target.result,this.dbOpen=!0,e()}),r.addEventListener("error",()=>t(Sl(ul)))})}closeConnection(){const e=this.db;e&&this.dbOpen&&(e.close(),this.dbOpen=!1)}async validateDbIsOpen(){if(!this.dbOpen)return this.open()}async getItem(e){return await this.validateDbIsOpen(),new Mu((t,r)=>{if(!this.db)return r(Sl(el));const n=this.db.transaction([this.tableName],"readonly").objectStore(this.tableName).get(e);n.addEventListener("success",e=>{const r=e;this.closeConnection(),t(r.target.result)}),n.addEventListener("error",e=>{this.closeConnection(),r(e)})})}async setItem(e,t){return await this.validateDbIsOpen(),new Mu((r,n)=>{if(!this.db)return n(Sl(el));const o=this.db.transaction([this.tableName],"readwrite").objectStore(this.tableName).put(t,e);o.addEventListener("success",()=>{this.closeConnection(),r()}),o.addEventListener("error",e=>{this.closeConnection(),n(e)})})}async removeItem(e){return await this.validateDbIsOpen(),new Mu((t,r)=>{if(!this.db)return r(Sl(el));const n=this.db.transaction([this.tableName],"readwrite").objectStore(this.tableName).delete(e);n.addEventListener("success",()=>{this.closeConnection(),t()}),n.addEventListener("error",e=>{this.closeConnection(),r(e)})})}async getKeys(){return await this.validateDbIsOpen(),new Mu((e,t)=>{if(!this.db)return t(Sl(el));const r=this.db.transaction([this.tableName],"readonly").objectStore(this.tableName).getAllKeys();r.addEventListener("success",t=>{const r=t;this.closeConnection(),e(r.target.result)}),r.addEventListener("error",e=>{this.closeConnection(),t(e)})})}async containsKey(e){return await this.validateDbIsOpen(),new Mu((t,r)=>{if(!this.db)return r(Sl(el));const n=this.db.transaction([this.tableName],"readonly").objectStore(this.tableName).count(e);n.addEventListener("success",e=>{const r=e;this.closeConnection(),t(1===r.target.result)}),n.addEventListener("error",e=>{this.closeConnection(),r(e)})})}async deleteDatabase(){return this.db&&this.dbOpen&&this.closeConnection(),new Mu((e,t)=>{const r=window.indexedDB.deleteDatabase(Ic),n=setTimeout(()=>t(!1),200);r.addEventListener("success",()=>(clearTimeout(n),e(!0))),r.addEventListener("blocked",()=>(clearTimeout(n),e(!0))),r.addEventListener("error",()=>(clearTimeout(n),t(!1)))})}}class xu{constructor(){this.cache=new Map}async initialize(){}getItem(e){return this.cache.get(e)||null}getUserData(e){return this.getItem(e)}setItem(e,t){this.cache.set(e,t)}async setUserData(e,t){this.setItem(e,t)}removeItem(e){this.cache.delete(e)}getKeys(){const e=[];return this.cache.forEach((t,r)=>{e.push(r)}),e}containsKey(e){return this.cache.has(e)}clear(){this.cache.clear()}}class Fu{constructor(e){this.inMemoryCache=new xu,this.indexedDBCache=new Nu,this.logger=e}handleDatabaseAccessError(e){if(!(e instanceof Tl&&e.errorCode===ul))throw e;this.logger.error("Could not access persistent storage. This may be caused by browser privacy features which block persistent storage in third-party contexts.")}async getItem(e){const t=this.inMemoryCache.getItem(e);if(!t)try{return this.logger.verbose("Queried item not found in in-memory cache, now querying persistent storage."),await this.indexedDBCache.getItem(e)}catch(e){this.handleDatabaseAccessError(e)}return t}async setItem(e,t){this.inMemoryCache.setItem(e,t);try{await this.indexedDBCache.setItem(e,t)}catch(e){this.handleDatabaseAccessError(e)}}async removeItem(e){this.inMemoryCache.removeItem(e);try{await this.indexedDBCache.removeItem(e)}catch(e){this.handleDatabaseAccessError(e)}}async getKeys(){const e=this.inMemoryCache.getKeys();if(0===e.length)try{return this.logger.verbose("In-memory cache is empty, now querying persistent storage."),await this.indexedDBCache.getKeys()}catch(e){this.handleDatabaseAccessError(e)}return e}async containsKey(e){const t=this.inMemoryCache.containsKey(e);if(!t)try{return this.logger.verbose("Key not found in in-memory cache, now querying persistent storage."),await this.indexedDBCache.containsKey(e)}catch(e){this.handleDatabaseAccessError(e)}return t}clearInMemory(){this.logger.verbose("Deleting in-memory keystore"),this.inMemoryCache.clear(),this.logger.verbose("In-memory keystore deleted")}async clearPersistent(){try{this.logger.verbose("Deleting persistent keystore");const e=await this.indexedDBCache.deleteDatabase();return e&&this.logger.verbose("Persistent keystore deleted"),e}catch(e){return this.handleDatabaseAccessError(e),!1}}}class Bu{constructor(e,t,r){this.logger=e,function(e){if(!window)throw Sl(Zc);if(!window.crypto)throw Sl(Pc);if(!e&&!window.crypto.subtle)throw Sl(Pc,"crypto_subtle_undefined")}(r??!1),this.cache=new Fu(this.logger),this.performanceClient=t}createNewGuid(){return Zl()}base64Encode(e){return Bl(e)}base64Decode(e){return ql(e)}base64UrlEncode(e){return xl(e)}encodeKid(e){return this.base64UrlEncode(JSON.stringify({kid:e}))}async getPublicKeyThumbprint(e){const t=this.performanceClient?.startMeasurement(da,e.correlationId),r=await async function(e,t){return window.crypto.subtle.generateKey(Ql,e,t)}(Bu.EXTRACTABLE,Bu.POP_KEY_USAGES),n=await eu(r.publicKey),o=Du({e:n.e,kty:n.kty,n:n.n}),i=await this.hashString(o),a=await eu(r.privateKey),s=await async function(e){return window.crypto.subtle.importKey("jwk",e,Ql,!1,["sign"])}(a);return await this.cache.setItem(i,{privateKey:s,publicKey:r.publicKey,requestMethod:e.resourceRequestMethod,requestUri:e.resourceRequestUri}),t&&t.end({success:!0}),i}async removeTokenBindingKey(e){if(await this.cache.removeItem(e),await this.cache.containsKey(e))throw Ho(Ro)}async clearKeystore(){this.cache.clearInMemory();try{return await this.cache.clearPersistent(),!0}catch(e){return e instanceof Error?this.logger.error(`Clearing keystore failed with error: ${e.message}`):this.logger.error("Clearing keystore failed with unknown error"),!1}}async signJwt(e,t,r,n){const o=this.performanceClient?.startMeasurement(ha,n),i=await this.cache.getItem(t);if(!i)throw Sl(al);const a=await eu(i.publicKey),s=Du(a),c=xl(JSON.stringify({kid:t})),l=xl(Ou.getShrHeaderString({...r?.header,alg:a.alg,kid:c}));e.cnf={jwk:JSON.parse(s)};const u=`${l}.${xl(JSON.stringify(e))}`,d=(new TextEncoder).encode(u),h=await async function(e,t){return window.crypto.subtle.sign(Ql,e,t)}(i.privateKey,d),g=`${u}.${Fl(new Uint8Array(h))}`;return o&&o.end({success:!0}),g}async hashString(e){return cu(e)}}function Du(e){return JSON.stringify(e,Object.keys(e).sort())}Bu.POP_KEY_USAGES=["sign","verify"],Bu.EXTRACTABLE=!0;const qu=(e,t,r,n,o)=>(...i)=>{r.trace(`Executing function ${t}`);const a=n?.startMeasurement(t,o);if(o){const e=t+"CallCount";n?.incrementFields({[e]:1},o)}try{const n=e(...i);return a?.end({success:!0}),r.trace(`Returning result from ${t}`),n}catch(e){r.trace(`Error occurred in ${t}`);try{r.trace(JSON.stringify(e))}catch(e){r.trace("Unable to print error message.")}throw a?.end({success:!1},e),e}},Lu=(e,t,r,n,o)=>(...i)=>{r.trace(`Executing function ${t}`);const a=n?.startMeasurement(t,o);if(o){const e=t+"CallCount";n?.incrementFields({[e]:1},o)}return n?.setPreQueueTime(t,o),e(...i).then(e=>(r.trace(`Returning result from ${t}`),a?.end({success:!0}),e)).catch(e=>{r.trace(`Error occurred in ${t}`);try{r.trace(JSON.stringify(e))}catch(e){r.trace("Unable to print error message.")}throw a?.end({success:!1},e),e})};class Hu{constructor(e,t,r,n){this.networkInterface=e,this.logger=t,this.performanceClient=r,this.correlationId=n}async detectRegion(e,t){this.performanceClient?.addQueueMeasurement(us,this.correlationId);let r=e;if(r)t.region_source="3";else{const e=Hu.IMDS_OPTIONS;try{const n=await Lu(this.getRegionFromIMDS.bind(this),ds,this.logger,this.performanceClient,this.correlationId)(sn.IMDS_VERSION,e);if(200===n.status&&(r=n.body,t.region_source="4"),400===n.status){const n=await Lu(this.getCurrentVersion.bind(this),hs,this.logger,this.performanceClient,this.correlationId)(e);if(!n)return t.region_source="1",null;const o=await Lu(this.getRegionFromIMDS.bind(this),ds,this.logger,this.performanceClient,this.correlationId)(n,e);200===o.status&&(r=o.body,t.region_source="4")}}catch(e){return t.region_source="1",null}}return r||(t.region_source="1"),r||null}async getRegionFromIMDS(e,t){return this.performanceClient?.addQueueMeasurement(ds,this.correlationId),this.networkInterface.sendGetRequestAsync(`${sn.IMDS_ENDPOINT}?api-version=${e}&format=text`,t,sn.IMDS_TIMEOUT)}async getCurrentVersion(e){this.performanceClient?.addQueueMeasurement(hs,this.correlationId);try{const t=await this.networkInterface.sendGetRequestAsync(`${sn.IMDS_ENDPOINT}?format=json`,e);return 400===t.status&&t.body&&t.body["newest-versions"]&&t.body["newest-versions"].length>0?t.body["newest-versions"][0]:null}catch(e){return null}}}Hu.IMDS_OPTIONS={headers:{Metadata:"true"}};class Uu{constructor(e,t,r,n,o,i,a,s){this.canonicalAuthority=e,this._canonicalAuthority.validateAsUri(),this.networkInterface=t,this.cacheManager=r,this.authorityOptions=n,this.regionDiscoveryMetadata={region_used:void 0,region_source:void 0,region_outcome:void 0},this.logger=o,this.performanceClient=a,this.correlationId=i,this.managedIdentity=s||!1,this.regionDiscovery=new Hu(t,this.logger,this.performanceClient,this.correlationId)}getAuthorityType(e){if(e.HostNameAndPort.endsWith(sn.CIAM_AUTH_URL))return 3;const t=e.PathSegments;if(t.length)switch(t[0].toLowerCase()){case sn.ADFS:return 1;case sn.DSTS:return 2}return 0}get authorityType(){return this.getAuthorityType(this.canonicalAuthorityUrlComponents)}get protocolMode(){return this.authorityOptions.protocolMode}get options(){return this.authorityOptions}get canonicalAuthority(){return this._canonicalAuthority.urlString}set canonicalAuthority(e){this._canonicalAuthority=new Wi(e),this._canonicalAuthority.validateAsUri(),this._canonicalAuthorityUrlComponents=null}get canonicalAuthorityUrlComponents(){return this._canonicalAuthorityUrlComponents||(this._canonicalAuthorityUrlComponents=this._canonicalAuthority.getUrlComponents()),this._canonicalAuthorityUrlComponents}get hostnameAndPort(){return this.canonicalAuthorityUrlComponents.HostNameAndPort.toLowerCase()}get tenant(){return this.canonicalAuthorityUrlComponents.PathSegments[0]}get authorizationEndpoint(){if(this.discoveryComplete())return this.replacePath(this.metadata.authorization_endpoint);throw Ho(Yn)}get tokenEndpoint(){if(this.discoveryComplete())return this.replacePath(this.metadata.token_endpoint);throw Ho(Yn)}get deviceCodeEndpoint(){if(this.discoveryComplete())return this.replacePath(this.metadata.token_endpoint.replace("/token","/devicecode"));throw Ho(Yn)}get endSessionEndpoint(){if(this.discoveryComplete()){if(!this.metadata.end_session_endpoint)throw Ho(Oo);return this.replacePath(this.metadata.end_session_endpoint)}throw Ho(Yn)}get selfSignedJwtAudience(){if(this.discoveryComplete())return this.replacePath(this.metadata.issuer);throw Ho(Yn)}get jwksUri(){if(this.discoveryComplete())return this.replacePath(this.metadata.jwks_uri);throw Ho(Yn)}canReplaceTenant(e){return 1===e.PathSegments.length&&!Uu.reservedTenantDomains.has(e.PathSegments[0])&&0===this.getAuthorityType(e)&&this.protocolMode!==Ln}replaceTenant(e){return e.replace(/{tenant}|{tenantid}/g,this.tenant)}replacePath(e){let t=e;const r=new Wi(this.metadata.canonical_authority).getUrlComponents(),n=r.PathSegments;return this.canonicalAuthorityUrlComponents.PathSegments.forEach((e,o)=>{let i=n[o];if(0===o&&this.canReplaceTenant(r)){const e=new Wi(this.metadata.authorization_endpoint).getUrlComponents().PathSegments[0];i!==e&&(this.logger.verbose(`Replacing tenant domain name ${i} with id ${e}`),i=e)}e!==i&&(t=t.replace(`/${i}/`,`/${e}/`))}),this.replaceTenant(t)}get defaultOpenIdConfigurationEndpoint(){const e=this.hostnameAndPort;return this.canonicalAuthority.endsWith("v2.0/")||1===this.authorityType||this.protocolMode===Ln&&!this.isAliasOfKnownMicrosoftAuthority(e)?`${this.canonicalAuthority}.well-known/openid-configuration`:`${this.canonicalAuthority}v2.0/.well-known/openid-configuration`}discoveryComplete(){return!!this.metadata}async resolveEndpointsAsync(){this.performanceClient?.addQueueMeasurement(os,this.correlationId);const e=this.getCurrentMetadataEntity(),t=await Lu(this.updateCloudDiscoveryMetadata.bind(this),as,this.logger,this.performanceClient,this.correlationId)(e);this.canonicalAuthority=this.canonicalAuthority.replace(this.hostnameAndPort,e.preferred_network);const r=await Lu(this.updateEndpointMetadata.bind(this),cs,this.logger,this.performanceClient,this.correlationId)(e);this.updateCachedMetadata(e,t,{source:r}),this.performanceClient?.addFields({cloudDiscoverySource:t,authorityEndpointSource:r},this.correlationId)}getCurrentMetadataEntity(){let e=this.cacheManager.getAuthorityMetadataByAlias(this.hostnameAndPort);return e||(e={aliases:[],preferred_cache:this.hostnameAndPort,preferred_network:this.hostnameAndPort,canonical_authority:this.canonicalAuthority,authorization_endpoint:"",token_endpoint:"",end_session_endpoint:"",issuer:"",aliasesFromNetwork:!1,endpointsFromNetwork:!1,expiresAt:ai(),jwks_uri:""}),e}updateCachedMetadata(e,t,r){t!==On&&r?.source!==On&&(e.expiresAt=ai(),e.canonical_authority=this.canonicalAuthority);const n=this.cacheManager.generateAuthorityMetadataCacheKey(e.preferred_cache);this.cacheManager.setAuthorityMetadata(n,e),this.metadata=e}async updateEndpointMetadata(e){this.performanceClient?.addQueueMeasurement(cs,this.correlationId);const t=this.updateEndpointMetadataFromLocalSources(e);if(t)return t.source===Nn&&this.authorityOptions.azureRegionConfiguration?.azureRegion&&t.metadata&&(si(e,await Lu(this.updateMetadataWithRegionalInformation.bind(this),ls,this.logger,this.performanceClient,this.correlationId)(t.metadata),!1),e.canonical_authority=this.canonicalAuthority),t.source;let r=await Lu(this.getEndpointMetadataFromNetwork.bind(this),ss,this.logger,this.performanceClient,this.correlationId)();if(r)return this.authorityOptions.azureRegionConfiguration?.azureRegion&&(r=await Lu(this.updateMetadataWithRegionalInformation.bind(this),ls,this.logger,this.performanceClient,this.correlationId)(r)),si(e,r,!0),Mn;throw Ho(Zn,this.defaultOpenIdConfigurationEndpoint)}updateEndpointMetadataFromLocalSources(e){this.logger.verbose("Attempting to get endpoint metadata from authority configuration");const t=this.getEndpointMetadataFromConfig();if(t)return this.logger.verbose("Found endpoint metadata in authority configuration"),si(e,t,!1),{source:Rn};if(this.logger.verbose("Did not find endpoint metadata in the config... Attempting to get endpoint metadata from the hardcoded values."),this.authorityOptions.skipAuthorityMetadataCache)this.logger.verbose("Skipping hardcoded metadata cache since skipAuthorityMetadataCache is set to true. Attempting to get endpoint metadata from the network metadata cache.");else{const t=this.getEndpointMetadataFromHardcodedValues();if(t)return si(e,t,!1),{source:Nn,metadata:t};this.logger.verbose("Did not find endpoint metadata in hardcoded values... Attempting to get endpoint metadata from the network metadata cache.")}const r=li(e);return this.isAuthoritySameType(e)&&e.endpointsFromNetwork&&!r?(this.logger.verbose("Found endpoint metadata in the cache."),{source:On}):(r&&this.logger.verbose("The metadata entity is expired."),null)}isAuthoritySameType(e){return new Wi(e.canonical_authority).getUrlComponents().PathSegments.length===this.canonicalAuthorityUrlComponents.PathSegments.length}getEndpointMetadataFromConfig(){if(this.authorityOptions.authorityMetadata)try{return JSON.parse(this.authorityOptions.authorityMetadata)}catch(e){throw Ni(ki)}return null}async getEndpointMetadataFromNetwork(){this.performanceClient?.addQueueMeasurement(ss,this.correlationId);const e={},t=this.defaultOpenIdConfigurationEndpoint;this.logger.verbose(`Authority.getEndpointMetadataFromNetwork: attempting to retrieve OAuth endpoints from ${t}`);try{const r=await this.networkInterface.sendGetRequestAsync(t,e),n=function(e){return e.hasOwnProperty("authorization_endpoint")&&e.hasOwnProperty("token_endpoint")&&e.hasOwnProperty("issuer")&&e.hasOwnProperty("jwks_uri")}(r.body);return n?r.body:(this.logger.verbose("Authority.getEndpointMetadataFromNetwork: could not parse response as OpenID configuration"),null)}catch(e){return this.logger.verbose(`Authority.getEndpointMetadataFromNetwork: ${e}`),null}}getEndpointMetadataFromHardcodedValues(){return this.hostnameAndPort in Gi?Gi[this.hostnameAndPort]:null}async updateMetadataWithRegionalInformation(e){this.performanceClient?.addQueueMeasurement(ls,this.correlationId);const t=this.authorityOptions.azureRegionConfiguration?.azureRegion;if(t){if(t!==sn.AZURE_REGION_AUTO_DISCOVER_FLAG)return this.regionDiscoveryMetadata.region_outcome="2",this.regionDiscoveryMetadata.region_used=t,Uu.replaceWithRegionalInformation(e,t);const r=await Lu(this.regionDiscovery.detectRegion.bind(this.regionDiscovery),us,this.logger,this.performanceClient,this.correlationId)(this.authorityOptions.azureRegionConfiguration?.environmentRegion,this.regionDiscoveryMetadata);if(r)return this.regionDiscoveryMetadata.region_outcome="4",this.regionDiscoveryMetadata.region_used=r,Uu.replaceWithRegionalInformation(e,r);this.regionDiscoveryMetadata.region_outcome="5"}return e}async updateCloudDiscoveryMetadata(e){this.performanceClient?.addQueueMeasurement(as,this.correlationId);const t=this.updateCloudDiscoveryMetadataFromLocalSources(e);if(t)return t;const r=await Lu(this.getCloudDiscoveryMetadataFromNetwork.bind(this),is,this.logger,this.performanceClient,this.correlationId)();if(r)return ci(e,r,!0),Mn;throw Ni(Ii)}updateCloudDiscoveryMetadataFromLocalSources(e){this.logger.verbose("Attempting to get cloud discovery metadata  from authority configuration"),this.logger.verbosePii(`Known Authorities: ${this.authorityOptions.knownAuthorities||sn.NOT_APPLICABLE}`),this.logger.verbosePii(`Authority Metadata: ${this.authorityOptions.authorityMetadata||sn.NOT_APPLICABLE}`),this.logger.verbosePii(`Canonical Authority: ${e.canonical_authority||sn.NOT_APPLICABLE}`);const t=this.getCloudDiscoveryMetadataFromConfig();if(t)return this.logger.verbose("Found cloud discovery metadata in authority configuration"),ci(e,t,!1),Rn;if(this.logger.verbose("Did not find cloud discovery metadata in the config... Attempting to get cloud discovery metadata from the hardcoded values."),this.options.skipAuthorityMetadataCache)this.logger.verbose("Skipping hardcoded cloud discovery metadata cache since skipAuthorityMetadataCache is set to true. Attempting to get cloud discovery metadata from the network metadata cache.");else{const t=(r=this.hostnameAndPort,Yi(Vi.metadata,r));if(t)return this.logger.verbose("Found cloud discovery metadata from hardcoded values."),ci(e,t,!1),Nn;this.logger.verbose("Did not find cloud discovery metadata in hardcoded values... Attempting to get cloud discovery metadata from the network metadata cache.")}var r;const n=li(e);return this.isAuthoritySameType(e)&&e.aliasesFromNetwork&&!n?(this.logger.verbose("Found cloud discovery metadata in the cache."),On):(n&&this.logger.verbose("The metadata entity is expired."),null)}getCloudDiscoveryMetadataFromConfig(){if(3===this.authorityType)return this.logger.verbose("CIAM authorities do not support cloud discovery metadata, generate the aliases from authority host."),Uu.createCloudDiscoveryMetadataFromHost(this.hostnameAndPort);if(this.authorityOptions.cloudDiscoveryMetadata){this.logger.verbose("The cloud discovery metadata has been provided as a network response, in the config.");try{this.logger.verbose("Attempting to parse the cloud discovery metadata.");const e=Yi(JSON.parse(this.authorityOptions.cloudDiscoveryMetadata).metadata,this.hostnameAndPort);if(this.logger.verbose("Parsed the cloud discovery metadata."),e)return this.logger.verbose("There is returnable metadata attached to the parsed cloud discovery metadata."),e;this.logger.verbose("There is no metadata attached to the parsed cloud discovery metadata.")}catch(e){throw this.logger.verbose("Unable to parse the cloud discovery metadata. Throwing Invalid Cloud Discovery Metadata Error."),Ni(wi)}}return this.isInKnownAuthorities()?(this.logger.verbose("The host is included in knownAuthorities. Creating new cloud discovery metadata from the host."),Uu.createCloudDiscoveryMetadataFromHost(this.hostnameAndPort)):null}async getCloudDiscoveryMetadataFromNetwork(){this.performanceClient?.addQueueMeasurement(is,this.correlationId);const e=`${sn.AAD_INSTANCE_DISCOVERY_ENDPT}${this.canonicalAuthority}oauth2/v2.0/authorize`,t={};let r=null;try{const n=await this.networkInterface.sendGetRequestAsync(e,t);let o,i;if(function(e){return e.hasOwnProperty("tenant_discovery_endpoint")&&e.hasOwnProperty("metadata")}(n.body))o=n.body,i=o.metadata,this.logger.verbosePii(`tenant_discovery_endpoint is: ${o.tenant_discovery_endpoint}`);else{if(!function(e){return e.hasOwnProperty("error")&&e.hasOwnProperty("error_description")}(n.body))return this.logger.error("AAD did not return a CloudInstanceDiscoveryResponse or CloudInstanceDiscoveryErrorResponse"),null;if(this.logger.warning(`A CloudInstanceDiscoveryErrorResponse was returned. The cloud instance discovery network request's status code is: ${n.status}`),o=n.body,o.error===sn.INVALID_INSTANCE)return this.logger.error("The CloudInstanceDiscoveryErrorResponse error is invalid_instance."),null;this.logger.warning(`The CloudInstanceDiscoveryErrorResponse error is ${o.error}`),this.logger.warning(`The CloudInstanceDiscoveryErrorResponse error description is ${o.error_description}`),this.logger.warning("Setting the value of the CloudInstanceDiscoveryMetadata (returned from the network) to []"),i=[]}this.logger.verbose("Attempting to find a match between the developer's authority and the CloudInstanceDiscoveryMetadata returned from the network request."),r=Yi(i,this.hostnameAndPort)}catch(e){if(e instanceof Kn)this.logger.error(`There was a network error while attempting to get the cloud discovery instance metadata.\nError: ${e.errorCode}\nError Description: ${e.errorMessage}`);else{const t=e;this.logger.error(`A non-MSALJS error was thrown while attempting to get the cloud instance discovery metadata.\nError: ${t.name}\nError Description: ${t.message}`)}return null}return r||(this.logger.warning("The developer's authority was not found within the CloudInstanceDiscoveryMetadata returned from the network request."),this.logger.verbose("Creating custom Authority for custom domain scenario."),r=Uu.createCloudDiscoveryMetadataFromHost(this.hostnameAndPort)),r}isInKnownAuthorities(){return this.authorityOptions.knownAuthorities.filter(e=>e&&Wi.getDomainFromUrl(e).toLowerCase()===this.hostnameAndPort).length>0}static generateAuthority(e,t){let r;if(t&&t.azureCloudInstance!==Un){const e=t.tenant?t.tenant:sn.DEFAULT_COMMON_TENANT;r=`${t.azureCloudInstance}/${e}/`}return r||e}static createCloudDiscoveryMetadataFromHost(e){return{preferred_network:e,preferred_cache:e,aliases:[e]}}getPreferredCache(){if(this.managedIdentity)return sn.DEFAULT_AUTHORITY_HOST;if(this.discoveryComplete())return this.metadata.preferred_cache;throw Ho(Yn)}isAlias(e){return this.metadata.aliases.indexOf(e)>-1}isAliasOfKnownMicrosoftAuthority(e){return Qi.has(e)}static isPublicCloudAuthority(e){return sn.KNOWN_PUBLIC_CLOUDS.indexOf(e)>=0}static buildRegionalAuthorityString(e,t,r){const n=new Wi(e);n.validateAsUri();const o=n.getUrlComponents();let i=`${t}.${o.HostNameAndPort}`;this.isPublicCloudAuthority(o.HostNameAndPort)&&(i=`${t}.${sn.REGIONAL_AUTH_PUBLIC_CLOUD_SUFFIX}`);const a=Wi.constructAuthorityUriFromObject({...n.getUrlComponents(),HostNameAndPort:i}).urlString;return r?`${a}?${r}`:a}static replaceWithRegionalInformation(e,t){const r={...e};return r.authorization_endpoint=Uu.buildRegionalAuthorityString(r.authorization_endpoint,t),r.token_endpoint=Uu.buildRegionalAuthorityString(r.token_endpoint,t),r.end_session_endpoint&&(r.end_session_endpoint=Uu.buildRegionalAuthorityString(r.end_session_endpoint,t)),r}static transformCIAMAuthority(e){let t=e;const r=new Wi(e).getUrlComponents();return 0===r.PathSegments.length&&r.HostNameAndPort.endsWith(sn.CIAM_AUTH_URL)&&(t=`${t}${r.HostNameAndPort.split(".")[0]}${sn.AAD_TENANT_DOMAIN_SUFFIX}`),t}}function ju(e){return e.endsWith(sn.FORWARD_SLASH)?e:`${e}${sn.FORWARD_SLASH}`}Uu.reservedTenantDomains=new Set(["{tenant}","{tenantid}",mn,vn,yn]);const $u="no_tokens_found",zu="native_account_unavailable",Ku="refresh_token_expired",Wu="ux_not_allowed",Gu="bad_token",Vu=["interaction_required","consent_required","login_required",Gu,Wu],Qu=["message_only","additional_action","basic_action","user_password_expired","consent_required","bad_token"],Ju={[$u]:"No refresh token found in the cache. Please sign-in.",[zu]:"The requested account is not available in the native broker. It may have been deleted or logged out. Please sign-in again using an interactive API.",[Ku]:"Refresh token has expired.",[Gu]:"Identity provider returned bad_token due to an expired or invalid refresh token. Please invoke an interactive API to resolve.",[Wu]:"`canShowUI` flag in Edge was set to false. User interaction required on web page. Please invoke an interactive API to resolve."};class Yu extends Kn{constructor(e,t,r,n,o,i,a,s){super(e,t,r),Object.setPrototypeOf(this,Yu.prototype),this.timestamp=n||sn.EMPTY_STRING,this.traceId=o||sn.EMPTY_STRING,this.correlationId=i||sn.EMPTY_STRING,this.claims=a||sn.EMPTY_STRING,this.name="InteractionRequiredAuthError",this.errorNo=s}}function Xu(e,t,r){const n=!!e&&Vu.indexOf(e)>-1,o=!!r&&Qu.indexOf(r)>-1,i=!!t&&Vu.some(e=>t.indexOf(e)>-1);return n||i||o}function Zu(e){return new Yu(e,Ju[e])}function ed(e,t,r){return{clientId:e,authority:t.authority,scopes:t.scopes,homeAccountIdentifier:r,claims:t.claims,authenticationScheme:t.authenticationScheme,resourceRequestMethod:t.resourceRequestMethod,resourceRequestUri:t.resourceRequestUri,shrClaims:t.shrClaims,sshKid:t.sshKid,embeddedClientId:t.embeddedClientId||t.tokenBodyParameters?.clientId}}var td=r(64583).Promise;const rd="None";class nd{initialize(){return td.resolve()}getItem(e){const t=`${encodeURIComponent(e)}`,r=document.cookie.split(";");for(let e=0;e<r.length;e++){const n=r[e],[o,...i]=decodeURIComponent(n).trim().split("="),a=i.join("=");if(o===t)return a}return""}getUserData(){throw Ho(Bo)}setItem(e,t,r,n=!0,o="Lax"){let i=`${encodeURIComponent(e)}=${encodeURIComponent(t)};path=/;SameSite=${o};`;if(r){const e=function(e){const t=new Date;return new Date(t.getTime()+864e5*e).toUTCString()}(r);i+=`expires=${e};`}(n||o===rd)&&(i+="Secure;"),document.cookie=i}async setUserData(){return td.reject(Ho(Bo))}removeItem(e){this.setItem(e,"",-1)}getKeys(){const e=document.cookie.split(";"),t=[];return e.forEach(e=>{const r=decodeURIComponent(e).trim().split("=");t.push(r[0])}),t}containsKey(e){return this.getKeys().includes(e)}}function od(e){const t=e.getItem(pc);return t?JSON.parse(t):[]}function id(e,t){const r=t.getItem(`${fc}.${e}`);if(r){const e=JSON.parse(r);if(e&&e.hasOwnProperty("idToken")&&e.hasOwnProperty("accessToken")&&e.hasOwnProperty("refreshToken"))return e}return{idToken:[],accessToken:[],refreshToken:[]}}var ad=r(64583).Promise;const sd="msal.cache.encryption";class cd{constructor(e,t,r){if(!window.localStorage)throw pu(lu);this.memoryStorage=new xu,this.initialized=!1,this.clientId=e,this.logger=t,this.performanceClient=r,this.broadcast=new BroadcastChannel("msal.broadcast.cache")}async initialize(e){const t=new nd,r=t.getItem(sd);let n={key:"",id:""};if(r)try{n=JSON.parse(r)}catch(e){}if(n.key&&n.id){const t=qu(Ll,Rs,this.logger,this.performanceClient,e)(n.key);this.encryptionCookie={id:n.id,key:await Lu(ou,_s,this.logger,this.performanceClient,e)(t)},await Lu(this.importExistingCache.bind(this),Cs,this.logger,this.performanceClient,e)(e)}else{this.clear();const r=Zl(),n=await Lu(nu,Ps,this.logger,this.performanceClient,e)(),o=qu(Fl,Os,this.logger,this.performanceClient,e)(new Uint8Array(n));this.encryptionCookie={id:r,key:await Lu(ou,_s,this.logger,this.performanceClient,e)(n)};const i={id:r,key:o};t.setItem(sd,JSON.stringify(i),0,!0,rd)}this.broadcast.addEventListener("message",this.updateCache.bind(this)),this.initialized=!0}getItem(e){return window.localStorage.getItem(e)}getUserData(e){if(!this.initialized)throw Sl(fl);return this.memoryStorage.getItem(e)}setItem(e,t){window.localStorage.setItem(e,t)}async setUserData(e,t,r,n){if(!this.initialized||!this.encryptionCookie)throw Sl(fl);const{data:o,nonce:i}=await Lu(au,Ms,this.logger,this.performanceClient,r)(this.encryptionCookie.key,t,this.getContext(e)),a={id:this.encryptionCookie.id,nonce:i,data:o,lastUpdatedAt:n};this.memoryStorage.setItem(e,t),this.setItem(e,JSON.stringify(a)),this.broadcast.postMessage({key:e,value:t,context:this.getContext(e)})}removeItem(e){this.memoryStorage.containsKey(e)&&(this.memoryStorage.removeItem(e),this.broadcast.postMessage({key:e,value:null,context:this.getContext(e)})),window.localStorage.removeItem(e)}getKeys(){return Object.keys(window.localStorage)}containsKey(e){return window.localStorage.hasOwnProperty(e)}clear(){this.memoryStorage.clear(),od(this).forEach(e=>this.removeItem(e));const e=id(this.clientId,this);e.idToken.forEach(e=>this.removeItem(e)),e.accessToken.forEach(e=>this.removeItem(e)),e.refreshToken.forEach(e=>this.removeItem(e)),this.getKeys().forEach(e=>{(e.startsWith(sn.CACHE_PREFIX)||-1!==e.indexOf(this.clientId))&&this.removeItem(e)})}async importExistingCache(e){if(!this.encryptionCookie)return;let t=od(this);t=await this.importArray(t,e),this.setItem(pc,JSON.stringify(t));const r=id(this.clientId,this);r.idToken=await this.importArray(r.idToken,e),r.accessToken=await this.importArray(r.accessToken,e),r.refreshToken=await this.importArray(r.refreshToken,e),this.setItem(`${fc}.${this.clientId}`,JSON.stringify(r))}async getItemFromEncryptedCache(e,t){if(!this.encryptionCookie)return null;const r=this.getItem(e);if(!r)return null;let n;try{n=JSON.parse(r)}catch(e){return null}return n.id&&n.nonce&&n.data?n.id!==this.encryptionCookie.id?(this.performanceClient.incrementFields({encryptedCacheExpiredCount:1},t),null):Lu(su,Ns,this.logger,this.performanceClient,t)(this.encryptionCookie.key,n.nonce,this.getContext(e),n.data):(this.performanceClient.incrementFields({unencryptedCacheCount:1},t),null)}async importArray(e,t){const r=[],n=[];return e.forEach(e=>{const o=this.getItemFromEncryptedCache(e,t).then(t=>{t?(this.memoryStorage.setItem(e,t),r.push(e)):this.removeItem(e)});n.push(o)}),await ad.all(n),r}getContext(e){let t="";return e.includes(this.clientId)&&(t=this.clientId),t}updateCache(e){this.logger.trace("Updating internal cache from broadcast event");const t=this.performanceClient.startMeasurement(ks);t.add({isBackground:!0});const{key:r,value:n,context:o}=e.data;return r?o&&o!==this.clientId?(this.logger.trace(`Ignoring broadcast event from clientId: ${o}`),void t.end({success:!1,errorCode:"contextMismatch"})):(n?(this.memoryStorage.setItem(r,n),this.logger.verbose("Updated item in internal cache")):(this.memoryStorage.removeItem(r),this.logger.verbose("Removed item from internal cache")),void t.end({success:!0})):(this.logger.error("Broadcast event missing key"),void t.end({success:!1,errorCode:"noKey"}))}}class ld{constructor(){if(!window.sessionStorage)throw pu(lu)}async initialize(){}getItem(e){return window.sessionStorage.getItem(e)}getUserData(e){return this.getItem(e)}setItem(e,t){window.sessionStorage.setItem(e,t)}async setUserData(e,t){this.setItem(e,t)}removeItem(e){window.sessionStorage.removeItem(e)}getKeys(){return Object.keys(window.sessionStorage)}containsKey(e){return window.sessionStorage.hasOwnProperty(e)}}const ud="msal:initializeEnd",dd="msal:accountAdded",hd="msal:accountRemoved",gd="msal:activeAccountChanged",pd="msal:loginStart",fd="msal:loginSuccess",md="msal:loginFailure",yd="msal:acquireTokenStart",vd="msal:acquireTokenSuccess",bd="msal:acquireTokenFailure",Cd="msal:acquireTokenByCodeFailure",wd="msal:handleRedirectEnd",kd="msal:popupOpened",Id="msal:logoutStart",Ad="msal:logoutSuccess",Td="msal:logoutFailure",Sd="msal:logoutEnd";class Ed extends na{constructor(e,t,r,n,o,i,a){super(e,r,n,o,a),this.cacheConfig=t,this.logger=n,this.internalStorage=new xu,this.browserStorage=_d(e,t.cacheLocation,n,o),this.temporaryCacheStorage=_d(e,t.temporaryCacheLocation,n,o),this.cookieStorage=new nd,this.eventHandler=i}async initialize(e){await this.browserStorage.initialize(e),this.trackVersionChanges(e)}trackVersionChanges(e){const t=this.browserStorage.getItem(mc);t&&(this.logger.info(`MSAL.js was last initialized by version: ${t}`),this.performanceClient.addFields({previousLibraryVersion:t},e)),t!==Iu&&this.setItem(mc,Iu,e)}validateAndParseJson(e){try{const t=JSON.parse(e);return t&&"object"==typeof t?t:null}catch(e){return null}}setItem(e,t,r){let n=[];for(let o=0;o<=20;o++)try{this.browserStorage.setItem(e,t),o>0&&this.removeAccessTokenKeys(n.slice(0,o),r);break}catch(i){const a=ra(i);if(!(a.errorCode===Xi&&o<20))throw a;if(n.length||(n=e===`${fc}.${this.clientId}`?JSON.parse(t).accessToken:this.getTokenKeys().accessToken),n.length<=o)throw a;this.removeAccessToken(n[o],r,!1)}}async setUserData(e,t,r,n){let o=[];for(let i=0;i<=20;i++)try{await Lu(this.browserStorage.setUserData.bind(this.browserStorage),ws,this.logger,this.performanceClient)(e,t,r,n),i>0&&this.removeAccessTokenKeys(o.slice(0,i),r);break}catch(e){const t=ra(e);if(!(t.errorCode===Xi&&i<20))throw t;if(o.length||(o=this.getTokenKeys().accessToken),o.length<=i)throw t;this.removeAccessToken(o[i],r,!1)}}getAccount(e,t){this.logger.trace("BrowserCacheManager.getAccount called");const r=this.browserStorage.getUserData(e);if(!r)return this.removeAccountKeyFromMap(e,t),null;const n=this.validateAndParseJson(r);return n&&ji.isAccountEntity(n)?na.toObject(new ji,n):null}async setAccount(e,t){this.logger.trace("BrowserCacheManager.setAccount called");const r=e.generateAccountKey(),n=Date.now().toString();e.lastUpdatedAt=n,await this.setUserData(r,JSON.stringify(e),t,n);const o=this.addAccountKeyToMap(r,t);this.cacheConfig.cacheLocation===nc&&o&&this.eventHandler.emitEvent(dd,void 0,e.getAccountInfo())}getAccountKeys(){return od(this.browserStorage)}addAccountKeyToMap(e,t){this.logger.trace("BrowserCacheManager.addAccountKeyToMap called"),this.logger.tracePii(`BrowserCacheManager.addAccountKeyToMap called with key: ${e}`);const r=this.getAccountKeys();return-1===r.indexOf(e)?(r.push(e),this.setItem(pc,JSON.stringify(r),t),this.logger.verbose("BrowserCacheManager.addAccountKeyToMap account key added"),!0):(this.logger.verbose("BrowserCacheManager.addAccountKeyToMap account key already exists in map"),!1)}removeAccountKeyFromMap(e,t){this.logger.trace("BrowserCacheManager.removeAccountKeyFromMap called"),this.logger.tracePii(`BrowserCacheManager.removeAccountKeyFromMap called with key: ${e}`);const r=this.getAccountKeys(),n=r.indexOf(e);if(n>-1){if(r.splice(n,1),0===r.length)return void this.removeItem(pc);this.setItem(pc,JSON.stringify(r),t),this.logger.trace("BrowserCacheManager.removeAccountKeyFromMap account key removed")}else this.logger.trace("BrowserCacheManager.removeAccountKeyFromMap key not found in existing map")}removeAccount(e,t){super.removeAccount(e,t),this.removeAccountKeyFromMap(e,t)}removeAccountContext(e,t){super.removeAccountContext(e,t),this.cacheConfig.cacheLocation===nc&&this.eventHandler.emitEvent(hd,void 0,e.getAccountInfo())}removeIdToken(e,t){super.removeIdToken(e,t);const r=this.getTokenKeys(),n=r.idToken.indexOf(e);n>-1&&(this.logger.info("idToken removed from tokenKeys map"),r.idToken.splice(n,1),this.setTokenKeys(r,t))}removeAccessToken(e,t,r=!0){super.removeAccessToken(e,t),r&&this.removeAccessTokenKeys([e],t)}removeAccessTokenKeys(e,t){this.logger.trace("removeAccessTokenKey called");const r=this.getTokenKeys();let n=0;if(e.forEach(e=>{const t=r.accessToken.indexOf(e);t>-1&&(r.accessToken.splice(t,1),n++)}),n>0)return this.logger.info(`removed ${n} accessToken keys from tokenKeys map`),void this.setTokenKeys(r,t)}removeRefreshToken(e,t){super.removeRefreshToken(e,t);const r=this.getTokenKeys(),n=r.refreshToken.indexOf(e);n>-1&&(this.logger.info("refreshToken removed from tokenKeys map"),r.refreshToken.splice(n,1),this.setTokenKeys(r,t))}getTokenKeys(){return id(this.clientId,this.browserStorage)}setTokenKeys(e,t){0!==e.idToken.length||0!==e.accessToken.length||0!==e.refreshToken.length?this.setItem(`${fc}.${this.clientId}`,JSON.stringify(e),t):this.removeItem(`${fc}.${this.clientId}`)}getIdTokenCredential(e,t){const r=this.browserStorage.getUserData(e);if(!r)return this.logger.trace("BrowserCacheManager.getIdTokenCredential: called, no cache hit"),this.removeIdToken(e,t),null;const n=this.validateAndParseJson(r);return n&&(o=n)&&ei(o)&&o.hasOwnProperty("realm")&&o.credentialType===Sn.ID_TOKEN?(this.logger.trace("BrowserCacheManager.getIdTokenCredential: cache hit"),n):(this.logger.trace("BrowserCacheManager.getIdTokenCredential: called, no cache hit"),null);var o}async setIdTokenCredential(e,t){this.logger.trace("BrowserCacheManager.setIdTokenCredential called");const r=Jo(e),n=Date.now().toString();e.lastUpdatedAt=n,await this.setUserData(r,JSON.stringify(e),t,n);const o=this.getTokenKeys();-1===o.idToken.indexOf(r)&&(this.logger.info("BrowserCacheManager: addTokenKey - idToken added to map"),o.idToken.push(r),this.setTokenKeys(o,t))}getAccessTokenCredential(e,t){const r=this.browserStorage.getUserData(e);if(!r)return this.logger.trace("BrowserCacheManager.getAccessTokenCredential: called, no cache hit"),this.removeAccessTokenKeys([e],t),null;const n=this.validateAndParseJson(r);return n&&(o=n)&&ei(o)&&o.hasOwnProperty("realm")&&o.hasOwnProperty("target")&&(o.credentialType===Sn.ACCESS_TOKEN||o.credentialType===Sn.ACCESS_TOKEN_WITH_AUTH_SCHEME)?(this.logger.trace("BrowserCacheManager.getAccessTokenCredential: cache hit"),n):(this.logger.trace("BrowserCacheManager.getAccessTokenCredential: called, no cache hit"),null);var o}async setAccessTokenCredential(e,t){this.logger.trace("BrowserCacheManager.setAccessTokenCredential called");const r=Jo(e),n=Date.now().toString();e.lastUpdatedAt=n,await this.setUserData(r,JSON.stringify(e),t,n);const o=this.getTokenKeys(),i=o.accessToken.indexOf(r);-1!==i&&o.accessToken.splice(i,1),this.logger.trace(`access token ${-1===i?"added to":"updated in"} map`),o.accessToken.push(r),this.setTokenKeys(o,t)}getRefreshTokenCredential(e,t){const r=this.browserStorage.getUserData(e);if(!r)return this.logger.trace("BrowserCacheManager.getRefreshTokenCredential: called, no cache hit"),this.removeRefreshToken(e,t),null;const n=this.validateAndParseJson(r);return n&&(o=n)&&ei(o)&&o.credentialType===Sn.REFRESH_TOKEN?(this.logger.trace("BrowserCacheManager.getRefreshTokenCredential: cache hit"),n):(this.logger.trace("BrowserCacheManager.getRefreshTokenCredential: called, no cache hit"),null);var o}async setRefreshTokenCredential(e,t){this.logger.trace("BrowserCacheManager.setRefreshTokenCredential called");const r=Jo(e),n=Date.now().toString();e.lastUpdatedAt=n,await this.setUserData(r,JSON.stringify(e),t,n);const o=this.getTokenKeys();-1===o.refreshToken.indexOf(r)&&(this.logger.info("BrowserCacheManager: addTokenKey - refreshToken added to map"),o.refreshToken.push(r),this.setTokenKeys(o,t))}getAppMetadata(e){const t=this.browserStorage.getItem(e);if(!t)return this.logger.trace("BrowserCacheManager.getAppMetadata: called, no cache hit"),null;const r=this.validateAndParseJson(t);return r&&((n=r)&&0===e.indexOf(En)&&n.hasOwnProperty("clientId")&&n.hasOwnProperty("environment"))?(this.logger.trace("BrowserCacheManager.getAppMetadata: cache hit"),r):(this.logger.trace("BrowserCacheManager.getAppMetadata: called, no cache hit"),null);var n}setAppMetadata(e,t){this.logger.trace("BrowserCacheManager.setAppMetadata called");const r=function({environment:e,clientId:t}){return[En,e,t].join(Tn).toLowerCase()}(e);this.setItem(r,JSON.stringify(e),t)}getServerTelemetry(e){const t=this.browserStorage.getItem(e);if(!t)return this.logger.trace("BrowserCacheManager.getServerTelemetry: called, no cache hit"),null;const r=this.validateAndParseJson(t);return r&&function(e,t){const r=0===e.indexOf(xn.CACHE_KEY);let n=!0;return t&&(n=t.hasOwnProperty("failedRequests")&&t.hasOwnProperty("errors")&&t.hasOwnProperty("cacheHits")),r&&n}(e,r)?(this.logger.trace("BrowserCacheManager.getServerTelemetry: cache hit"),r):(this.logger.trace("BrowserCacheManager.getServerTelemetry: called, no cache hit"),null)}setServerTelemetry(e,t,r){this.logger.trace("BrowserCacheManager.setServerTelemetry called"),this.setItem(e,JSON.stringify(t),r)}getAuthorityMetadata(e){const t=this.internalStorage.getItem(e);if(!t)return this.logger.trace("BrowserCacheManager.getAuthorityMetadata: called, no cache hit"),null;const r=this.validateAndParseJson(t);return r&&function(e,t){return!!t&&0===e.indexOf(Pn)&&t.hasOwnProperty("aliases")&&t.hasOwnProperty("preferred_cache")&&t.hasOwnProperty("preferred_network")&&t.hasOwnProperty("canonical_authority")&&t.hasOwnProperty("authorization_endpoint")&&t.hasOwnProperty("token_endpoint")&&t.hasOwnProperty("issuer")&&t.hasOwnProperty("aliasesFromNetwork")&&t.hasOwnProperty("endpointsFromNetwork")&&t.hasOwnProperty("expiresAt")&&t.hasOwnProperty("jwks_uri")}(e,r)?(this.logger.trace("BrowserCacheManager.getAuthorityMetadata: cache hit"),r):null}getAuthorityMetadataKeys(){return this.internalStorage.getKeys().filter(e=>this.isAuthorityMetadata(e))}setWrapperMetadata(e,t){this.internalStorage.setItem(yc,e),this.internalStorage.setItem(vc,t)}getWrapperMetadata(){return[this.internalStorage.getItem(yc)||sn.EMPTY_STRING,this.internalStorage.getItem(vc)||sn.EMPTY_STRING]}setAuthorityMetadata(e,t){this.logger.trace("BrowserCacheManager.setAuthorityMetadata called"),this.internalStorage.setItem(e,JSON.stringify(t))}getActiveAccount(e){const t=this.generateCacheKey(fn),r=this.browserStorage.getItem(t);if(!r)return this.logger.trace("BrowserCacheManager.getActiveAccount: No active account filters found"),null;const n=this.validateAndParseJson(r);return n?(this.logger.trace("BrowserCacheManager.getActiveAccount: Active account filters schema found"),this.getAccountInfoFilteredBy({homeAccountId:n.homeAccountId,localAccountId:n.localAccountId,tenantId:n.tenantId},e)):(this.logger.trace("BrowserCacheManager.getActiveAccount: No active account found"),null)}setActiveAccount(e,t){const r=this.generateCacheKey(fn);if(e){this.logger.verbose("setActiveAccount: Active account set");const n={homeAccountId:e.homeAccountId,localAccountId:e.localAccountId,tenantId:e.tenantId,lastUpdatedAt:Wo().toString()};this.setItem(r,JSON.stringify(n),t)}else this.logger.verbose("setActiveAccount: No account passed, active account not set"),this.browserStorage.removeItem(r);this.eventHandler.emitEvent(gd)}getThrottlingCache(e){const t=this.browserStorage.getItem(e);if(!t)return this.logger.trace("BrowserCacheManager.getThrottlingCache: called, no cache hit"),null;const r=this.validateAndParseJson(t);return r&&function(e,t){let r=!1;e&&(r=0===e.indexOf(Bn));let n=!0;return t&&(n=t.hasOwnProperty("throttleTime")),r&&n}(e,r)?(this.logger.trace("BrowserCacheManager.getThrottlingCache: cache hit"),r):(this.logger.trace("BrowserCacheManager.getThrottlingCache: called, no cache hit"),null)}setThrottlingCache(e,t,r){this.logger.trace("BrowserCacheManager.setThrottlingCache called"),this.setItem(e,JSON.stringify(t),r)}getTemporaryCache(e,t){const r=t?this.generateCacheKey(e):e;if(this.cacheConfig.storeAuthStateInCookie){const e=this.cookieStorage.getItem(r);if(e)return this.logger.trace("BrowserCacheManager.getTemporaryCache: storeAuthStateInCookies set to true, retrieving from cookies"),e}const n=this.temporaryCacheStorage.getItem(r);if(!n){if(this.cacheConfig.cacheLocation===nc){const e=this.browserStorage.getItem(r);if(e)return this.logger.trace("BrowserCacheManager.getTemporaryCache: Temporary cache item found in local storage"),e}return this.logger.trace("BrowserCacheManager.getTemporaryCache: No cache item found in local storage"),null}return this.logger.trace("BrowserCacheManager.getTemporaryCache: Temporary cache item returned"),n}setTemporaryCache(e,t,r){const n=r?this.generateCacheKey(e):e;this.temporaryCacheStorage.setItem(n,t),this.cacheConfig.storeAuthStateInCookie&&(this.logger.trace("BrowserCacheManager.setTemporaryCache: storeAuthStateInCookie set to true, setting item cookie"),this.cookieStorage.setItem(n,t,void 0,this.cacheConfig.secureCookies))}removeItem(e){this.browserStorage.removeItem(e)}removeTemporaryItem(e){this.temporaryCacheStorage.removeItem(e),this.cacheConfig.storeAuthStateInCookie&&(this.logger.trace("BrowserCacheManager.removeItem: storeAuthStateInCookie is true, clearing item cookie"),this.cookieStorage.removeItem(e))}getKeys(){return this.browserStorage.getKeys()}clear(e){this.removeAllAccounts(e),this.removeAppMetadata(e),this.temporaryCacheStorage.getKeys().forEach(e=>{-1===e.indexOf(sn.CACHE_PREFIX)&&-1===e.indexOf(this.clientId)||this.removeTemporaryItem(e)}),this.browserStorage.getKeys().forEach(e=>{-1===e.indexOf(sn.CACHE_PREFIX)&&-1===e.indexOf(this.clientId)||this.browserStorage.removeItem(e)}),this.internalStorage.clear()}clearTokensAndKeysWithClaims(e){this.performanceClient.addQueueMeasurement(vs,e);const t=this.getTokenKeys();let r=0;t.accessToken.forEach(t=>{const n=this.getAccessTokenCredential(t,e);n?.requestedClaimsHash&&t.includes(n.requestedClaimsHash.toLowerCase())&&(this.removeAccessToken(t,e),r++)}),r>0&&this.logger.warning(`${r} access tokens with claims in the cache keys have been removed from the cache.`)}generateCacheKey(e){return this.validateAndParseJson(e)?JSON.stringify(e):xi.startsWith(e,sn.CACHE_PREFIX)?e:`${sn.CACHE_PREFIX}.${this.clientId}.${e}`}resetRequestCache(){this.logger.trace("BrowserCacheManager.resetRequestCache called"),this.removeTemporaryItem(this.generateCacheKey(uc)),this.removeTemporaryItem(this.generateCacheKey(dc)),this.removeTemporaryItem(this.generateCacheKey(cc)),this.removeTemporaryItem(this.generateCacheKey(lc)),this.removeTemporaryItem(this.generateCacheKey(gc)),this.setInteractionInProgress(!1)}cacheAuthorizeRequest(e,t){this.logger.trace("BrowserCacheManager.cacheAuthorizeRequest called");const r=Bl(JSON.stringify(e));if(this.setTemporaryCache(uc,r,!0),t){const e=Bl(t);this.setTemporaryCache(dc,e,!0)}}getCachedRequest(){this.logger.trace("BrowserCacheManager.getCachedRequest called");const e=this.getTemporaryCache(uc,!0);if(!e)throw Sl(Qc);const t=this.getTemporaryCache(dc,!0);let r,n="";try{r=JSON.parse(ql(e)),t&&(n=ql(t))}catch(t){throw this.logger.errorPii(`Attempted to parse: ${e}`),this.logger.error(`Parsing cached token request threw with error: ${t}`),Sl(Jc)}return[r,n]}getCachedNativeRequest(){this.logger.trace("BrowserCacheManager.getCachedNativeRequest called");const e=this.getTemporaryCache(gc,!0);if(!e)return this.logger.trace("BrowserCacheManager.getCachedNativeRequest: No cached native request found"),null;return this.validateAndParseJson(e)||(this.logger.error("BrowserCacheManager.getCachedNativeRequest: Unable to parse native request"),null)}isInteractionInProgress(e){const t=this.getInteractionInProgress()?.clientId;return e?t===this.clientId:!!t}getInteractionInProgress(){const e=`${sn.CACHE_PREFIX}.${hc}`,t=this.getTemporaryCache(e,!1);try{return t?JSON.parse(t):null}catch(t){return this.logger.error("Cannot parse interaction status. Removing temporary cache items and clearing url hash. Retrying interaction should fix the error"),this.removeTemporaryItem(e),this.resetRequestCache(),fu(window),null}}setInteractionInProgress(e,t=ac){const r=`${sn.CACHE_PREFIX}.${hc}`;if(e){if(this.getInteractionInProgress())throw Sl(Bc);this.setTemporaryCache(r,JSON.stringify({clientId:this.clientId,type:t}),!1)}else e||this.getInteractionInProgress()?.clientId!==this.clientId||this.removeTemporaryItem(r)}async hydrateCache(e,t){const r=Yo(e.account?.homeAccountId,e.account?.environment,e.idToken,this.clientId,e.tenantId);let n;t.claims&&(n=await this.cryptoImpl.hashString(t.claims));const o={idToken:r,accessToken:Xo(e.account?.homeAccountId,e.account.environment,e.accessToken,this.clientId,e.tenantId,e.scopes.join(" "),e.expiresOn?Go(e.expiresOn):0,e.extExpiresOn?Go(e.extExpiresOn):0,ql,void 0,e.tokenType,void 0,t.sshKid,t.claims,n)};return this.saveCacheRecord(o,e.correlationId)}async saveCacheRecord(e,t,r){try{await super.saveCacheRecord(e,t,r)}catch(e){if(e instanceof ta&&this.performanceClient&&t)try{const e=this.getTokenKeys();this.performanceClient.addFields({cacheRtCount:e.refreshToken.length,cacheIdCount:e.idToken.length,cacheAtCount:e.accessToken.length},t)}catch(e){}throw e}}}function _d(e,t,r,n){try{switch(t){case nc:return new cd(e,r,n);case oc:return new ld}}catch(e){r.error(e)}return new xu}class Pd{constructor(e){this.eventCallbacks=new Map,this.logger=e||new qn({}),"undefined"!=typeof BroadcastChannel&&(this.broadcastChannel=new BroadcastChannel("msal.broadcast.event")),this.invokeCrossTabCallbacks=this.invokeCrossTabCallbacks.bind(this)}addEventCallback(e,t,r){if("undefined"!=typeof window){const n=r||Zl();return this.eventCallbacks.has(n)?(this.logger.error(`Event callback with id: ${n} is already registered. Please provide a unique id or remove the existing callback and try again.`),null):(this.eventCallbacks.set(n,[e,t||[]]),this.logger.verbose(`Event callback registered with id: ${n}`),n)}return null}removeEventCallback(e){this.eventCallbacks.delete(e),this.logger.verbose(`Event callback ${e} removed.`)}emitEvent(e,t,r,n){const o={eventType:e,interactionType:t||null,payload:r||null,error:n||null,timestamp:Date.now()};switch(e){case dd:case hd:case gd:this.broadcastChannel?.postMessage(o);break;default:this.invokeCallbacks(o)}}invokeCallbacks(e){this.eventCallbacks.forEach(([t,r],n)=>{(0===r.length||r.includes(e.eventType))&&(this.logger.verbose(`Emitting event to callback ${n}: ${e.eventType}`),t.apply(null,[e]))})}invokeCrossTabCallbacks(e){const t=e.data;this.invokeCallbacks(t)}subscribeCrossTab(){this.broadcastChannel?.addEventListener("message",this.invokeCrossTabCallbacks)}unsubscribeCrossTab(){this.broadcastChannel?.removeEventListener("message",this.invokeCrossTabCallbacks)}}const Rd="home_account_id",Od="UPN",Md="client_id",Nd="redirect_uri",xd="token_type",Fd="req_cnf",Bd="return_spa_code",Dd="x-client-xtra-sku",qd="brk_client_id",Ld="brk_redirect_uri",Hd="instance_aware";function Ud(e,t,r){if(!t)return;const n=e.get(Md);n&&e.has(qd)&&r?.addFields({embeddedClientId:n,embeddedRedirectUri:e.get(Nd)},t)}function jd(e,t){e.set("response_type",t)}function $d(e,t,r=!0,n=cn){!r||n.includes("openid")||t.includes("openid")||n.push("openid");const o=r?[...t||[],...n]:t||[],i=new Fi(o);e.set("scope",i.printScopes())}function zd(e,t){e.set(Md,t)}function Kd(e,t){e.set(Nd,t)}function Wd(e,t){e.set("login_hint",t)}function Gd(e,t){e.set(hn,`UPN:${t}`)}function Vd(e,t){e.set(hn,`Oid:${t.uid}@${t.utid}`)}function Qd(e,t){e.set("sid",t)}function Jd(e,t,r){const n=function(e,t){let r;if(e)try{r=JSON.parse(e)}catch(e){throw Ni(mi)}else r={};return t&&t.length>0&&(r.hasOwnProperty(bn)||(r[bn]={}),r[bn].xms_cc={values:t}),JSON.stringify(r)}(t,r);try{JSON.parse(n)}catch(e){throw Ni(mi)}e.set("claims",n)}function Yd(e,t){e.set("client-request-id",t)}function Xd(e,t){e.set("x-client-SKU",t.sku),e.set("x-client-VER",t.version),t.os&&e.set("x-client-OS",t.os),t.cpu&&e.set("x-client-CPU",t.cpu)}function Zd(e,t){t?.appName&&e.set("x-app-name",t.appName),t?.appVersion&&e.set("x-app-ver",t.appVersion)}function eh(e,t){t&&e.set("state",t)}function th(e,t){e.set("client_secret",t)}function rh(e,t){t&&e.set("client_assertion",t)}function nh(e,t){t&&e.set("client_assertion_type",t)}function oh(e,t){e.set("grant_type",t)}function ih(e){e.set("client_info","1")}function ah(e){e.has(Hd)||e.set(Hd,"true")}function sh(e,t){Object.entries(t).forEach(([t,r])=>{!e.has(t)&&r&&e.set(t,r)})}function ch(e,t){t&&(e.set(xd,Fn.POP),e.set(Fd,t))}function lh(e,t){t&&(e.set(xd,Fn.SSH),e.set(Fd,t))}function uh(e,t){e.set("x-client-current-telemetry",t.generateCurrentRequestHeaderValue()),e.set("x-client-last-telemetry",t.generateLastRequestHeaderValue())}function dh(e){e.set("x-ms-lib-capability","retry-after, h429")}function hh(e,t,r){e.has(qd)||e.set(qd,t),e.has(Ld)||e.set(Ld,r)}async function gh(e,t,r,n,o,i,a){a?.addQueueMeasurement(ns,i);const s=Uu.transformCIAMAuthority(ju(e)),c=new Uu(s,t,r,n,o,i,a);try{return await Lu(c.resolveEndpointsAsync.bind(c),os,o,a,i)(),c}catch(e){throw Ho(Yn)}}class ph extends Kn{constructor(e,t,r,n,o){super(e,t,r),this.name="ServerError",this.errorNo=n,this.status=o,Object.setPrototypeOf(this,ph.prototype)}}class fh{static generateThrottlingStorageKey(e){return`${Bn}.${JSON.stringify(e)}`}static preProcess(e,t,r){const n=fh.generateThrottlingStorageKey(t),o=e.getThrottlingCache(n);if(o){if(o.throttleTime<Date.now())return void e.removeItem(n,r);throw new ph(o.errorCodes?.join(" ")||sn.EMPTY_STRING,o.errorMessage,o.subError)}}static postProcess(e,t,r,n){if(fh.checkResponseStatus(r)||fh.checkResponseForRetryAfter(r)){const o={throttleTime:fh.calculateThrottleTime(parseInt(r.headers[dn])),error:r.body.error,errorCodes:r.body.error_codes,errorMessage:r.body.error_description,subError:r.body.suberror};e.setThrottlingCache(fh.generateThrottlingStorageKey(t),o,n)}}static checkResponseStatus(e){return 429===e.status||e.status>=500&&e.status<600}static checkResponseForRetryAfter(e){return!!e.headers&&e.headers.hasOwnProperty(dn)&&(e.status<200||e.status>=300)}static calculateThrottleTime(e){const t=e<=0?0:e,r=Date.now()/1e3;return Math.floor(1e3*Math.min(r+(t||60),r+3600))}static removeThrottle(e,t,r,n){const o=ed(t,r,n),i=this.generateThrottlingStorageKey(o);e.removeItem(i,r.correlationId)}}class mh{constructor(e,t){this.config=function({authOptions:e,systemOptions:t,loggerOptions:r,cacheOptions:n,storageInterface:o,networkInterface:i,cryptoInterface:a,clientCredentials:s,libraryInfo:c,telemetry:l,serverTelemetryManager:u,persistencePlugin:d,serializableCache:h}){const g={...Hs,...r};return{authOptions:(p=e,{clientCapabilities:[],azureCloudOptions:Ks,skipAuthorityMetadataCache:!1,instanceAware:!1,encodeExtraQueryParams:!1,...p}),systemOptions:{...Ls,...t},loggerOptions:g,cacheOptions:{...Us,...n},storageInterface:o||new oa(e.clientId,Uo,new qn(g),new qs),networkInterface:i||js,cryptoInterface:a||Uo,clientCredentials:s||zs,libraryInfo:{...$s,...c},telemetry:{...Ws,...l},serverTelemetryManager:u||null,persistencePlugin:d||null,serializableCache:h||null};var p}(e),this.logger=new qn(this.config.loggerOptions,jo,$o),this.cryptoUtils=this.config.cryptoInterface,this.cacheManager=this.config.storageInterface,this.networkClient=this.config.networkInterface,this.serverTelemetryManager=this.config.serverTelemetryManager,this.authority=this.config.authOptions.authority,this.performanceClient=t}createTokenRequestHeaders(e){const t={};if(t[un]=sn.URL_FORM_CONTENT_TYPE,!this.config.systemOptions.preventCorsPreflight&&e)switch(e.type){case Rd:try{const r=Di(e.credential);t[hn]=`Oid:${r.uid}@${r.utid}`}catch(e){this.logger.verbose("Could not parse home account ID for CCS Header: "+e)}break;case Od:t[hn]=`UPN: ${e.credential}`}return t}async executePostToTokenEndpoint(e,t,r,n,o,i){i&&this.performanceClient?.addQueueMeasurement(i,o);const a=await this.sendPostRequest(n,e,{body:t,headers:r},o);return this.config.serverTelemetryManager&&a.status<500&&429!==a.status&&this.config.serverTelemetryManager.clearTelemetryCache(),a}async sendPostRequest(e,t,r,n){let o;fh.preProcess(this.cacheManager,e,n);try{o=await Lu(this.networkClient.sendPostRequestAsync.bind(this.networkClient),ba,this.logger,this.performanceClient,n)(t,r);const e=o.headers||{};this.performanceClient?.addFields({refreshTokenSize:o.body.refresh_token?.length||0,httpVerToken:e[pn]||"",requestId:e[gn]||""},n)}catch(e){if(e instanceof Pl){const t=e.responseHeaders;throw t&&this.performanceClient?.addFields({httpVerToken:t[pn]||"",requestId:t[gn]||"",contentTypeHeader:t[un]||void 0,contentLengthHeader:t["Content-Length"]||void 0,httpStatus:e.httpStatus},n),e.error}throw e instanceof Kn?e:Ho(Xn)}return fh.postProcess(this.cacheManager,e,o,n),o}async updateAuthority(e,t){this.performanceClient?.addQueueMeasurement(Qa,t);const r=`https://${e}/${this.authority.tenant}/`,n=await gh(r,this.networkClient,this.cacheManager,this.authority.options,this.logger,t,this.performanceClient);this.authority=n}createTokenQueryParameters(e){const t=new Map;return e.embeddedClientId&&hh(t,this.config.authOptions.clientId,this.config.authOptions.redirectUri),e.tokenQueryParameters&&sh(t,e.tokenQueryParameters),Yd(t,e.correlationId),Ud(t,e.correlationId,this.performanceClient),Ki(t)}}class yh{static setRequestState(e,t,r){const n=yh.generateLibraryState(e,r);return t?`${n}${sn.RESOURCE_DELIM}${t}`:n}static generateLibraryState(e,t){if(!e)throw Ho(ko);const r={id:e.createNewGuid()};t&&(r.meta=t);const n=JSON.stringify(r);return e.base64Encode(n)}static parseRequestState(e,t){if(!e)throw Ho(ko);if(!t)throw Ho(to);try{const r=t.split(sn.RESOURCE_DELIM),n=r[0],o=r.length>1?r.slice(1).join(sn.RESOURCE_DELIM):sn.EMPTY_STRING,i=e.base64Decode(n),a=JSON.parse(i);return{userRequestState:o||sn.EMPTY_STRING,libraryState:a}}catch(e){throw Ho(to)}}}class vh{constructor(e,t){this.cryptoUtils=e,this.performanceClient=t}async generateCnf(e,t){this.performanceClient?.addQueueMeasurement(Za,e.correlationId);const r=await Lu(this.generateKid.bind(this),Za,t,this.performanceClient,e.correlationId)(e),n=this.cryptoUtils.base64UrlEncode(JSON.stringify(r));return{kid:r.kid,reqCnfString:n}}async generateKid(e){return this.performanceClient?.addQueueMeasurement(es,e.correlationId),{kid:await this.cryptoUtils.getPublicKeyThumbprint(e),xms_ksl:"sw"}}async signPopToken(e,t,r){return this.signPayload(e,t,r)}async signPayload(e,t,r,n){const{resourceRequestMethod:o,resourceRequestUri:i,shrClaims:a,shrNonce:s,shrOptions:c}=r,l=i?new Wi(i):void 0,u=l?.getUrlComponents();return this.cryptoUtils.signJwt({at:e,ts:Wo(),m:o?.toUpperCase(),u:u?.HostNameAndPort,nonce:s||this.cryptoUtils.createNewGuid(),p:u?.AbsolutePath,q:u?.QueryString?[[],u.QueryString]:void 0,client_claims:a||void 0,...n},t,c,r.correlationId)}}class bh{constructor(e,t){this.cache=e,this.hasChanged=t}get cacheHasChanged(){return this.hasChanged}get tokenCache(){return this.cache}}class Ch{constructor(e,t,r,n,o,i,a){this.clientId=e,this.cacheStorage=t,this.cryptoObj=r,this.logger=n,this.serializableCache=o,this.persistencePlugin=i,this.performanceClient=a}validateTokenResponse(e,t){if(e.error||e.error_description||e.suberror){const r=`Error(s): ${e.error_codes||sn.NOT_AVAILABLE} - Timestamp: ${e.timestamp||sn.NOT_AVAILABLE} - Description: ${e.error_description||sn.NOT_AVAILABLE} - Correlation ID: ${e.correlation_id||sn.NOT_AVAILABLE} - Trace ID: ${e.trace_id||sn.NOT_AVAILABLE}`,n=e.error_codes?.length?e.error_codes[0]:void 0,o=new ph(e.error,r,e.suberror,n,e.status);if(t&&e.status&&e.status>=500&&e.status<=599)return void this.logger.warning(`executeTokenRequest:validateTokenResponse - AAD is currently unavailable and the access token is unable to be refreshed.\n${o}`);if(t&&e.status&&e.status>=400&&e.status<=499)return void this.logger.warning(`executeTokenRequest:validateTokenResponse - AAD is currently available but is unable to refresh the access token.\n${o}`);if(Xu(e.error,e.error_description,e.suberror))throw new Yu(e.error,e.error_description,e.suberror,e.timestamp||sn.EMPTY_STRING,e.trace_id||sn.EMPTY_STRING,e.correlation_id||sn.EMPTY_STRING,e.claims||sn.EMPTY_STRING,n);throw o}}async handleServerTokenResponse(e,t,r,n,o,i,a,s,c){let l,u;if(this.performanceClient?.addQueueMeasurement(ts,e.correlation_id),e.id_token){if(l=zo(e.id_token||sn.EMPTY_STRING,this.cryptoObj.base64Decode),o&&o.nonce&&l.nonce!==o.nonce)throw Ho(oo);if(n.maxAge||0===n.maxAge){const e=l.auth_time;if(!e)throw Ho(io);Ko(e,n.maxAge)}}this.homeAccountIdentifier=ji.generateHomeAccountId(e.client_info||sn.EMPTY_STRING,t.authorityType,this.logger,this.cryptoObj,l),o&&o.state&&(u=yh.parseRequestState(this.cryptoObj,o.state)),e.key_id=e.key_id||n.sshKid||void 0;const d=this.generateCacheRecord(e,t,r,n,l,i,o);let h;try{if(this.persistencePlugin&&this.serializableCache&&(this.logger.verbose("Persistence enabled, calling beforeCacheAccess"),h=new bh(this.serializableCache,!0),await this.persistencePlugin.beforeCacheAccess(h)),a&&!s&&d.account){const e=d.account.generateAccountKey();if(!this.cacheStorage.getAccount(e,n.correlationId))return this.logger.warning("Account used to refresh tokens not in persistence, refreshed tokens will not be stored in the cache"),await Ch.generateAuthenticationResult(this.cryptoObj,t,d,!1,n,l,u,void 0,c)}await this.cacheStorage.saveCacheRecord(d,n.correlationId,n.storeInCache)}finally{this.persistencePlugin&&this.serializableCache&&h&&(this.logger.verbose("Persistence enabled, calling afterCacheAccess"),await this.persistencePlugin.afterCacheAccess(h))}return Ch.generateAuthenticationResult(this.cryptoObj,t,d,!1,n,l,u,e,c)}generateCacheRecord(e,t,r,n,o,i,a){const s=t.getPreferredCache();if(!s)throw Ho(Co);const c=Ui(o);let l,u;e.id_token&&o&&(l=Yo(this.homeAccountIdentifier,s,e.id_token,this.clientId,c||""),u=wh(this.cacheStorage,t,this.homeAccountIdentifier,this.cryptoObj.base64Decode,n.correlationId,o,e.client_info,s,c,a,void 0,this.logger));let d=null;if(e.access_token){const o=e.scope?Fi.fromString(e.scope):new Fi(n.scopes||[]),a=("string"==typeof e.expires_in?parseInt(e.expires_in,10):e.expires_in)||0,l=("string"==typeof e.ext_expires_in?parseInt(e.ext_expires_in,10):e.ext_expires_in)||0,u=("string"==typeof e.refresh_in?parseInt(e.refresh_in,10):e.refresh_in)||void 0,h=r+a,g=h+l,p=u&&u>0?r+u:void 0;d=Xo(this.homeAccountIdentifier,s,e.access_token,this.clientId,c||t.tenant||"",o.printScopes(),h,g,this.cryptoObj.base64Decode,p,e.token_type,i,e.key_id,n.claims,n.requestedClaimsHash)}let h=null;if(e.refresh_token){let t;e.refresh_token_expires_in&&(t=r+("string"==typeof e.refresh_token_expires_in?parseInt(e.refresh_token_expires_in,10):e.refresh_token_expires_in)),h=Zo(this.homeAccountIdentifier,s,e.refresh_token,this.clientId,e.foci,i,t)}let g=null;return e.foci&&(g={clientId:this.clientId,environment:s,familyId:e.foci}),{account:u,idToken:l,accessToken:d,refreshToken:h,appMetadata:g}}static async generateAuthenticationResult(e,t,r,n,o,i,a,s,c){let l,u,d=sn.EMPTY_STRING,h=[],g=null,p=sn.EMPTY_STRING;if(r.accessToken){if(r.accessToken.tokenType!==Fn.POP||o.popKid)d=r.accessToken.secret;else{const t=new vh(e),{secret:n,keyId:i}=r.accessToken;if(!i)throw Ho(Mo);d=await t.signPopToken(n,i,o)}h=Fi.fromString(r.accessToken.target).asArray(),g=Vo(r.accessToken.expiresOn),l=Vo(r.accessToken.extendedExpiresOn),r.accessToken.refreshOn&&(u=Vo(r.accessToken.refreshOn))}r.appMetadata&&(p=r.appMetadata.familyId===_n?_n:"");const f=i?.oid||i?.sub||"",m=i?.tid||"";s?.spa_accountid&&r.account&&(r.account.nativeAccountId=s?.spa_accountid);const y=r.account?Hi(r.account.getAccountInfo(),void 0,i,r.idToken?.secret):null;return{authority:t.canonicalAuthority,uniqueId:f,tenantId:m,scopes:h,account:y,idToken:r?.idToken?.secret||"",idTokenClaims:i||{},accessToken:d,fromCache:n,expiresOn:g,extExpiresOn:l,refreshOn:u,correlationId:o.correlationId,requestId:c||sn.EMPTY_STRING,familyId:p,tokenType:r.accessToken?.tokenType||sn.EMPTY_STRING,state:a?a.userRequestState:sn.EMPTY_STRING,cloudGraphHostName:r.account?.cloudGraphHostName||sn.EMPTY_STRING,msGraphHost:r.account?.msGraphHost||sn.EMPTY_STRING,code:s?.spa_code,fromNativeBroker:!1}}}function wh(e,t,r,n,o,i,a,s,c,l,u,d){d?.verbose("setCachedAccount called");const h=e.getAccountKeys().find(e=>e.startsWith(r));let g=null;h&&(g=e.getAccount(h,o));const p=g||ji.createAccount({homeAccountId:r,idTokenClaims:i,clientInfo:a,environment:s,cloudGraphHostName:l?.cloud_graph_host_name,msGraphHost:l?.msgraph_host,nativeAccountId:u},t,n),f=p.tenantProfiles||[],m=c||p.realm;if(m&&!f.find(e=>e.tenantId===m)){const e=Li(r,p.localAccountId,m,i);f.push(e)}return p.tenantProfiles=f,p}async function kh(e,t,r){return"string"==typeof e?e:e({clientId:t,tokenEndpoint:r})}class Ih extends mh{constructor(e,t){super(e,t),this.includeRedirectUri=!0,this.oidcDefaultScopes=this.config.authOptions.authority.options.OIDCOptions?.defaultScopes}async acquireToken(e,t){if(this.performanceClient?.addQueueMeasurement(Ja,e.correlationId),!e.code)throw Ho(uo);const r=Wo(),n=await Lu(this.executeTokenRequest.bind(this),Ya,this.logger,this.performanceClient,e.correlationId)(this.authority,e),o=n.headers?.[gn],i=new Ch(this.config.authOptions.clientId,this.cacheManager,this.cryptoUtils,this.logger,this.config.serializableCache,this.config.persistencePlugin,this.performanceClient);return i.validateTokenResponse(n.body),Lu(i.handleServerTokenResponse.bind(i),ts,this.logger,this.performanceClient,e.correlationId)(n.body,this.authority,r,e,t,void 0,void 0,void 0,o)}getLogoutUri(e){if(!e)throw Ni(vi);const t=this.createLogoutUrlQueryString(e);return Wi.appendQueryString(this.authority.endSessionEndpoint,t)}async executeTokenRequest(e,t){this.performanceClient?.addQueueMeasurement(Ya,t.correlationId);const r=this.createTokenQueryParameters(t),n=Wi.appendQueryString(e.tokenEndpoint,r),o=await Lu(this.createTokenRequestBody.bind(this),Xa,this.logger,this.performanceClient,t.correlationId)(t);let i;if(t.clientInfo)try{const e=Bi(t.clientInfo,this.cryptoUtils.base64Decode);i={credential:`${e.uid}.${e.utid}`,type:Rd}}catch(e){this.logger.verbose("Could not parse client info for CCS Header: "+e)}const a=this.createTokenRequestHeaders(i||t.ccsCredential),s=ed(this.config.authOptions.clientId,t);return Lu(this.executePostToTokenEndpoint.bind(this),wa,this.logger,this.performanceClient,t.correlationId)(n,o,a,s,t.correlationId,wa)}async createTokenRequestBody(e){this.performanceClient?.addQueueMeasurement(Xa,e.correlationId);const t=new Map;if(zd(t,e.embeddedClientId||e.tokenBodyParameters?.[Md]||this.config.authOptions.clientId),this.includeRedirectUri)Kd(t,e.redirectUri);else if(!e.redirectUri)throw Ni(ui);if($d(t,e.scopes,!0,this.oidcDefaultScopes),function(e,t){e.set("code",t)}(t,e.code),Xd(t,this.config.libraryInfo),Zd(t,this.config.telemetry.application),dh(t),this.serverTelemetryManager&&!Gs(this.config)&&uh(t,this.serverTelemetryManager),e.codeVerifier&&function(e,t){e.set("code_verifier",t)}(t,e.codeVerifier),this.config.clientCredentials.clientSecret&&th(t,this.config.clientCredentials.clientSecret),this.config.clientCredentials.clientAssertion){const r=this.config.clientCredentials.clientAssertion;rh(t,await kh(r.assertion,this.config.authOptions.clientId,e.resourceRequestUri)),nh(t,r.assertionType)}if(oh(t,"authorization_code"),ih(t),e.authenticationScheme===Fn.POP){const r=new vh(this.cryptoUtils,this.performanceClient);let n;n=e.popKid?this.cryptoUtils.encodeKid(e.popKid):(await Lu(r.generateCnf.bind(r),Za,this.logger,this.performanceClient,e.correlationId)(e,this.logger)).reqCnfString,ch(t,n)}else if(e.authenticationScheme===Fn.SSH){if(!e.sshJwk)throw Ni(Ai);lh(t,e.sshJwk)}let r;if((!xi.isEmptyObj(e.claims)||this.config.authOptions.clientCapabilities&&this.config.authOptions.clientCapabilities.length>0)&&Jd(t,e.claims,this.config.authOptions.clientCapabilities),e.clientInfo)try{const t=Bi(e.clientInfo,this.cryptoUtils.base64Decode);r={credential:`${t.uid}.${t.utid}`,type:Rd}}catch(e){this.logger.verbose("Could not parse client info for CCS Header: "+e)}else r=e.ccsCredential;if(this.config.systemOptions.preventCorsPreflight&&r)switch(r.type){case Rd:try{Vd(t,Di(r.credential))}catch(e){this.logger.verbose("Could not parse home account ID for CCS Header: "+e)}break;case Od:Gd(t,r.credential)}return e.embeddedClientId&&hh(t,this.config.authOptions.clientId,this.config.authOptions.redirectUri),e.tokenBodyParameters&&sh(t,e.tokenBodyParameters),!e.enableSpaAuthorizationCode||e.tokenBodyParameters&&e.tokenBodyParameters[Bd]||sh(t,{[Bd]:"1"}),Ud(t,e.correlationId,this.performanceClient),Ki(t)}createLogoutUrlQueryString(e){const t=new Map;return e.postLogoutRedirectUri&&function(e,t){e.set("post_logout_redirect_uri",t)}(t,e.postLogoutRedirectUri),e.correlationId&&Yd(t,e.correlationId),e.idTokenHint&&function(e,t){e.set("id_token_hint",t)}(t,e.idTokenHint),e.state&&eh(t,e.state),e.logoutHint&&function(e,t){e.set("logout_hint",t)}(t,e.logoutHint),e.extraQueryParameters&&sh(t,e.extraQueryParameters),this.config.authOptions.instanceAware&&ah(t),Ki(t,this.config.authOptions.encodeExtraQueryParams,e.extraQueryParameters)}}class Ah{constructor(e,t){this.cacheOutcome="0",this.cacheManager=t,this.apiId=e.apiId,this.correlationId=e.correlationId,this.wrapperSKU=e.wrapperSKU||sn.EMPTY_STRING,this.wrapperVer=e.wrapperVer||sn.EMPTY_STRING,this.telemetryCacheKey=xn.CACHE_KEY+Tn+e.clientId}generateCurrentRequestHeaderValue(){const e=`${this.apiId}${xn.VALUE_SEPARATOR}${this.cacheOutcome}`,t=[this.wrapperSKU,this.wrapperVer],r=this.getNativeBrokerErrorCode();r?.length&&t.push(`broker_error=${r}`);const n=t.join(xn.VALUE_SEPARATOR),o=[e,this.getRegionDiscoveryFields()].join(xn.VALUE_SEPARATOR);return[xn.SCHEMA_VERSION,o,n].join(xn.CATEGORY_SEPARATOR)}generateLastRequestHeaderValue(){const e=this.getLastRequests(),t=Ah.maxErrorsToSend(e),r=e.failedRequests.slice(0,2*t).join(xn.VALUE_SEPARATOR),n=e.errors.slice(0,t).join(xn.VALUE_SEPARATOR),o=e.errors.length,i=[o,t<o?xn.OVERFLOW_TRUE:xn.OVERFLOW_FALSE].join(xn.VALUE_SEPARATOR);return[xn.SCHEMA_VERSION,e.cacheHits,r,n,i].join(xn.CATEGORY_SEPARATOR)}cacheFailedRequest(e){const t=this.getLastRequests();t.errors.length>=xn.MAX_CACHED_ERRORS&&(t.failedRequests.shift(),t.failedRequests.shift(),t.errors.shift()),t.failedRequests.push(this.apiId,this.correlationId),e instanceof Error&&e&&e.toString()?e instanceof Kn?e.subError?t.errors.push(e.subError):e.errorCode?t.errors.push(e.errorCode):t.errors.push(e.toString()):t.errors.push(e.toString()):t.errors.push(xn.UNKNOWN_ERROR),this.cacheManager.setServerTelemetry(this.telemetryCacheKey,t,this.correlationId)}incrementCacheHits(){const e=this.getLastRequests();return e.cacheHits+=1,this.cacheManager.setServerTelemetry(this.telemetryCacheKey,e,this.correlationId),e.cacheHits}getLastRequests(){return this.cacheManager.getServerTelemetry(this.telemetryCacheKey)||{failedRequests:[],errors:[],cacheHits:0}}clearTelemetryCache(){const e=this.getLastRequests(),t=Ah.maxErrorsToSend(e);if(t===e.errors.length)this.cacheManager.removeItem(this.telemetryCacheKey,this.correlationId);else{const r={failedRequests:e.failedRequests.slice(2*t),errors:e.errors.slice(t),cacheHits:0};this.cacheManager.setServerTelemetry(this.telemetryCacheKey,r,this.correlationId)}}static maxErrorsToSend(e){let t,r=0,n=0;const o=e.errors.length;for(t=0;t<o;t++){const o=e.failedRequests[2*t]||sn.EMPTY_STRING,i=e.failedRequests[2*t+1]||sn.EMPTY_STRING,a=e.errors[t]||sn.EMPTY_STRING;if(n+=o.toString().length+i.toString().length+a.length+3,!(n<xn.MAX_LAST_HEADER_BYTES))break;r+=1}return r}getRegionDiscoveryFields(){const e=[];return e.push(this.regionUsed||sn.EMPTY_STRING),e.push(this.regionSource||sn.EMPTY_STRING),e.push(this.regionOutcome||sn.EMPTY_STRING),e.join(",")}updateRegionDiscoveryMetadata(e){this.regionUsed=e.region_used,this.regionSource=e.region_source,this.regionOutcome=e.region_outcome}setCacheOutcome(e){this.cacheOutcome=e}setNativeBrokerErrorCode(e){const t=this.getLastRequests();t.nativeBrokerErrorCode=e,this.cacheManager.setServerTelemetry(this.telemetryCacheKey,t,this.correlationId)}getNativeBrokerErrorCode(){return this.getLastRequests().nativeBrokerErrorCode}clearNativeBrokerErrorCode(){const e=this.getLastRequests();delete e.nativeBrokerErrorCode,this.cacheManager.setServerTelemetry(this.telemetryCacheKey,e,this.correlationId)}static makeExtraSkuString(e){return function(e){const{skus:t,libraryName:r,libraryVersion:n,extensionName:o,extensionVersion:i}=e,a=new Map([[0,[r,n]],[2,[o,i]]]);let s=[];if(t?.length){if(s=t.split(","),s.length<4)return t}else s=Array.from({length:4},()=>"|");return a.forEach((e,t)=>{2===e.length&&e[0]?.length&&e[1]?.length&&function(e){const{skuArr:t,index:r,skuName:n,skuVersion:o}=e;r>=t.length||(t[r]=[n,o].join("|"))}({skuArr:s,index:t,skuName:e[0],skuVersion:e[1]})}),s.join(",")}(e)}}class Th{constructor(e,t,r,n,o,i,a,s,c){this.config=e,this.browserStorage=t,this.browserCrypto=r,this.networkClient=this.config.system.networkClient,this.eventHandler=o,this.navigationClient=i,this.platformAuthProvider=s,this.correlationId=c||Zl(),this.logger=n.clone(Xs,Iu,this.correlationId),this.performanceClient=a}async clearCacheOnLogout(e,t){if(t){ji.accountInfoIsEqual(t,this.browserStorage.getActiveAccount(e),!1)&&(this.logger.verbose("Setting active account to null"),this.browserStorage.setActiveAccount(null,e));try{this.browserStorage.removeAccount(ji.generateAccountCacheKey(t),e),this.logger.verbose("Cleared cache items belonging to the account provided in the logout request.")}catch(e){this.logger.error("Account provided in logout request was not found. Local cache unchanged.")}}else try{this.logger.verbose("No account provided in logout request, clearing all cache items.",this.correlationId),this.browserStorage.clear(e),await this.browserCrypto.clearKeystore()}catch(e){this.logger.error("Attempted to clear all MSAL cache items and failed. Local cache unchanged.")}}getRedirectUri(e){this.logger.verbose("getRedirectUri called");const t=e||this.config.auth.redirectUri;return Wi.getAbsoluteUrl(t,yu())}initializeServerTelemetryManager(e,t){this.logger.verbose("initializeServerTelemetryManager called");const r={clientId:this.config.auth.clientId,correlationId:this.correlationId,apiId:e,forceRefresh:t||!1,wrapperSKU:this.browserStorage.getWrapperMetadata()[0],wrapperVer:this.browserStorage.getWrapperMetadata()[1]};return new Ah(r,this.browserStorage)}async getDiscoveredAuthority(e){const{account:t}=e,r=e.requestExtraQueryParameters&&e.requestExtraQueryParameters.hasOwnProperty("instance_aware")?e.requestExtraQueryParameters.instance_aware:void 0;this.performanceClient.addQueueMeasurement(ya,this.correlationId);const n={protocolMode:this.config.auth.protocolMode,OIDCOptions:this.config.auth.OIDCOptions,knownAuthorities:this.config.auth.knownAuthorities,cloudDiscoveryMetadata:this.config.auth.cloudDiscoveryMetadata,authorityMetadata:this.config.auth.authorityMetadata,skipAuthorityMetadataCache:this.config.auth.skipAuthorityMetadataCache},o=e.requestAuthority||this.config.auth.authority,i=r?.length?"true"===r:this.config.auth.instanceAware,a=t&&i?this.config.auth.authority.replace(Wi.getDomainFromUrl(o),t.environment):o,s=Uu.generateAuthority(a,e.requestAzureCloudOptions||this.config.auth.azureCloudOptions),c=await Lu(gh,ns,this.logger,this.performanceClient,this.correlationId)(s,this.config.system.networkClient,this.browserStorage,n,this.logger,this.correlationId,this.performanceClient);if(t&&!c.isAlias(t.environment))throw Ni(Ri);return c}}async function Sh(e,t,r,n){r.addQueueMeasurement(Oa,e.correlationId);const o=e.authority||t.auth.authority,i=[...e&&e.scopes||[]],a={...e,correlationId:e.correlationId,authority:o,scopes:i};if(a.authenticationScheme){if(a.authenticationScheme===Fn.SSH){if(!e.sshJwk)throw Ni(Ai);if(!e.sshKid)throw Ni(Ti)}n.verbose(`Authentication Scheme set to "${a.authenticationScheme}" as configured in Auth request`)}else a.authenticationScheme=Fn.BEARER,n.verbose('Authentication Scheme wasn\'t explicitly set in request, defaulting to "Bearer" request');return t.cache.claimsBasedCachingEnabled&&e.claims&&!xi.isEmptyObj(e.claims)&&(a.requestedClaimsHash=await cu(e.claims)),a}async function Eh(e,t,r,n,o){n.addQueueMeasurement(Ma,e.correlationId);const i=await Lu(Sh,Oa,o,n,e.correlationId)(e,r,n,o);return{...e,...i,account:t,forceRefresh:e.forceRefresh||!1}}class _h extends Th{initializeLogoutRequest(e){this.logger.verbose("initializeLogoutRequest called",e?.correlationId);const t={correlationId:this.correlationId||Zl(),...e};if(e)if(e.logoutHint)this.logger.verbose("logoutHint has already been set in logoutRequest");else if(e.account){const r=this.getLogoutHintFromIdTokenClaims(e.account);r&&(this.logger.verbose("Setting logoutHint to login_hint ID Token Claim value for the account provided"),t.logoutHint=r)}else this.logger.verbose("logoutHint was not set and account was not passed into logout request, logoutHint will not be set");else this.logger.verbose("logoutHint will not be set since no logout request was configured");return e&&null===e.postLogoutRedirectUri?this.logger.verbose("postLogoutRedirectUri passed as null, not setting post logout redirect uri",t.correlationId):e&&e.postLogoutRedirectUri?(this.logger.verbose("Setting postLogoutRedirectUri to uri set on logout request",t.correlationId),t.postLogoutRedirectUri=Wi.getAbsoluteUrl(e.postLogoutRedirectUri,yu())):null===this.config.auth.postLogoutRedirectUri?this.logger.verbose("postLogoutRedirectUri configured as null and no uri set on request, not passing post logout redirect",t.correlationId):this.config.auth.postLogoutRedirectUri?(this.logger.verbose("Setting postLogoutRedirectUri to configured uri",t.correlationId),t.postLogoutRedirectUri=Wi.getAbsoluteUrl(this.config.auth.postLogoutRedirectUri,yu())):(this.logger.verbose("Setting postLogoutRedirectUri to current page",t.correlationId),t.postLogoutRedirectUri=Wi.getAbsoluteUrl(yu(),yu())),t}getLogoutHintFromIdTokenClaims(e){const t=e.idTokenClaims;if(t){if(t.login_hint)return t.login_hint;this.logger.verbose("The ID Token Claims tied to the provided account do not contain a login_hint claim, logoutHint will not be added to logout request")}else this.logger.verbose("The provided account does not contain ID Token Claims, logoutHint will not be added to logout request");return null}async createAuthCodeClient(e){this.performanceClient.addQueueMeasurement(Ha,this.correlationId);const t=await Lu(this.getClientConfiguration.bind(this),Ua,this.logger,this.performanceClient,this.correlationId)(e);return new Ih(t,this.performanceClient)}async getClientConfiguration(e){const{serverTelemetryManager:t,requestAuthority:r,requestAzureCloudOptions:n,requestExtraQueryParameters:o,account:i}=e;this.performanceClient.addQueueMeasurement(Ua,this.correlationId);const a=await Lu(this.getDiscoveredAuthority.bind(this),ya,this.logger,this.performanceClient,this.correlationId)({requestAuthority:r,requestAzureCloudOptions:n,requestExtraQueryParameters:o,account:i}),s=this.config.system.loggerOptions;return{authOptions:{clientId:this.config.auth.clientId,authority:a,clientCapabilities:this.config.auth.clientCapabilities,redirectUri:this.config.auth.redirectUri},systemOptions:{tokenRenewalOffsetSeconds:this.config.system.tokenRenewalOffsetSeconds,preventCorsPreflight:!0},loggerOptions:{loggerCallback:s.loggerCallback,piiLoggingEnabled:s.piiLoggingEnabled,logLevel:s.logLevel,correlationId:this.correlationId},cacheOptions:{claimsBasedCachingEnabled:this.config.cache.claimsBasedCachingEnabled},cryptoInterface:this.browserCrypto,networkInterface:this.networkClient,storageInterface:this.browserStorage,serverTelemetryManager:t,libraryInfo:{sku:Xs,version:Iu,cpu:sn.EMPTY_STRING,os:sn.EMPTY_STRING},telemetry:this.config.telemetry}}async initializeAuthorizationRequest(e,t){this.performanceClient.addQueueMeasurement(ja,this.correlationId);const r=this.getRedirectUri(e.redirectUri),n={interactionType:t},o=yh.setRequestState(this.browserCrypto,e&&e.state||sn.EMPTY_STRING,n),i={...await Lu(Sh,Oa,this.logger,this.performanceClient,this.correlationId)({...e,correlationId:this.correlationId},this.config,this.performanceClient,this.logger),redirectUri:r,state:o,nonce:e.nonce||Zl(),responseMode:this.config.auth.OIDCOptions.serverResponseType};if(e.loginHint||e.sid)return i;const a=e.account||this.browserStorage.getActiveAccount(this.correlationId);return a&&(this.logger.verbose("Setting validated request account",this.correlationId),this.logger.verbosePii(`Setting validated request account: ${a.homeAccountId}`,this.correlationId),i.account=a),i}}function Ph(e,t,r){const n=zi(e);if(!n)throw $i(e)?(r.error(`A ${t} is present in the iframe but it does not contain known properties. It's likely that the ${t} has been replaced by code running on the redirectUri page.`),r.errorPii(`The ${t} detected is: ${e}`),Sl(Nc)):(r.error(`The request has returned to the redirectUri but a ${t} is not present. It's likely that the ${t} has been removed or the page has been redirected by code running on the redirectUri page.`),Sl(Oc));return n}function Rh(e,t,r,n){const o=Ki(t,r,n);return Wi.appendQueryString(e.authorizationEndpoint,o)}function Oh(e,t){if(!e.state||!t)throw e.state?Ho(no,"Cached State"):Ho(no,"Server State");let r,n;try{r=decodeURIComponent(e.state)}catch(t){throw Ho(to,e.state)}try{n=decodeURIComponent(t)}catch(t){throw Ho(to,e.state)}if(r!==n)throw Ho(ro);if(e.error||e.error_description||e.suberror){const t=function(e){const t="code=",r=e.error_uri?.lastIndexOf(t);return r&&r>=0?e.error_uri?.substring(r+5):void 0}(e);if(Xu(e.error,e.error_description,e.suberror))throw new Yu(e.error||"",e.error_description,e.suberror,e.timestamp||"",e.trace_id||"",e.correlation_id||"",e.claims||"",t);throw new ph(e.error||"",e.error_description,e.suberror,t)}}class Mh{constructor(e,t,r,n,o){this.authModule=e,this.browserStorage=t,this.authCodeRequest=r,this.logger=n,this.performanceClient=o}async handleCodeResponse(e,t){let r;this.performanceClient.addQueueMeasurement(Ka,t.correlationId);try{r=function(e,t){if(Oh(e,t),!e.code)throw Ho(Po);return e}(e,t.state)}catch(e){throw e instanceof ph&&e.subError===Lc?Sl(Lc):e}return Lu(this.handleCodeResponseFromServer.bind(this),za,this.logger,this.performanceClient,t.correlationId)(r,t)}async handleCodeResponseFromServer(e,t,r=!0){if(this.performanceClient.addQueueMeasurement(za,t.correlationId),this.logger.trace("InteractionHandler.handleCodeResponseFromServer called"),this.authCodeRequest.code=e.code,e.cloud_instance_host_name&&await Lu(this.authModule.updateAuthority.bind(this.authModule),Qa,this.logger,this.performanceClient,t.correlationId)(e.cloud_instance_host_name,t.correlationId),r&&(e.nonce=t.nonce||void 0),e.state=t.state,e.client_info)this.authCodeRequest.clientInfo=e.client_info;else{const e=this.createCcsCredentials(t);e&&(this.authCodeRequest.ccsCredential=e)}return await Lu(this.authModule.acquireToken.bind(this.authModule),Ja,this.logger,this.performanceClient,t.correlationId)(this.authCodeRequest,e)}createCcsCredentials(e){return e.account?{credential:e.account.homeAccountId,type:Rd}:e.loginHint?{credential:e.loginHint,type:Od}:null}}const Nh="user_switch",xh={[Nh]:"User attempted to switch accounts in the native broker, which is not allowed. All new accounts must sign-in through the standard web flow first, please try again."};class Fh extends Kn{constructor(e,t,r){super(e,t),Object.setPrototypeOf(this,Fh.prototype),this.name="NativeAuthError",this.ext=r}}function Bh(e){return!(!e.ext||!e.ext.status||"PERSISTENT_ERROR"!==e.ext.status&&"DISABLED"!==e.ext.status)||!(!e.ext||!e.ext.error||-2147186943!==e.ext.error)||"ContentError"===e.errorCode}function Dh(e,t,r){if(r&&r.status)switch(r.status){case"ACCOUNT_UNAVAILABLE":return Zu(zu);case"USER_INTERACTION_REQUIRED":return new Yu(e,t);case"USER_CANCEL":return Sl(Lc);case"NO_NETWORK":return Sl(tl);case"UX_NOT_ALLOWED":return Zu(Wu)}return new Fh(e,xh[e]||t,r)}class qh extends mh{constructor(e,t){super(e,t)}async acquireCachedToken(e){this.performanceClient?.addQueueMeasurement(_a,e.correlationId);let t="0";if(e.forceRefresh||!this.config.cacheOptions.claimsBasedCachingEnabled&&!xi.isEmptyObj(e.claims))throw this.setCacheOutcome("1",e.correlationId),Ho(So);if(!e.account)throw Ho(vo);const r=e.account.tenantId||function(e){const t=new Wi(e).getUrlComponents(),r=t.PathSegments.slice(-1)[0]?.toLowerCase();switch(r){case mn:case yn:case vn:return;default:return r}}(e.authority),n=this.cacheManager.getTokenKeys(),o=this.cacheManager.getAccessToken(e.account,e,n,r);if(!o)throw this.setCacheOutcome("2",e.correlationId),Ho(So);if(i=o.cachedAt,Number(i)>Wo()||Qo(o.expiresOn,this.config.systemOptions.tokenRenewalOffsetSeconds))throw this.setCacheOutcome("3",e.correlationId),Ho(So);var i;o.refreshOn&&Qo(o.refreshOn,0)&&(t="4");const a=e.authority||this.authority.getPreferredCache(),s={account:this.cacheManager.readAccountFromCache(e.account,e.correlationId),accessToken:o,idToken:this.cacheManager.getIdToken(e.account,e.correlationId,n,r,this.performanceClient),refreshToken:null,appMetadata:this.cacheManager.readAppMetadataFromCache(a)};return this.setCacheOutcome(t,e.correlationId),this.config.serverTelemetryManager&&this.config.serverTelemetryManager.incrementCacheHits(),[await Lu(this.generateResultFromCacheRecord.bind(this),Pa,this.logger,this.performanceClient,e.correlationId)(s,e),t]}setCacheOutcome(e,t){this.serverTelemetryManager?.setCacheOutcome(e),this.performanceClient?.addFields({cacheOutcome:e},t),"0"!==e&&this.logger.info(`Token refresh is required due to cache outcome: ${e}`)}async generateResultFromCacheRecord(e,t){let r;if(this.performanceClient?.addQueueMeasurement(Pa,t.correlationId),e.idToken&&(r=zo(e.idToken.secret,this.config.cryptoInterface.base64Decode)),t.maxAge||0===t.maxAge){const e=r?.auth_time;if(!e)throw Ho(io);Ko(e,t.maxAge)}return Ch.generateAuthenticationResult(this.cryptoUtils,this.authority,e,!0,t,r)}}class Lh extends _h{async acquireToken(e){this.performanceClient.addQueueMeasurement(ga,e.correlationId);const t=this.initializeServerTelemetryManager(61),r=await Lu(this.getClientConfiguration.bind(this),Ua,this.logger,this.performanceClient,this.correlationId)({serverTelemetryManager:t,requestAuthority:e.authority,requestAzureCloudOptions:e.azureCloudOptions,account:e.account}),n=new qh(r,this.performanceClient);this.logger.verbose("Silent auth client created");try{const t=(await Lu(n.acquireCachedToken.bind(n),_a,this.logger,this.performanceClient,e.correlationId)(e))[0];return this.performanceClient.addFields({fromCache:!0},e.correlationId),t}catch(e){throw e instanceof Tl&&e.errorCode===al&&this.logger.verbose("Signing keypair for bound access token not found. Refreshing bound access token and generating a new crypto keypair."),e}}logout(e){this.logger.verbose("logoutRedirect called");const t=this.initializeLogoutRequest(e);return this.clearCacheOnLogout(t.correlationId,t?.account)}}var Hh=r(64583).Promise;class Uh extends Th{constructor(e,t,r,n,o,i,a,s,c,l,u,d){super(e,t,r,n,o,i,s,c,d),this.apiId=a,this.accountId=l,this.platformAuthProvider=c,this.nativeStorageManager=u,this.silentCacheClient=new Lh(e,this.nativeStorageManager,r,n,o,i,s,c,d);const h=this.platformAuthProvider.getExtensionName();this.skus=Ah.makeExtraSkuString({libraryName:Xs,libraryVersion:Iu,extensionName:h,extensionVersion:this.platformAuthProvider.getExtensionVersion()})}addRequestSKUs(e){e.extraParameters={...e.extraParameters,[Dd]:this.skus}}async acquireToken(e,t){this.performanceClient.addQueueMeasurement(va,e.correlationId),this.logger.trace("NativeInteractionClient - acquireToken called.");const r=this.performanceClient.startMeasurement(va,e.correlationId),n=Wo(),o=this.initializeServerTelemetryManager(this.apiId);try{const i=await this.initializeNativeRequest(e);try{const e=await this.acquireTokensFromCache(this.accountId,i);return r.end({success:!0,isNativeBroker:!1,fromCache:!0}),e}catch(e){if(1===t)throw this.logger.info("MSAL internal Cache does not contain tokens, return error as per cache policy"),e;this.logger.info("MSAL internal Cache does not contain tokens, proceed to make a native call")}const a=await this.platformAuthProvider.sendMessage(i);return await this.handleNativeResponse(a,i,n).then(e=>(r.end({success:!0,isNativeBroker:!0,requestId:e.requestId}),o.clearNativeBrokerErrorCode(),e)).catch(e=>{throw r.end({success:!1,errorCode:e.errorCode,subErrorCode:e.subError,isNativeBroker:!0}),e})}catch(e){throw e instanceof Fh&&o.setNativeBrokerErrorCode(e.errorCode),e}}createSilentCacheRequest(e,t){return{authority:e.authority,correlationId:this.correlationId,scopes:Fi.fromString(e.scope).asArray(),account:t,forceRefresh:!1}}async acquireTokensFromCache(e,t){if(!e)throw this.logger.warning("NativeInteractionClient:acquireTokensFromCache - No nativeAccountId provided"),Ho(wo);const r=this.browserStorage.getBaseAccountInfo({nativeAccountId:e},this.correlationId);if(!r)throw Ho(wo);try{const e=this.createSilentCacheRequest(t,r),n=await this.silentCacheClient.acquireToken(e),o={...r,idTokenClaims:n?.idTokenClaims,idToken:n?.idToken};return{...n,account:o}}catch(e){throw e}}async acquireTokenRedirect(e,t){this.logger.trace("NativeInteractionClient - acquireTokenRedirect called.");const{...r}=e;delete r.onRedirectNavigate;const n=await this.initializeNativeRequest(r);try{await this.platformAuthProvider.sendMessage(n)}catch(e){if(e instanceof Fh&&(this.initializeServerTelemetryManager(this.apiId).setNativeBrokerErrorCode(e.errorCode),Bh(e)))throw e}this.browserStorage.setTemporaryCache(gc,JSON.stringify(n),!0);const o={apiId:bc,timeout:this.config.system.redirectNavigationTimeout,noHistory:!1},i=this.config.auth.navigateToLoginRequestUrl?window.location.href:this.getRedirectUri(e.redirectUri);t.end({success:!0}),await this.navigationClient.navigateExternal(i,o)}async handleRedirectPromise(e,t){if(this.logger.trace("NativeInteractionClient - handleRedirectPromise called."),!this.browserStorage.isInteractionInProgress(!0))return this.logger.info("handleRedirectPromise called but there is no interaction in progress, returning null."),null;const r=this.browserStorage.getCachedNativeRequest();if(!r)return this.logger.verbose("NativeInteractionClient - handleRedirectPromise called but there is no cached request, returning null."),e&&t&&e?.addFields({errorCode:"no_cached_request"},t),null;const{prompt:n,...o}=r;n&&this.logger.verbose("NativeInteractionClient - handleRedirectPromise called and prompt was included in the original request, removing prompt from cached request to prevent second interaction with native broker window."),this.browserStorage.removeItem(this.browserStorage.generateCacheKey(gc));const i=Wo();try{this.logger.verbose("NativeInteractionClient - handleRedirectPromise sending message to native broker.");const e=await this.platformAuthProvider.sendMessage(o),t=await this.handleNativeResponse(e,o,i);return this.initializeServerTelemetryManager(this.apiId).clearNativeBrokerErrorCode(),t}catch(e){throw e}}logout(){return this.logger.trace("NativeInteractionClient - logout called."),Hh.reject("Logout not implemented yet")}async handleNativeResponse(e,t,r){this.logger.trace("NativeInteractionClient - handleNativeResponse called.");const n=zo(e.id_token,ql),o=this.createHomeAccountIdentifier(e,n),i=this.browserStorage.getAccountInfoFilteredBy({nativeAccountId:t.accountId},this.correlationId)?.homeAccountId;if(t.extraParameters?.child_client_id&&e.account.id!==t.accountId)this.logger.info("handleNativeServerResponse: Double broker flow detected, ignoring accountId mismatch");else if(o!==i&&e.account.id!==t.accountId)throw Dh(Nh);const a=await this.getDiscoveredAuthority({requestAuthority:t.authority}),s=wh(this.browserStorage,a,o,ql,this.correlationId,n,e.client_info,void 0,n.tid,void 0,e.account.id,this.logger);e.expires_in=Number(e.expires_in);const c=await this.generateAuthenticationResult(e,t,n,s,a.canonicalAuthority,r);return await this.cacheAccount(s,this.correlationId),await this.cacheNativeTokens(e,t,o,n,e.access_token,c.tenantId,r),c}createHomeAccountIdentifier(e,t){return ji.generateHomeAccountId(e.client_info||sn.EMPTY_STRING,0,this.logger,this.browserCrypto,t)}generateScopes(e,t){return t?Fi.fromString(t):Fi.fromString(e)}async generatePopAccessToken(e,t){if(t.tokenType===Fn.POP&&t.signPopToken){if(e.shr)return this.logger.trace("handleNativeServerResponse: SHR is enabled in native layer"),e.shr;const r=new vh(this.browserCrypto),n={resourceRequestMethod:t.resourceRequestMethod,resourceRequestUri:t.resourceRequestUri,shrClaims:t.shrClaims,shrNonce:t.shrNonce};if(!t.keyId)throw Ho(Mo);return r.signPopToken(e.access_token,t.keyId,n)}return e.access_token}async generateAuthenticationResult(e,t,r,n,o,i){const a=this.addTelemetryFromNativeResponse(e.properties.MATS),s=this.generateScopes(t.scope,e.scope),c=e.account.properties||{},l=c.UID||r.oid||r.sub||sn.EMPTY_STRING,u=c.TenantId||r.tid||sn.EMPTY_STRING,d=Hi(n.getAccountInfo(),void 0,r,e.id_token);d.nativeAccountId!==e.account.id&&(d.nativeAccountId=e.account.id);const h=await this.generatePopAccessToken(e,t),g=t.tokenType===Fn.POP?Fn.POP:Fn.BEARER;return{authority:o,uniqueId:l,tenantId:u,scopes:s.asArray(),account:d,idToken:e.id_token,idTokenClaims:r,accessToken:h,fromCache:!!a&&this.isResponseFromCache(a),expiresOn:Vo(i+e.expires_in),tokenType:g,correlationId:this.correlationId,state:e.state,fromNativeBroker:!0}}async cacheAccount(e,t){await this.browserStorage.setAccount(e,this.correlationId),this.browserStorage.removeAccountContext(e,t)}cacheNativeTokens(e,t,r,n,o,i,a){const s=Yo(r,t.authority,e.id_token||"",t.clientId,n.tid||""),c=a+(t.tokenType===Fn.POP?sn.SHR_NONCE_VALIDITY:("string"==typeof e.expires_in?parseInt(e.expires_in,10):e.expires_in)||0),l=this.generateScopes(e.scope,t.scope),u={idToken:s,accessToken:Xo(r,t.authority,o,t.clientId,n.tid||i,l.printScopes(),c,0,ql,void 0,t.tokenType,void 0,t.keyId)};return this.nativeStorageManager.saveCacheRecord(u,this.correlationId,t.storeInCache)}getExpiresInValue(e,t){return e===Fn.POP?sn.SHR_NONCE_VALIDITY:("string"==typeof t?parseInt(t,10):t)||0}addTelemetryFromNativeResponse(e){const t=this.getMATSFromResponse(e);return t?(this.performanceClient.addFields({extensionId:this.platformAuthProvider.getExtensionId(),extensionVersion:this.platformAuthProvider.getExtensionVersion(),matsBrokerVersion:t.broker_version,matsAccountJoinOnStart:t.account_join_on_start,matsAccountJoinOnEnd:t.account_join_on_end,matsDeviceJoin:t.device_join,matsPromptBehavior:t.prompt_behavior,matsApiErrorCode:t.api_error_code,matsUiVisible:t.ui_visible,matsSilentCode:t.silent_code,matsSilentBiSubCode:t.silent_bi_sub_code,matsSilentMessage:t.silent_message,matsSilentStatus:t.silent_status,matsHttpStatus:t.http_status,matsHttpEventCount:t.http_event_count},this.correlationId),t):null}getMATSFromResponse(e){if(e)try{return JSON.parse(e)}catch(e){this.logger.error("NativeInteractionClient - Error parsing MATS telemetry, returning null instead")}return null}isResponseFromCache(e){return void 0===e.is_cached?(this.logger.verbose("NativeInteractionClient - MATS telemetry does not contain field indicating if response was served from cache. Returning false."),!1):!!e.is_cached}async initializeNativeRequest(e){this.logger.trace("NativeInteractionClient - initializeNativeRequest called");const t=await this.getCanonicalAuthority(e),{scopes:r,...n}=e,o=new Fi(r||[]);o.appendScopes(cn);const i={...n,accountId:this.accountId,clientId:this.config.auth.clientId,authority:t.urlString,scope:o.printScopes(),redirectUri:this.getRedirectUri(e.redirectUri),prompt:this.getPrompt(e.prompt),correlationId:this.correlationId,tokenType:e.authenticationScheme,windowTitleSubstring:document.title,extraParameters:{...e.extraQueryParameters,...e.tokenQueryParameters},extendedExpiryToken:!1,keyId:e.popKid};if(i.signPopToken&&e.popKid)throw Sl(vl);if(this.handleExtraBrokerParams(i),i.extraParameters=i.extraParameters||{},i.extraParameters.telemetry="MATS",e.authenticationScheme===Fn.POP){const t={resourceRequestUri:e.resourceRequestUri,resourceRequestMethod:e.resourceRequestMethod,shrClaims:e.shrClaims,shrNonce:e.shrNonce},r=new vh(this.browserCrypto);let n;if(i.keyId)n=this.browserCrypto.base64UrlEncode(JSON.stringify({kid:i.keyId})),i.signPopToken=!1;else{const o=await Lu(r.generateCnf.bind(r),Za,this.logger,this.performanceClient,e.correlationId)(t,this.logger);n=o.reqCnfString,i.keyId=o.kid,i.signPopToken=!0}i.reqCnf=n}return this.addRequestSKUs(i),i}async getCanonicalAuthority(e){const t=e.authority||this.config.auth.authority;e.account&&await this.getDiscoveredAuthority({requestAuthority:t,requestAzureCloudOptions:e.azureCloudOptions,account:e.account});const r=new Wi(t);return r.validateAsUri(),r}getPrompt(e){switch(this.apiId){case 863:case 61:return this.logger.trace("initializeNativeRequest: silent request sets prompt to none"),kn}if(e)switch(e){case kn:case wn:case Cn:return this.logger.trace("initializeNativeRequest: prompt is compatible with native flow"),e;default:throw this.logger.trace(`initializeNativeRequest: prompt = ${e} is not compatible with native flow`),Sl(ml)}else this.logger.trace("initializeNativeRequest: prompt was not provided")}handleExtraBrokerParams(e){const t=e.extraParameters&&e.extraParameters.hasOwnProperty(qd)&&e.extraParameters.hasOwnProperty(Ld)&&e.extraParameters.hasOwnProperty(Md);if(!e.embeddedClientId&&!t)return;let r="";const n=e.redirectUri;e.embeddedClientId?(e.redirectUri=this.config.auth.redirectUri,r=e.embeddedClientId):e.extraParameters&&(e.redirectUri=e.extraParameters[Ld],r=e.extraParameters[Md]),e.extraParameters={child_client_id:r,child_redirect_uri:n},this.performanceClient?.addFields({embeddedClientId:r,embeddedRedirectUri:n},e.correlationId)}}async function jh(e,t,r,n,o){const i=function(e,t,r,n){const o=t.correlationId,i=new Map;if(zd(i,t.embeddedClientId||t.extraQueryParameters?.[Md]||e.clientId),$d(i,[...t.scopes||[],...t.extraScopesToConsent||[]],!0,e.authority.options.OIDCOptions?.defaultScopes),Kd(i,t.redirectUri),Yd(i,o),function(e,t){e.set("response_mode",t||"query")}(i,t.responseMode),ih(i),t.prompt&&(function(e,t){e.set("prompt",t)}(i,t.prompt),n?.addFields({prompt:t.prompt},o)),t.domainHint&&(function(e,t){e.set("domain_hint",t)}(i,t.domainHint),n?.addFields({domainHintFromRequest:!0},o)),"select_account"!==t.prompt)if(t.sid&&t.prompt===kn)r.verbose("createAuthCodeUrlQueryString: Prompt is none, adding sid from request"),Qd(i,t.sid),n?.addFields({sidFromRequest:!0},o);else if(t.account){const e=(a=t.account,a.idTokenClaims?.sid||null);let s=function(e){return e.idTokenClaims?.login_hint||null}(t.account);if(s&&t.domainHint&&(r.warning('AuthorizationCodeClient.createAuthCodeUrlQueryString: "domainHint" param is set, skipping opaque "login_hint" claim. Please consider not passing domainHint'),s=null),s){r.verbose("createAuthCodeUrlQueryString: login_hint claim present on account"),Wd(i,s),n?.addFields({loginHintFromClaim:!0},o);try{Vd(i,Di(t.account.homeAccountId))}catch(e){r.verbose("createAuthCodeUrlQueryString: Could not parse home account ID for CCS Header")}}else if(e&&t.prompt===kn){r.verbose("createAuthCodeUrlQueryString: Prompt is none, adding sid from account"),Qd(i,e),n?.addFields({sidFromClaim:!0},o);try{Vd(i,Di(t.account.homeAccountId))}catch(e){r.verbose("createAuthCodeUrlQueryString: Could not parse home account ID for CCS Header")}}else if(t.loginHint)r.verbose("createAuthCodeUrlQueryString: Adding login_hint from request"),Wd(i,t.loginHint),Gd(i,t.loginHint),n?.addFields({loginHintFromRequest:!0},o);else if(t.account.username){r.verbose("createAuthCodeUrlQueryString: Adding login_hint from account"),Wd(i,t.account.username),n?.addFields({loginHintFromUpn:!0},o);try{Vd(i,Di(t.account.homeAccountId))}catch(e){r.verbose("createAuthCodeUrlQueryString: Could not parse home account ID for CCS Header")}}}else t.loginHint&&(r.verbose("createAuthCodeUrlQueryString: No account, adding login_hint from request"),Wd(i,t.loginHint),Gd(i,t.loginHint),n?.addFields({loginHintFromRequest:!0},o));else r.verbose("createAuthCodeUrlQueryString: Prompt is select_account, ignoring account hints");var a;return t.nonce&&function(e,t){e.set("nonce",t)}(i,t.nonce),t.state&&eh(i,t.state),(t.claims||e.clientCapabilities&&e.clientCapabilities.length>0)&&Jd(i,t.claims,e.clientCapabilities),t.embeddedClientId&&hh(i,e.clientId,e.redirectUri),!e.instanceAware||t.extraQueryParameters&&Object.keys(t.extraQueryParameters).includes(Hd)||ah(i),i}({...e.auth,authority:t},r,n,o);if(Xd(i,{sku:Xs,version:Iu,os:"",cpu:""}),e.auth.protocolMode!==Ln&&Zd(i,e.telemetry.application),r.platformBroker&&(function(e){e.set("nativebroker","1")}(i),r.authenticationScheme===Fn.POP)){const e=new Bu(n,o),t=new vh(e);let a;a=r.popKid?e.encodeKid(r.popKid):(await Lu(t.generateCnf.bind(t),Za,n,o,r.correlationId)(r,n)).reqCnfString,ch(i,a)}return Ud(i,r.correlationId,o),i}async function $h(e,t,r,n,o){if(!r.codeChallenge)throw Ni(Ci);const i=await Lu(jh,"getStandardParams",n,o,r.correlationId)(e,t,r,n,o);return jd(i,"code"),function(e,t,r){if(!t||!r)throw Ni(Ci);e.set("code_challenge",t),e.set("code_challenge_method",r)}(i,r.codeChallenge,sn.S256_CODE_CHALLENGE_METHOD),sh(i,r.extraQueryParameters||{}),Rh(t,i,e.auth.encodeExtraQueryParams,r.extraQueryParameters)}async function zh(e,t,r,n,o,i){if(!n.earJwk)throw Sl(Ec);const a=await jh(t,r,n,o,i);jd(a,"id_token token refresh_token"),function(e,t){e.set("ear_jwk",encodeURIComponent(t)),e.set("ear_jwe_crypto","eyJhbGciOiJkaXIiLCJlbmMiOiJBMjU2R0NNIn0")}(a,n.earJwk);const s=new Map;return sh(s,n.extraQueryParameters||{}),function(e,t,r){const n=e.createElement("form");return n.method="post",n.action=t,r.forEach((t,r)=>{const o=e.createElement("input");o.hidden=!0,o.name=r,o.value=t,n.appendChild(o)}),e.body.appendChild(n),n}(e,Rh(r,s,t.auth.encodeExtraQueryParams,n.extraQueryParameters),a)}async function Kh(e,t,r,n,o,i,a,s,c,l){if(s.verbose("Account id found, calling WAM for token"),!l)throw Sl(pl);const u=new Bu(s,c),d=new Uh(n,o,u,s,a,n.system.navigationClient,r,c,l,t,i,e.correlationId),{userRequestState:h}=yh.parseRequestState(u,e.state);return Lu(d.acquireToken.bind(d),va,s,c,e.correlationId)({...e,state:h,prompt:void 0})}async function Wh(e,t,r,n,o,i,a,s,c,l,u,d){if(fh.removeThrottle(a,o.auth.clientId,e),t.accountId)return Lu(Kh,Ga,l,u,e.correlationId)(e,t.accountId,n,o,a,s,c,l,u,d);const h={...e,code:t.code||"",codeVerifier:r},g=new Mh(i,a,h,l,u);return await Lu(g.handleCodeResponse.bind(g),Ka,l,u,e.correlationId)(t,e)}async function Gh(e,t,r,n,o,i,a,s,c,l,u){if(fh.removeThrottle(i,n.auth.clientId,e),Oh(t,e.state),!t.ear_jwe)throw Sl(_c);if(!e.earJwk)throw Sl(Ec);const d=JSON.parse(await Lu(ru,Fs,c,l,e.correlationId)(e.earJwk,t.ear_jwe));if(d.accountId)return Lu(Kh,Ga,c,l,e.correlationId)(e,d.accountId,r,n,i,a,s,c,l,u);const h=new Ch(n.auth.clientId,i,new Bu(c,l),c,null,null,l);h.validateTokenResponse(d);const g={code:"",state:e.state,nonce:e.nonce,client_info:d.client_info,cloud_graph_host_name:d.cloud_graph_host_name,cloud_instance_host_name:d.cloud_instance_host_name,cloud_instance_name:d.cloud_instance_name,msgraph_host:d.msgraph_host};return await Lu(h.handleServerTokenResponse.bind(h),ts,c,l,e.correlationId)(d,o,Wo(),e,g,void 0,void 0,void 0,void 0)}async function Vh(e,t,r){e.addQueueMeasurement(Is,r);const n=qu(Qh,As,t,e,r)(e,t,r);return{verifier:n,challenge:await Lu(Jh,Ts,t,e,r)(n,e,t,r)}}function Qh(e,t,r){try{const n=new Uint8Array(32);return qu(Yl,Es,t,e,r)(n),Fl(n)}catch(e){throw Sl(Sc)}}async function Jh(e,t,r,n){t.addQueueMeasurement(Ts,n);try{const o=await Lu(Jl,Ss,r,t,n)(e,t,n);return Fl(new Uint8Array(o))}catch(e){throw Sl(Sc)}}var Yh=r(64583).Promise;class Xh{constructor(e,t,r,n){this.logger=e,this.handshakeTimeoutMs=t,this.extensionId=n,this.resolvers=new Map,this.handshakeResolvers=new Map,this.messageChannel=new MessageChannel,this.windowListener=this.onWindowMessage.bind(this),this.performanceClient=r,this.handshakeEvent=r.startMeasurement(ms),this.platformAuthType="PlatformAuthExtensionHandler"}async sendMessage(e){this.logger.trace(this.platformAuthType+" - sendMessage called.");const t={method:"GetToken",request:e},r={channel:Zs,extensionId:this.extensionId,responseId:Zl(),body:t};this.logger.trace(this.platformAuthType+" - Sending request to browser extension"),this.logger.tracePii(this.platformAuthType+` - Sending request to browser extension: ${JSON.stringify(r)}`),this.messageChannel.port1.postMessage(r);const n=await new Yh((e,t)=>{this.resolvers.set(r.responseId,{resolve:e,reject:t})});return this.validatePlatformBrokerResponse(n)}static async createProvider(e,t,r){e.trace("PlatformAuthExtensionHandler - createProvider called.");try{const n=new Xh(e,t,r,ec);return await n.sendHandshakeRequest(),n}catch(n){const o=new Xh(e,t,r);return await o.sendHandshakeRequest(),o}}async sendHandshakeRequest(){this.logger.trace(this.platformAuthType+" - sendHandshakeRequest called."),window.addEventListener("message",this.windowListener,!1);const e={channel:Zs,extensionId:this.extensionId,responseId:Zl(),body:{method:rc}};return this.handshakeEvent.add({extensionId:this.extensionId,extensionHandshakeTimeoutMs:this.handshakeTimeoutMs}),this.messageChannel.port1.onmessage=e=>{this.onChannelMessage(e)},window.postMessage(e,window.origin,[this.messageChannel.port2]),new Yh((t,r)=>{this.handshakeResolvers.set(e.responseId,{resolve:t,reject:r}),this.timeoutId=window.setTimeout(()=>{window.removeEventListener("message",this.windowListener,!1),this.messageChannel.port1.close(),this.messageChannel.port2.close(),this.handshakeEvent.end({extensionHandshakeTimedOut:!0,success:!1}),r(Sl(hl)),this.handshakeResolvers.delete(e.responseId)},this.handshakeTimeoutMs)})}onWindowMessage(e){if(this.logger.trace(this.platformAuthType+" - onWindowMessage called"),e.source!==window)return;const t=e.data;if(t.channel&&t.channel===Zs&&(!t.extensionId||t.extensionId===this.extensionId)&&t.body.method===rc){const e=this.handshakeResolvers.get(t.responseId);if(!e)return void this.logger.trace(this.platformAuthType+`.onWindowMessage - resolver can't be found for request ${t.responseId}`);this.logger.verbose(t.extensionId?`Extension with id: ${t.extensionId} not installed`:"No extension installed"),clearTimeout(this.timeoutId),this.messageChannel.port1.close(),this.messageChannel.port2.close(),window.removeEventListener("message",this.windowListener,!1),this.handshakeEvent.end({success:!1,extensionInstalled:!1}),e.reject(Sl(gl))}}onChannelMessage(e){this.logger.trace(this.platformAuthType+" - onChannelMessage called.");const t=e.data,r=this.resolvers.get(t.responseId),n=this.handshakeResolvers.get(t.responseId);try{const e=t.body.method;if("Response"===e){if(!r)return;const e=t.body.response;if(this.logger.trace(this.platformAuthType+" - Received response from browser extension"),this.logger.tracePii(this.platformAuthType+` - Received response from browser extension: ${JSON.stringify(e)}`),"Success"!==e.status)r.reject(Dh(e.code,e.description,e.ext));else{if(!e.result)throw Wn(jn,"Event does not contain result.");e.result.code&&e.result.description?r.reject(Dh(e.result.code,e.result.description,e.result.ext)):r.resolve(e.result)}this.resolvers.delete(t.responseId)}else if("HandshakeResponse"===e){if(!n)return void this.logger.trace(this.platformAuthType+`.onChannelMessage - resolver can't be found for request ${t.responseId}`);clearTimeout(this.timeoutId),window.removeEventListener("message",this.windowListener,!1),this.extensionId=t.extensionId,this.extensionVersion=t.body.version,this.logger.verbose(this.platformAuthType+` - Received HandshakeResponse from extension: ${this.extensionId}`),this.handshakeEvent.end({extensionInstalled:!0,success:!0}),n.resolve(),this.handshakeResolvers.delete(t.responseId)}}catch(t){this.logger.error("Error parsing response from WAM Extension"),this.logger.errorPii(`Error parsing response from WAM Extension: ${t}`),this.logger.errorPii(`Unable to parse ${e}`),r?r.reject(t):n&&n.reject(t)}}validatePlatformBrokerResponse(e){if(e.hasOwnProperty("access_token")&&e.hasOwnProperty("id_token")&&e.hasOwnProperty("client_info")&&e.hasOwnProperty("account")&&e.hasOwnProperty("scope")&&e.hasOwnProperty("expires_in"))return e;throw Wn(jn,"Response missing expected properties.")}getExtensionId(){return this.extensionId}getExtensionVersion(){return this.extensionVersion}getExtensionName(){return this.getExtensionId()===ec?"chrome":this.getExtensionId()?.length?"unknown":void 0}}class Zh{constructor(e,t,r){this.logger=e,this.performanceClient=t,this.correlationId=r,this.platformAuthType="PlatformAuthDOMHandler"}static async createProvider(e,t,r){if(e.trace("PlatformAuthDOMHandler: createProvider called"),window.navigator?.platformAuthentication){const n=await window.navigator.platformAuthentication.getSupportedContracts(tc);if(n?.includes("get-token-and-sign-out"))return e.trace("Platform auth api available in DOM"),new Zh(e,t,r)}}getExtensionId(){return tc}getExtensionVersion(){return""}getExtensionName(){return"DOM API"}async sendMessage(e){this.logger.trace(this.platformAuthType+" - Sending request to browser DOM API");try{const t=this.initializePlatformDOMRequest(e),r=await window.navigator.platformAuthentication.executeGetToken(t);return this.validatePlatformBrokerResponse(r)}catch(e){throw this.logger.error(this.platformAuthType+" - executeGetToken DOM API error"),e}}initializePlatformDOMRequest(e){this.logger.trace(this.platformAuthType+" - initializeNativeDOMRequest called");const{accountId:t,clientId:r,authority:n,scope:o,redirectUri:i,correlationId:a,state:s,storeInCache:c,embeddedClientId:l,extraParameters:u,...d}=e,h=this.getDOMExtraParams(d);return{accountId:t,brokerId:this.getExtensionId(),authority:n,clientId:r,correlationId:a||this.correlationId,extraParameters:{...u,...h},isSecurityTokenService:!1,redirectUri:i,scope:o,state:s,storeInCache:c,embeddedClientId:l}}validatePlatformBrokerResponse(e){if(e.hasOwnProperty("isSuccess")){if(e.hasOwnProperty("accessToken")&&e.hasOwnProperty("idToken")&&e.hasOwnProperty("clientInfo")&&e.hasOwnProperty("account")&&e.hasOwnProperty("scopes")&&e.hasOwnProperty("expiresIn"))return this.logger.trace(this.platformAuthType+" - platform broker returned successful and valid response"),this.convertToPlatformBrokerResponse(e);if(e.hasOwnProperty("error")){const t=e;if(!1===t.isSuccess&&t.error&&t.error.code)throw this.logger.trace(this.platformAuthType+" - platform broker returned error response"),Dh(t.error.code,t.error.description,{error:parseInt(t.error.errorCode),protocol_error:t.error.protocolError,status:t.error.status,properties:t.error.properties})}}throw Wn(jn,"Response missing expected properties.")}convertToPlatformBrokerResponse(e){return this.logger.trace(this.platformAuthType+" - convertToNativeResponse called"),{access_token:e.accessToken,id_token:e.idToken,client_info:e.clientInfo,account:e.account,expires_in:e.expiresIn,scope:e.scopes,state:e.state||"",properties:e.properties||{},extendedLifetimeToken:e.extendedLifetimeToken??!1,shr:e.proofOfPossessionPayload}}getDOMExtraParams(e){return{...Object.entries(e).reduce((e,[t,r])=>(e[t]=String(r),e),{})}}}function eg(e,t,r,n){if(t.trace("isPlatformAuthAllowed called"),!e.system.allowPlatformBroker)return t.trace("isPlatformAuthAllowed: allowPlatformBroker is not enabled, returning false"),!1;if(!r)return t.trace("isPlatformAuthAllowed: Platform auth provider is not initialized, returning false"),!1;if(n)switch(n){case Fn.BEARER:case Fn.POP:return t.trace("isPlatformAuthAllowed: authenticationScheme is supported, returning true"),!0;default:return t.trace("isPlatformAuthAllowed: authenticationScheme is not supported, returning false"),!1}return!0}var tg=r(64583).Promise;class rg extends _h{constructor(e,t,r,n,o,i,a,s,c,l){super(e,t,r,n,o,i,a,c,l),this.unloadWindow=this.unloadWindow.bind(this),this.nativeStorage=s,this.eventHandler=o}acquireToken(e,t){try{const r={popupName:this.generatePopupName(e.scopes||cn,e.authority||this.config.auth.authority),popupWindowAttributes:e.popupWindowAttributes||{},popupWindowParent:e.popupWindowParent??window};return this.performanceClient.addFields({isAsyncPopup:this.config.system.asyncPopups},this.correlationId),this.config.system.asyncPopups?(this.logger.verbose("asyncPopups set to true, acquiring token"),this.acquireTokenPopupAsync(e,r,t)):(this.logger.verbose("asyncPopup set to false, opening popup before acquiring token"),r.popup=this.openSizedPopup("about:blank",r),this.acquireTokenPopupAsync(e,r,t))}catch(e){return tg.reject(e)}}logout(e){try{this.logger.verbose("logoutPopup called");const t=this.initializeLogoutRequest(e),r={popupName:this.generateLogoutPopupName(t),popupWindowAttributes:e?.popupWindowAttributes||{},popupWindowParent:e?.popupWindowParent??window},n=e&&e.authority,o=e&&e.mainWindowRedirectUri;return this.config.system.asyncPopups?(this.logger.verbose("asyncPopups set to true"),this.logoutPopupAsync(t,r,n,o)):(this.logger.verbose("asyncPopup set to false, opening popup"),r.popup=this.openSizedPopup("about:blank",r),this.logoutPopupAsync(t,r,n,o))}catch(e){return tg.reject(e)}}async acquireTokenPopupAsync(e,t,r){this.logger.verbose("acquireTokenPopupAsync called");const n=await Lu(this.initializeAuthorizationRequest.bind(this),ja,this.logger,this.performanceClient,this.correlationId)(e,wc.Popup);t.popup&&ku(n.authority);const o=eg(this.config,this.logger,this.platformAuthProvider,e.authenticationScheme);return n.platformBroker=o,this.config.auth.protocolMode===Hn?this.executeEarFlow(n,t):this.executeCodeFlow(n,t,r)}async executeCodeFlow(e,t,r){const n=e.correlationId,o=this.initializeServerTelemetryManager(Cc),i=r||await Lu(Vh,Is,this.logger,this.performanceClient,n)(this.performanceClient,this.logger,n),a={...e,codeChallenge:i.challenge};try{const r=await Lu(this.createAuthCodeClient.bind(this),Ha,this.logger,this.performanceClient,n)({serverTelemetryManager:o,requestAuthority:a.authority,requestAzureCloudOptions:a.azureCloudOptions,requestExtraQueryParameters:a.extraQueryParameters,account:a.account}),s=await Lu($h,$a,this.logger,this.performanceClient,n)(this.config,r.authority,a,this.logger,this.performanceClient),c=this.initiateAuthRequest(s,t);this.eventHandler.emitEvent(kd,wc.Popup,{popupWindow:c},null);const l=await this.monitorPopupForHash(c,t.popupWindowParent),u=qu(Ph,rs,this.logger,this.performanceClient,this.correlationId)(l,this.config.auth.OIDCOptions.serverResponseType,this.logger);return await Lu(Wh,Va,this.logger,this.performanceClient,n)(e,u,i.verifier,Cc,this.config,r,this.browserStorage,this.nativeStorage,this.eventHandler,this.logger,this.performanceClient,this.platformAuthProvider)}catch(e){throw t.popup?.close(),e instanceof Kn&&(e.setCorrelationId(this.correlationId),o.cacheFailedRequest(e)),e}}async executeEarFlow(e,t){const r=e.correlationId,n=await Lu(this.getDiscoveredAuthority.bind(this),ya,this.logger,this.performanceClient,r)({requestAuthority:e.authority,requestAzureCloudOptions:e.azureCloudOptions,requestExtraQueryParameters:e.extraQueryParameters,account:e.account}),o=await Lu(tu,xs,this.logger,this.performanceClient,r)(),i={...e,earJwk:o},a=t.popup||this.openPopup("about:blank",t);(await zh(a.document,this.config,n,i,this.logger,this.performanceClient)).submit();const s=await Lu(this.monitorPopupForHash.bind(this),Da,this.logger,this.performanceClient,r)(a,t.popupWindowParent),c=qu(Ph,rs,this.logger,this.performanceClient,this.correlationId)(s,this.config.auth.OIDCOptions.serverResponseType,this.logger);return Lu(Gh,Wa,this.logger,this.performanceClient,r)(i,c,Cc,this.config,n,this.browserStorage,this.nativeStorage,this.eventHandler,this.logger,this.performanceClient,this.platformAuthProvider)}async logoutPopupAsync(e,t,r,n){this.logger.verbose("logoutPopupAsync called"),this.eventHandler.emitEvent(Id,wc.Popup,e);const o=this.initializeServerTelemetryManager(962);try{await this.clearCacheOnLogout(this.correlationId,e.account);const i=await Lu(this.createAuthCodeClient.bind(this),Ha,this.logger,this.performanceClient,this.correlationId)({serverTelemetryManager:o,requestAuthority:r,account:e.account||void 0});try{i.authority.endSessionEndpoint}catch{if(e.account?.homeAccountId&&e.postLogoutRedirectUri&&i.authority.protocolMode===Ln){if(this.browserStorage.removeAccount(e.account?.homeAccountId,this.correlationId),this.eventHandler.emitEvent(Ad,wc.Popup,e),n){const e={apiId:962,timeout:this.config.system.redirectNavigationTimeout,noHistory:!1},t=Wi.getAbsoluteUrl(n,yu());await this.navigationClient.navigateInternal(t,e)}return void t.popup?.close()}}const a=i.getLogoutUri(e);this.eventHandler.emitEvent(Ad,wc.Popup,e);const s=this.openPopup(a,t);if(this.eventHandler.emitEvent(kd,wc.Popup,{popupWindow:s},null),await this.monitorPopupForHash(s,t.popupWindowParent).catch(()=>{}),n){const e={apiId:962,timeout:this.config.system.redirectNavigationTimeout,noHistory:!1},t=Wi.getAbsoluteUrl(n,yu());this.logger.verbose("Redirecting main window to url specified in the request"),this.logger.verbosePii(`Redirecting main window to: ${t}`),await this.navigationClient.navigateInternal(t,e)}else this.logger.verbose("No main window navigation requested")}catch(e){throw t.popup?.close(),e instanceof Kn&&(e.setCorrelationId(this.correlationId),o.cacheFailedRequest(e)),this.eventHandler.emitEvent(Td,wc.Popup,null,e),this.eventHandler.emitEvent(Sd,wc.Popup),e}this.eventHandler.emitEvent(Sd,wc.Popup)}initiateAuthRequest(e,t){if(e)return this.logger.infoPii(`Navigate to: ${e}`),this.openPopup(e,t);throw this.logger.error("Navigate url is empty"),Sl(Rc)}monitorPopupForHash(e,t){return new tg((t,r)=>{this.logger.verbose("PopupHandler.monitorPopupForHash - polling started");const n=setInterval(()=>{if(e.closed)return this.logger.error("PopupHandler.monitorPopupForHash - window closed"),clearInterval(n),void r(Sl(Lc));let o="";try{o=e.location.href}catch(e){}if(!o||"about:blank"===o)return;clearInterval(n);let i="";const a=this.config.auth.OIDCOptions.serverResponseType;e&&(i=a===In?e.location.search:e.location.hash),this.logger.verbose("PopupHandler.monitorPopupForHash - popup window is on same origin as caller"),t(i)},this.config.system.pollIntervalMilliseconds)}).finally(()=>{this.cleanPopup(e,t)})}openPopup(e,t){try{let r;if(t.popup?(r=t.popup,this.logger.verbosePii(`Navigating popup window to: ${e}`),r.location.assign(e)):void 0===t.popup&&(this.logger.verbosePii(`Opening popup window to: ${e}`),r=this.openSizedPopup(e,t)),!r)throw Sl(qc);return r.focus&&r.focus(),this.currentWindow=r,t.popupWindowParent.addEventListener("beforeunload",this.unloadWindow),r}catch(e){throw this.logger.error("error opening popup "+e.message),Sl(Dc)}}openSizedPopup(e,{popupName:t,popupWindowAttributes:r,popupWindowParent:n}){const o=n.screenLeft?n.screenLeft:n.screenX,i=n.screenTop?n.screenTop:n.screenY,a=n.innerWidth||document.documentElement.clientWidth||document.body.clientWidth,s=n.innerHeight||document.documentElement.clientHeight||document.body.clientHeight;let c=r.popupSize?.width,l=r.popupSize?.height,u=r.popupPosition?.top,d=r.popupPosition?.left;return(!c||c<0||c>a)&&(this.logger.verbose("Default popup window width used. Window width not configured or invalid."),c=483),(!l||l<0||l>s)&&(this.logger.verbose("Default popup window height used. Window height not configured or invalid."),l=600),(!u||u<0||u>s)&&(this.logger.verbose("Default popup window top position used. Window top not configured or invalid."),u=Math.max(0,s/2-300+i)),(!d||d<0||d>a)&&(this.logger.verbose("Default popup window left position used. Window left not configured or invalid."),d=Math.max(0,a/2-241.5+o)),n.open(e,t,`width=${c}, height=${l}, top=${u}, left=${d}, scrollbars=yes`)}unloadWindow(e){this.currentWindow&&this.currentWindow.close(),e.preventDefault()}cleanPopup(e,t){e.close(),t.removeEventListener("beforeunload",this.unloadWindow)}generatePopupName(e,t){return`${Ys}.${this.config.auth.clientId}.${e.join("-")}.${t}.${this.correlationId}`}generateLogoutPopupName(e){const t=e.account&&e.account.homeAccountId;return`${Ys}.${this.config.auth.clientId}.${t}.${this.correlationId}`}}var ng=r(64583).Promise;class og extends _h{constructor(e,t,r,n,o,i,a,s,c,l){super(e,t,r,n,o,i,a,c,l),this.nativeStorage=s}async acquireToken(e){const t=await Lu(this.initializeAuthorizationRequest.bind(this),ja,this.logger,this.performanceClient,this.correlationId)(e,wc.Redirect);t.platformBroker=eg(this.config,this.logger,this.platformAuthProvider,e.authenticationScheme);const r=e=>{e.persisted&&(this.logger.verbose("Page was restored from back/forward cache. Clearing temporary cache."),this.browserStorage.resetRequestCache(),this.eventHandler.emitEvent("msal:restoreFromBFCache",wc.Redirect))},n=this.getRedirectStartPage(e.redirectStartPage);this.logger.verbosePii(`Redirect start page: ${n}`),this.browserStorage.setTemporaryCache(cc,n,!0),window.addEventListener("pageshow",r);try{this.config.auth.protocolMode===Hn?await this.executeEarFlow(t):await this.executeCodeFlow(t,e.onRedirectNavigate)}catch(e){throw e instanceof Kn&&e.setCorrelationId(this.correlationId),window.removeEventListener("pageshow",r),e}}async executeCodeFlow(e,t){const r=e.correlationId,n=this.initializeServerTelemetryManager(bc),o=await Lu(Vh,Is,this.logger,this.performanceClient,r)(this.performanceClient,this.logger,r),i={...e,codeChallenge:o.challenge};this.browserStorage.cacheAuthorizeRequest(i,o.verifier);try{const r=await Lu(this.createAuthCodeClient.bind(this),Ha,this.logger,this.performanceClient,this.correlationId)({serverTelemetryManager:n,requestAuthority:i.authority,requestAzureCloudOptions:i.azureCloudOptions,requestExtraQueryParameters:i.extraQueryParameters,account:i.account}),o=await Lu($h,$a,this.logger,this.performanceClient,e.correlationId)(this.config,r.authority,i,this.logger,this.performanceClient);return await this.initiateAuthRequest(o,t)}catch(e){throw e instanceof Kn&&(e.setCorrelationId(this.correlationId),n.cacheFailedRequest(e)),e}}async executeEarFlow(e){const t=e.correlationId,r=await Lu(this.getDiscoveredAuthority.bind(this),ya,this.logger,this.performanceClient,t)({requestAuthority:e.authority,requestAzureCloudOptions:e.azureCloudOptions,requestExtraQueryParameters:e.extraQueryParameters,account:e.account}),n=await Lu(tu,xs,this.logger,this.performanceClient,t)(),o={...e,earJwk:n};return this.browserStorage.cacheAuthorizeRequest(o),(await zh(document,this.config,r,o,this.logger,this.performanceClient)).submit(),new ng((e,t)=>{setTimeout(()=>{t(Sl(kl,"failed_to_redirect"))},this.config.system.redirectNavigationTimeout)})}async handleRedirectPromise(e="",t,r,n){const o=this.initializeServerTelemetryManager(865);try{const[i,a]=this.getRedirectResponse(e||"");if(!i)return this.logger.info("handleRedirectPromise did not detect a response as a result of a redirect. Cleaning temporary cache."),this.browserStorage.resetRequestCache(),"back_forward"!==function(){if("undefined"==typeof window||void 0===window.performance||"function"!=typeof window.performance.getEntriesByType)return;const e=window.performance.getEntriesByType("navigation"),t=e.length?e[0]:void 0;return t?.type}()?n.event.errorCode="no_server_response":this.logger.verbose("Back navigation event detected. Muting no_server_response error"),null;const s=this.browserStorage.getTemporaryCache(cc,!0)||sn.EMPTY_STRING;if(Wi.removeHashFromUrl(s)===Wi.removeHashFromUrl(window.location.href)&&this.config.auth.navigateToLoginRequestUrl)return this.logger.verbose("Current page is loginRequestUrl, handling response"),s.indexOf("#")>-1&&function(e){const t=e.split("#");t.shift(),window.location.hash=t.length>0?t.join("#"):""}(s),await this.handleResponse(i,t,r,o);if(!this.config.auth.navigateToLoginRequestUrl)return this.logger.verbose("NavigateToLoginRequestUrl set to false, handling response"),await this.handleResponse(i,t,r,o);if(!mu()||this.config.system.allowRedirectInIframe){this.browserStorage.setTemporaryCache(lc,a,!0);const e={apiId:865,timeout:this.config.system.redirectNavigationTimeout,noHistory:!0};let n=!0;if(s&&"null"!==s)this.logger.verbose(`Navigating to loginRequestUrl: ${s}`),n=await this.navigationClient.navigateInternal(s,e);else{const t=function(){const e=new Wi(window.location.href).getUrlComponents();return`${e.Protocol}//${e.HostNameAndPort}/`}();this.browserStorage.setTemporaryCache(cc,t,!0),this.logger.warning("Unable to get valid login request url from cache, redirecting to home page"),n=await this.navigationClient.navigateInternal(t,e)}if(!n)return await this.handleResponse(i,t,r,o)}return null}catch(e){throw e instanceof Kn&&(e.setCorrelationId(this.correlationId),o.cacheFailedRequest(e)),e}}getRedirectResponse(e){this.logger.verbose("getRedirectResponseHash called");let t=e;t||(t=this.config.auth.OIDCOptions.serverResponseType===In?window.location.search:window.location.hash);let r=zi(t);if(r){try{!function(e,t,r){if(!e.state)throw Sl(Mc);const n=function(e,t){if(!t)return null;try{return yh.parseRequestState(e,t).libraryState.meta}catch(e){throw Ho(to)}}(t,e.state);if(!n)throw Sl(xc);if(n.interactionType!==r)throw Sl(Fc)}(r,this.browserCrypto,wc.Redirect)}catch(e){return e instanceof Kn&&this.logger.error(`Interaction type validation failed due to ${e.errorCode}: ${e.errorMessage}`),[null,""]}return fu(window),this.logger.verbose("Hash contains known properties, returning response hash"),[r,t]}const n=this.browserStorage.getTemporaryCache(lc,!0);return this.browserStorage.removeItem(this.browserStorage.generateCacheKey(lc)),n&&(r=zi(n),r)?(this.logger.verbose("Hash does not contain known properties, returning cached hash"),[r,n]):[null,""]}async handleResponse(e,t,r,n){if(!e.state)throw Sl(Mc);if(e.ear_jwe){const r=await Lu(this.getDiscoveredAuthority.bind(this),ya,this.logger,this.performanceClient,t.correlationId)({requestAuthority:t.authority,requestAzureCloudOptions:t.azureCloudOptions,requestExtraQueryParameters:t.extraQueryParameters,account:t.account});return Lu(Gh,Wa,this.logger,this.performanceClient,t.correlationId)(t,e,bc,this.config,r,this.browserStorage,this.nativeStorage,this.eventHandler,this.logger,this.performanceClient,this.platformAuthProvider)}const o=await Lu(this.createAuthCodeClient.bind(this),Ha,this.logger,this.performanceClient,this.correlationId)({serverTelemetryManager:n,requestAuthority:t.authority});return Lu(Wh,Va,this.logger,this.performanceClient,t.correlationId)(t,e,r,bc,this.config,o,this.browserStorage,this.nativeStorage,this.eventHandler,this.logger,this.performanceClient,this.platformAuthProvider)}async initiateAuthRequest(e,t){if(this.logger.verbose("RedirectHandler.initiateAuthRequest called"),e){this.logger.infoPii(`RedirectHandler.initiateAuthRequest: Navigate to: ${e}`);const r={apiId:bc,timeout:this.config.system.redirectNavigationTimeout,noHistory:!1},n=t||this.config.auth.onRedirectNavigate;return"function"==typeof n?(this.logger.verbose("RedirectHandler.initiateAuthRequest: Invoking onRedirectNavigate callback"),!1!==n(e)?(this.logger.verbose("RedirectHandler.initiateAuthRequest: onRedirectNavigate did not return false, navigating"),void await this.navigationClient.navigateExternal(e,r)):void this.logger.verbose("RedirectHandler.initiateAuthRequest: onRedirectNavigate returned false, stopping navigation")):(this.logger.verbose("RedirectHandler.initiateAuthRequest: Navigating window to navigate url"),void await this.navigationClient.navigateExternal(e,r))}throw this.logger.info("RedirectHandler.initiateAuthRequest: Navigate url is empty"),Sl(Rc)}async logout(e){this.logger.verbose("logoutRedirect called");const t=this.initializeLogoutRequest(e),r=this.initializeServerTelemetryManager(961);try{this.eventHandler.emitEvent(Id,wc.Redirect,e),await this.clearCacheOnLogout(this.correlationId,t.account);const n={apiId:961,timeout:this.config.system.redirectNavigationTimeout,noHistory:!1},o=await Lu(this.createAuthCodeClient.bind(this),Ha,this.logger,this.performanceClient,this.correlationId)({serverTelemetryManager:r,requestAuthority:e&&e.authority,requestExtraQueryParameters:e?.extraQueryParameters,account:e&&e.account||void 0});if(o.authority.protocolMode===Ln)try{o.authority.endSessionEndpoint}catch{if(t.account?.homeAccountId)return this.browserStorage.removeAccount(t.account?.homeAccountId,this.correlationId),void this.eventHandler.emitEvent(Ad,wc.Redirect,t)}const i=o.getLogoutUri(t);if(this.eventHandler.emitEvent(Ad,wc.Redirect,t),!e||"function"!=typeof e.onRedirectNavigate)return this.browserStorage.getInteractionInProgress()||this.browserStorage.setInteractionInProgress(!0,sc),void await this.navigationClient.navigateExternal(i,n);if(!1!==e.onRedirectNavigate(i))return this.logger.verbose("Logout onRedirectNavigate did not return false, navigating"),this.browserStorage.getInteractionInProgress()||this.browserStorage.setInteractionInProgress(!0,sc),void await this.navigationClient.navigateExternal(i,n);this.browserStorage.setInteractionInProgress(!1),this.logger.verbose("Logout onRedirectNavigate returned false, stopping navigation")}catch(e){throw e instanceof Kn&&(e.setCorrelationId(this.correlationId),r.cacheFailedRequest(e)),this.eventHandler.emitEvent(Td,wc.Redirect,null,e),this.eventHandler.emitEvent(Sd,wc.Redirect),e}this.eventHandler.emitEvent(Sd,wc.Redirect)}getRedirectStartPage(e){const t=e||window.location.href;return Wi.getAbsoluteUrl(t,yu())}}var ig=r(64583).Promise;async function ag(e,t,r,n,o){if(t.addQueueMeasurement(Ba,n),!e)throw r.info("Navigate url is empty"),Sl(Rc);return o?Lu(lg,qa,r,t,n)(e,o,t,n):qu(ug,La,r,t,n)(e)}async function sg(e,t,r,n,o){const i=dg();if(!i.contentDocument)throw"No document associated with iframe!";return(await zh(i.contentDocument,e,t,r,n,o)).submit(),i}async function cg(e,t,r,n,o,i,a){return n.addQueueMeasurement(Da,i),new ig((n,i)=>{t<1e4&&o.warning(`system.loadFrameTimeout or system.iframeHashTimeout set to lower (${t}ms) than the default (10000ms). This may result in timeouts.`);const s=window.setTimeout(()=>{window.clearInterval(c),i(Sl(Uc))},t),c=window.setInterval(()=>{let t="";const r=e.contentWindow;try{t=r?r.location.href:""}catch(e){}if(!t||"about:blank"===t)return;let o="";r&&(o=a===In?r.location.search:r.location.hash),window.clearTimeout(s),window.clearInterval(c),n(o)},r)}).finally(()=>{qu(hg,ys,o,n,i)(e)})}function lg(e,t,r,n){return r.addQueueMeasurement(qa,n),new ig((r,n)=>{const o=dg();window.setTimeout(()=>{o?(o.src=e,r(o)):n("Unable to load iframe")},t)})}function ug(e){const t=dg();return t.src=e,t}function dg(){const e=document.createElement("iframe");return e.className="msalSilentIframe",e.style.visibility="hidden",e.style.position="absolute",e.style.width=e.style.height="0",e.style.border="0",e.setAttribute("sandbox","allow-scripts allow-same-origin allow-forms"),document.body.appendChild(e),e}function hg(e){document.body===e.parentNode&&document.body.removeChild(e)}var gg=r(64583).Promise;class pg extends _h{constructor(e,t,r,n,o,i,a,s,c,l,u){super(e,t,r,n,o,i,s,l,u),this.apiId=a,this.nativeStorage=c}async acquireToken(e){this.performanceClient.addQueueMeasurement(pa,e.correlationId),e.loginHint||e.sid||e.account&&e.account.username||this.logger.warning("No user hint provided. The authorization server may need more information to complete this request.");const t={...e};t.prompt?t.prompt!==kn&&"no_session"!==t.prompt&&(this.logger.warning(`SilentIframeClient. Replacing invalid prompt ${t.prompt} with ${kn}`),t.prompt=kn):t.prompt=kn;const r=await Lu(this.initializeAuthorizationRequest.bind(this),ja,this.logger,this.performanceClient,e.correlationId)(t,wc.Silent);return r.platformBroker=eg(this.config,this.logger,this.platformAuthProvider,r.authenticationScheme),ku(r.authority),this.config.auth.protocolMode===Hn?this.executeEarFlow(r):this.executeCodeFlow(r)}async executeCodeFlow(e){let t;const r=this.initializeServerTelemetryManager(this.apiId);try{return t=await Lu(this.createAuthCodeClient.bind(this),Ha,this.logger,this.performanceClient,e.correlationId)({serverTelemetryManager:r,requestAuthority:e.authority,requestAzureCloudOptions:e.azureCloudOptions,requestExtraQueryParameters:e.extraQueryParameters,account:e.account}),await Lu(this.silentTokenHelper.bind(this),Fa,this.logger,this.performanceClient,e.correlationId)(t,e)}catch(n){if(n instanceof Kn&&(n.setCorrelationId(this.correlationId),r.cacheFailedRequest(n)),!(t&&n instanceof Kn&&n.errorCode===Js))throw n;return this.performanceClient.addFields({retryError:n.errorCode},this.correlationId),await Lu(this.silentTokenHelper.bind(this),Fa,this.logger,this.performanceClient,this.correlationId)(t,e)}}async executeEarFlow(e){const t=e.correlationId,r=await Lu(this.getDiscoveredAuthority.bind(this),ya,this.logger,this.performanceClient,t)({requestAuthority:e.authority,requestAzureCloudOptions:e.azureCloudOptions,requestExtraQueryParameters:e.extraQueryParameters,account:e.account}),n=await Lu(tu,xs,this.logger,this.performanceClient,t)(),o={...e,earJwk:n},i=await Lu(sg,Ba,this.logger,this.performanceClient,t)(this.config,r,o,this.logger,this.performanceClient),a=this.config.auth.OIDCOptions.serverResponseType,s=await Lu(cg,Da,this.logger,this.performanceClient,t)(i,this.config.system.iframeHashTimeout,this.config.system.pollIntervalMilliseconds,this.performanceClient,this.logger,t,a),c=qu(Ph,rs,this.logger,this.performanceClient,t)(s,a,this.logger);return Lu(Gh,Wa,this.logger,this.performanceClient,t)(o,c,this.apiId,this.config,r,this.browserStorage,this.nativeStorage,this.eventHandler,this.logger,this.performanceClient,this.platformAuthProvider)}logout(){return gg.reject(Sl(Wc))}async silentTokenHelper(e,t){const r=t.correlationId;this.performanceClient.addQueueMeasurement(Fa,r);const n=await Lu(Vh,Is,this.logger,this.performanceClient,r)(this.performanceClient,this.logger,r),o={...t,codeChallenge:n.challenge},i=await Lu($h,$a,this.logger,this.performanceClient,r)(this.config,e.authority,o,this.logger,this.performanceClient),a=await Lu(ag,Ba,this.logger,this.performanceClient,r)(i,this.performanceClient,this.logger,r,this.config.system.navigateFrameWait),s=this.config.auth.OIDCOptions.serverResponseType,c=await Lu(cg,Da,this.logger,this.performanceClient,r)(a,this.config.system.iframeHashTimeout,this.config.system.pollIntervalMilliseconds,this.performanceClient,this.logger,r,s),l=qu(Ph,rs,this.logger,this.performanceClient,r)(c,s,this.logger);return Lu(Wh,Va,this.logger,this.performanceClient,r)(t,l,n.verifier,this.apiId,this.config,e,this.browserStorage,this.nativeStorage,this.eventHandler,this.logger,this.performanceClient,this.platformAuthProvider)}}class fg extends mh{constructor(e,t){super(e,t)}async acquireToken(e){this.performanceClient?.addQueueMeasurement(Ia,e.correlationId);const t=Wo(),r=await Lu(this.executeTokenRequest.bind(this),ka,this.logger,this.performanceClient,e.correlationId)(e,this.authority),n=r.headers?.[gn],o=new Ch(this.config.authOptions.clientId,this.cacheManager,this.cryptoUtils,this.logger,this.config.serializableCache,this.config.persistencePlugin);return o.validateTokenResponse(r.body),Lu(o.handleServerTokenResponse.bind(o),ts,this.logger,this.performanceClient,e.correlationId)(r.body,this.authority,t,e,void 0,void 0,!0,e.forceCache,n)}async acquireTokenByRefreshToken(e){if(!e)throw Ni(yi);if(this.performanceClient?.addQueueMeasurement(Ta,e.correlationId),!e.account)throw Ho(vo);if(this.cacheManager.isAppMetadataFOCI(e.account.environment))try{return await Lu(this.acquireTokenWithCachedRefreshToken.bind(this),Aa,this.logger,this.performanceClient,e.correlationId)(e,!0)}catch(t){const r=t instanceof Yu&&t.errorCode===$u,n=t instanceof ph&&"invalid_grant"===t.errorCode&&"client_mismatch"===t.subError;if(r||n)return Lu(this.acquireTokenWithCachedRefreshToken.bind(this),Aa,this.logger,this.performanceClient,e.correlationId)(e,!1);throw t}return Lu(this.acquireTokenWithCachedRefreshToken.bind(this),Aa,this.logger,this.performanceClient,e.correlationId)(e,!1)}async acquireTokenWithCachedRefreshToken(e,t){this.performanceClient?.addQueueMeasurement(Aa,e.correlationId);const r=qu(this.cacheManager.getRefreshToken.bind(this.cacheManager),bs,this.logger,this.performanceClient,e.correlationId)(e.account,t,e.correlationId,void 0,this.performanceClient);if(!r)throw Zu($u);if(r.expiresOn&&Qo(r.expiresOn,e.refreshTokenExpirationOffsetSeconds||300))throw this.performanceClient?.addFields({rtExpiresOnMs:Number(r.expiresOn)},e.correlationId),Zu(Ku);const n={...e,refreshToken:r.secret,authenticationScheme:e.authenticationScheme||Fn.BEARER,ccsCredential:{credential:e.account.homeAccountId,type:Rd}};try{return await Lu(this.acquireToken.bind(this),Ia,this.logger,this.performanceClient,e.correlationId)(n)}catch(t){if(t instanceof Yu&&(this.performanceClient?.addFields({rtExpiresOnMs:Number(r.expiresOn)},e.correlationId),t.subError===Gu)){this.logger.verbose("acquireTokenWithRefreshToken: bad refresh token, removing from cache");const t=Jo(r);this.cacheManager.removeRefreshToken(t,e.correlationId)}throw t}}async executeTokenRequest(e,t){this.performanceClient?.addQueueMeasurement(ka,e.correlationId);const r=this.createTokenQueryParameters(e),n=Wi.appendQueryString(t.tokenEndpoint,r),o=await Lu(this.createTokenRequestBody.bind(this),Sa,this.logger,this.performanceClient,e.correlationId)(e),i=this.createTokenRequestHeaders(e.ccsCredential),a=ed(this.config.authOptions.clientId,e);return Lu(this.executePostToTokenEndpoint.bind(this),Ca,this.logger,this.performanceClient,e.correlationId)(n,o,i,a,e.correlationId,Ca)}async createTokenRequestBody(e){this.performanceClient?.addQueueMeasurement(Sa,e.correlationId);const t=new Map;if(zd(t,e.embeddedClientId||e.tokenBodyParameters?.[Md]||this.config.authOptions.clientId),e.redirectUri&&Kd(t,e.redirectUri),$d(t,e.scopes,!0,this.config.authOptions.authority.options.OIDCOptions?.defaultScopes),oh(t,"refresh_token"),ih(t),Xd(t,this.config.libraryInfo),Zd(t,this.config.telemetry.application),dh(t),this.serverTelemetryManager&&!Gs(this.config)&&uh(t,this.serverTelemetryManager),function(e,t){e.set("refresh_token",t)}(t,e.refreshToken),this.config.clientCredentials.clientSecret&&th(t,this.config.clientCredentials.clientSecret),this.config.clientCredentials.clientAssertion){const r=this.config.clientCredentials.clientAssertion;rh(t,await kh(r.assertion,this.config.authOptions.clientId,e.resourceRequestUri)),nh(t,r.assertionType)}if(e.authenticationScheme===Fn.POP){const r=new vh(this.cryptoUtils,this.performanceClient);let n;n=e.popKid?this.cryptoUtils.encodeKid(e.popKid):(await Lu(r.generateCnf.bind(r),Za,this.logger,this.performanceClient,e.correlationId)(e,this.logger)).reqCnfString,ch(t,n)}else if(e.authenticationScheme===Fn.SSH){if(!e.sshJwk)throw Ni(Ai);lh(t,e.sshJwk)}if((!xi.isEmptyObj(e.claims)||this.config.authOptions.clientCapabilities&&this.config.authOptions.clientCapabilities.length>0)&&Jd(t,e.claims,this.config.authOptions.clientCapabilities),this.config.systemOptions.preventCorsPreflight&&e.ccsCredential)switch(e.ccsCredential.type){case Rd:try{Vd(t,Di(e.ccsCredential.credential))}catch(e){this.logger.verbose("Could not parse home account ID for CCS Header: "+e)}break;case Od:Gd(t,e.ccsCredential.credential)}return e.embeddedClientId&&hh(t,this.config.authOptions.clientId,this.config.authOptions.redirectUri),e.tokenBodyParameters&&sh(t,e.tokenBodyParameters),Ud(t,e.correlationId,this.performanceClient),Ki(t)}}var mg=r(64583).Promise;class yg extends _h{async acquireToken(e){this.performanceClient.addQueueMeasurement(fa,e.correlationId);const t=await Lu(Sh,Oa,this.logger,this.performanceClient,e.correlationId)(e,this.config,this.performanceClient,this.logger),r={...e,...t};e.redirectUri&&(r.redirectUri=this.getRedirectUri(e.redirectUri));const n=this.initializeServerTelemetryManager(61),o=await this.createRefreshTokenClient({serverTelemetryManager:n,authorityUrl:r.authority,azureCloudOptions:r.azureCloudOptions,account:r.account});return Lu(o.acquireTokenByRefreshToken.bind(o),Ta,this.logger,this.performanceClient,e.correlationId)(r).catch(e=>{throw e.setCorrelationId(this.correlationId),n.cacheFailedRequest(e),e})}logout(){return mg.reject(Sl(Wc))}async createRefreshTokenClient(e){const t=await Lu(this.getClientConfiguration.bind(this),Ua,this.logger,this.performanceClient,this.correlationId)({serverTelemetryManager:e.serverTelemetryManager,requestAuthority:e.authorityUrl,requestAzureCloudOptions:e.azureCloudOptions,requestExtraQueryParameters:e.extraQueryParameters,account:e.account});return new fg(t,this.performanceClient)}}class vg{constructor(e,t,r,n){this.isBrowserEnvironment="undefined"!=typeof window,this.config=e,this.storage=t,this.logger=r,this.cryptoObj=n}async loadExternalTokens(e,t,r){if(!this.isBrowserEnvironment)throw Sl(Zc);const n=e.correlationId||Zl(),o=t.id_token?zo(t.id_token,ql):void 0,i={protocolMode:this.config.auth.protocolMode,knownAuthorities:this.config.auth.knownAuthorities,cloudDiscoveryMetadata:this.config.auth.cloudDiscoveryMetadata,authorityMetadata:this.config.auth.authorityMetadata,skipAuthorityMetadataCache:this.config.auth.skipAuthorityMetadataCache},a=e.authority?new Uu(Uu.generateAuthority(e.authority,e.azureCloudOptions),this.config.system.networkClient,this.storage,i,this.logger,e.correlationId||Zl()):void 0,s=await this.loadAccount(e,r.clientInfo||t.client_info||"",n,o,a),c=await this.loadIdToken(t,s.homeAccountId,s.environment,s.realm,n),l=await this.loadAccessToken(e,t,s.homeAccountId,s.environment,s.realm,r,n),u=await this.loadRefreshToken(t,s.homeAccountId,s.environment,n);return this.generateAuthenticationResult(e,{account:s,idToken:c,accessToken:l,refreshToken:u},o,a)}async loadAccount(e,t,r,n,o){if(this.logger.verbose("TokenCache - loading account"),e.account){const t=ji.createFromAccountInfo(e.account);return await this.storage.setAccount(t,r),t}if(!o||!t&&!n)throw this.logger.error("TokenCache - if an account is not provided on the request, authority and either clientInfo or idToken must be provided instead."),Sl(il);const i=ji.generateHomeAccountId(t,o.authorityType,this.logger,this.cryptoObj,n),a=n?.tid,s=wh(this.storage,o,i,ql,r,n,t,o.hostnameAndPort,a,void 0,void 0,this.logger);return await this.storage.setAccount(s,r),s}async loadIdToken(e,t,r,n,o){if(!e.id_token)return this.logger.verbose("TokenCache - no id token found in response"),null;this.logger.verbose("TokenCache - loading id token");const i=Yo(t,r,e.id_token,this.config.auth.clientId,n);return await this.storage.setIdTokenCredential(i,o),i}async loadAccessToken(e,t,r,n,o,i,a){if(!t.access_token)return this.logger.verbose("TokenCache - no access token found in response"),null;if(!t.expires_in)return this.logger.error("TokenCache - no expiration set on the access token. Cannot add it to the cache."),null;if(!(t.scope||e.scopes&&e.scopes.length))return this.logger.error("TokenCache - scopes not specified in the request or response. Cannot add token to the cache."),null;this.logger.verbose("TokenCache - loading access token");const s=t.scope?Fi.fromString(t.scope):new Fi(e.scopes),c=i.expiresOn||t.expires_in+Wo(),l=i.extendedExpiresOn||(t.ext_expires_in||t.expires_in)+Wo(),u=Xo(r,n,t.access_token,this.config.auth.clientId,o,s.printScopes(),c,l,ql);return await this.storage.setAccessTokenCredential(u,a),u}async loadRefreshToken(e,t,r,n){if(!e.refresh_token)return this.logger.verbose("TokenCache - no refresh token found in response"),null;this.logger.verbose("TokenCache - loading refresh token");const o=Zo(t,r,e.refresh_token,this.config.auth.clientId,e.foci,void 0,e.refresh_token_expires_in);return await this.storage.setRefreshTokenCredential(o,n),o}generateAuthenticationResult(e,t,r,n){let o,i="",a=[],s=null;t?.accessToken&&(i=t.accessToken.secret,a=Fi.fromString(t.accessToken.target).asArray(),s=Vo(t.accessToken.expiresOn),o=Vo(t.accessToken.extendedExpiresOn));const c=t.account;return{authority:n?n.canonicalAuthority:"",uniqueId:t.account.localAccountId,tenantId:t.account.realm,scopes:a,account:c.getAccountInfo(),idToken:t.idToken?.secret||"",idTokenClaims:r||{},accessToken:i,fromCache:!0,expiresOn:s,correlationId:e.correlationId||"",requestId:"",extExpiresOn:o,familyId:t.refreshToken?.familyId||"",tokenType:t?.accessToken?.tokenType||"",state:e.state||"",cloudGraphHostName:c.cloudGraphHostName||"",msGraphHost:c.msGraphHost||"",fromNativeBroker:!1}}}class bg extends Ih{constructor(e){super(e),this.includeRedirectUri=!1}}var Cg=r(64583).Promise;class wg extends _h{constructor(e,t,r,n,o,i,a,s,c,l){super(e,t,r,n,o,i,s,c,l),this.apiId=a}async acquireToken(e){if(!e.code)throw Sl(sl);const t=await Lu(this.initializeAuthorizationRequest.bind(this),ja,this.logger,this.performanceClient,e.correlationId)(e,wc.Silent),r=this.initializeServerTelemetryManager(this.apiId);try{const n={...t,code:e.code},o=await Lu(this.getClientConfiguration.bind(this),Ua,this.logger,this.performanceClient,e.correlationId)({serverTelemetryManager:r,requestAuthority:t.authority,requestAzureCloudOptions:t.azureCloudOptions,requestExtraQueryParameters:t.extraQueryParameters,account:t.account}),i=new bg(o);this.logger.verbose("Auth code client created");const a=new Mh(i,this.browserStorage,n,this.logger,this.performanceClient);return await Lu(a.handleCodeResponseFromServer.bind(a),za,this.logger,this.performanceClient,e.correlationId)({code:e.code,msgraph_host:e.msGraphHost,cloud_graph_host_name:e.cloudGraphHostName,cloud_instance_host_name:e.cloudInstanceHostName},t,!1)}catch(e){throw e instanceof Kn&&(e.setCorrelationId(this.correlationId),r.cacheFailedRequest(e)),e}}logout(){return Cg.reject(Sl(Wc))}}var kg=r(64583).Promise;function Ig(e){const t=e?.idTokenClaims;return t?.tfp||t?.acr?"B2C":t?.tid?"9188040d-6c67-4c5b-b112-36a304b66dad"===t?.tid?"MSA":"AAD":void 0}function Ag(e,t){try{Cu(e)}catch(e){throw t.end({success:!1},e),e}}class Tg{constructor(e){var t,r,n,o;this.operatingContext=e,this.isBrowserEnvironment=this.operatingContext.isBrowserEnvironment(),this.config=e.getConfig(),this.initialized=!1,this.logger=this.operatingContext.getLogger(),this.networkClient=this.config.system.networkClient,this.navigationClient=this.config.system.navigationClient,this.redirectResponse=new Map,this.hybridAuthCodeResponses=new Map,this.performanceClient=this.config.telemetry.client,this.browserCrypto=this.isBrowserEnvironment?new Bu(this.logger,this.performanceClient):Uo,this.eventHandler=new Pd(this.logger),this.browserStorage=this.isBrowserEnvironment?new Ed(this.config.auth.clientId,this.config.cache,this.browserCrypto,this.logger,this.performanceClient,this.eventHandler,function(e){const t=e.cloudDiscoveryMetadata;let r;if(t)try{r=JSON.parse(t)}catch(e){throw Ni(wi)}return{canonicalAuthority:e.authority?ju(e.authority):void 0,knownAuthorities:e.knownAuthorities,cloudDiscoveryMetadata:r}}(this.config.auth)):(t=this.config.auth.clientId,r=this.logger,n=this.performanceClient,o=this.eventHandler,new Ed(t,{cacheLocation:ic,temporaryCacheLocation:ic,storeAuthStateInCookie:!1,secureCookies:!1,cacheMigrationEnabled:!1,claimsBasedCachingEnabled:!1},Uo,r,n,o));const i={cacheLocation:ic,temporaryCacheLocation:ic,storeAuthStateInCookie:!1,secureCookies:!1,cacheMigrationEnabled:!1,claimsBasedCachingEnabled:!1};this.nativeInternalStorage=new Ed(this.config.auth.clientId,i,this.browserCrypto,this.logger,this.performanceClient,this.eventHandler),this.tokenCache=new vg(this.config,this.browserStorage,this.logger,this.browserCrypto),this.activeSilentTokenRequests=new Map,this.trackPageVisibility=this.trackPageVisibility.bind(this),this.trackPageVisibilityWithMeasurement=this.trackPageVisibilityWithMeasurement.bind(this)}static async createController(e,t){const r=new Tg(e);return await r.initialize(t),r}trackPageVisibility(e){e&&(this.logger.info("Perf: Visibility change detected"),this.performanceClient.incrementFields({visibilityChangeCount:1},e))}async initialize(e,t){if(this.logger.trace("initialize called"),this.initialized)return void this.logger.info("initialize has already been called, exiting early.");if(!this.isBrowserEnvironment)return this.logger.info("in non-browser environment, exiting early."),this.initialized=!0,void this.eventHandler.emitEvent(ud);const r=e?.correlationId||this.getRequestCorrelationId(),n=this.config.system.allowPlatformBroker,o=this.performanceClient.startMeasurement(Na,r);if(this.eventHandler.emitEvent("msal:initializeStart"),!t)try{this.logMultipleInstances(o)}catch{}if(await Lu(this.browserStorage.initialize.bind(this.browserStorage),xa,this.logger,this.performanceClient,r)(r),n)try{this.platformAuthProvider=await async function(e,t,r,n){e.trace("getPlatformAuthProvider called",r);const o=function(){let e;try{return e=window[oc],"true"===e?.getItem("msal.browser.platform.auth.dom")}catch(e){return!1}}();let i;e.trace("Has client allowed platform auth via DOM API: "+o);try{o&&(i=await Zh.createProvider(e,t,r)),i||(e.trace("Platform auth via DOM API not available, checking for extension"),i=await Xh.createProvider(e,n||2e3,t))}catch(t){e.trace("Platform auth not available",t)}return i}(this.logger,this.performanceClient,r,this.config.system.nativeBrokerHandshakeTimeout)}catch(e){this.logger.verbose(e)}this.config.cache.claimsBasedCachingEnabled||(this.logger.verbose("Claims-based caching is disabled. Clearing the previous cache with claims"),qu(this.browserStorage.clearTokensAndKeysWithClaims.bind(this.browserStorage),vs,this.logger,this.performanceClient,r)(r)),this.config.system.asyncPopups&&await this.preGeneratePkceCodes(r),this.initialized=!0,this.eventHandler.emitEvent(ud),o.end({allowPlatformBroker:n,success:!0})}async handleRedirectPromise(e){if(this.logger.verbose("handleRedirectPromise called"),bu(this.initialized),this.isBrowserEnvironment){const t=e||"";let r=this.redirectResponse.get(t);return void 0===r?(r=this.handleRedirectPromiseInternal(e),this.redirectResponse.set(t,r),this.logger.verbose("handleRedirectPromise has been called for the first time, storing the promise")):this.logger.verbose("handleRedirectPromise has been called previously, returning the result from the first call"),r}return this.logger.verbose("handleRedirectPromise returns null, not browser environment"),null}async handleRedirectPromiseInternal(e){if(!this.browserStorage.isInteractionInProgress(!0))return this.logger.info("handleRedirectPromise called but there is no interaction in progress, returning null."),null;const t=this.browserStorage.getInteractionInProgress()?.type;if(t===sc)return this.logger.verbose("handleRedirectPromise removing interaction_in_progress flag and returning null after sign-out"),this.browserStorage.setInteractionInProgress(!1),kg.resolve(null);const r=this.getAllAccounts(),n=this.browserStorage.getCachedNativeRequest(),o=n&&this.platformAuthProvider&&!e;let i,a;this.eventHandler.emitEvent("msal:handleRedirectStart",wc.Redirect);try{if(o&&this.platformAuthProvider){i=this.performanceClient.startMeasurement(ua,n?.correlationId||""),this.logger.trace("handleRedirectPromise - acquiring token from native platform");const e=new Uh(this.config,this.browserStorage,this.browserCrypto,this.logger,this.eventHandler,this.navigationClient,865,this.performanceClient,this.platformAuthProvider,n.accountId,this.nativeInternalStorage,n.correlationId);a=Lu(e.handleRedirectPromise.bind(e),fs,this.logger,this.performanceClient,i.event.correlationId)(this.performanceClient,i.event.correlationId)}else{const[t,r]=this.browserStorage.getCachedRequest(),n=t.correlationId;i=this.performanceClient.startMeasurement(ua,n),this.logger.trace("handleRedirectPromise - acquiring token from web flow");const o=this.createRedirectClient(n);a=Lu(o.handleRedirectPromise.bind(o),ps,this.logger,this.performanceClient,i.event.correlationId)(e,t,r,i)}}catch(e){throw this.browserStorage.resetRequestCache(),e}return a.then(e=>(e?(this.browserStorage.resetRequestCache(),r.length<this.getAllAccounts().length?(this.eventHandler.emitEvent(fd,wc.Redirect,e),this.logger.verbose("handleRedirectResponse returned result, login success")):(this.eventHandler.emitEvent(vd,wc.Redirect,e),this.logger.verbose("handleRedirectResponse returned result, acquire token success")),i.end({success:!0,accountType:Ig(e.account)})):i.event.errorCode?i.end({success:!1}):i.discard(),this.eventHandler.emitEvent(wd,wc.Redirect),e)).catch(e=>{this.browserStorage.resetRequestCache();const t=e;throw r.length>0?this.eventHandler.emitEvent(bd,wc.Redirect,null,t):this.eventHandler.emitEvent(md,wc.Redirect,null,t),this.eventHandler.emitEvent(wd,wc.Redirect),i.end({success:!1},t),e})}async acquireTokenRedirect(e){const t=this.getRequestCorrelationId(e);this.logger.verbose("acquireTokenRedirect called",t);const r=this.performanceClient.startMeasurement("acquireTokenPreRedirect",t);r.add({accountType:Ig(e.account),scenarioId:e.scenarioId});const n=e.onRedirectNavigate;if(n)e.onRedirectNavigate=e=>{const t="function"==typeof n?n(e):void 0;return!1!==t?r.end({success:!0}):r.discard(),t};else{const e=this.config.auth.onRedirectNavigate;this.config.auth.onRedirectNavigate=t=>{const n="function"==typeof e?e(t):void 0;return!1!==n?r.end({success:!0}):r.discard(),n}}const o=this.getAllAccounts().length>0;try{let n;return wu(this.initialized,this.config),this.browserStorage.setInteractionInProgress(!0,ac),o?this.eventHandler.emitEvent(yd,wc.Redirect,e):this.eventHandler.emitEvent(pd,wc.Redirect,e),n=this.platformAuthProvider&&this.canUsePlatformBroker(e)?new Uh(this.config,this.browserStorage,this.browserCrypto,this.logger,this.eventHandler,this.navigationClient,bc,this.performanceClient,this.platformAuthProvider,this.getNativeAccountId(e),this.nativeInternalStorage,t).acquireTokenRedirect(e,r).catch(r=>{if(r instanceof Fh&&Bh(r))return this.platformAuthProvider=void 0,this.createRedirectClient(t).acquireToken(e);if(r instanceof Yu)return this.logger.verbose("acquireTokenRedirect - Resolving interaction required error thrown by native broker by falling back to web flow"),this.createRedirectClient(t).acquireToken(e);throw r}):this.createRedirectClient(t).acquireToken(e),await n}catch(e){throw this.browserStorage.resetRequestCache(),r.end({success:!1},e),o?this.eventHandler.emitEvent(bd,wc.Redirect,null,e):this.eventHandler.emitEvent(md,wc.Redirect,null,e),e}}acquireTokenPopup(e){const t=this.getRequestCorrelationId(e),r=this.performanceClient.startMeasurement(la,t);r.add({scenarioId:e.scenarioId,accountType:Ig(e.account)});try{this.logger.verbose("acquireTokenPopup called",t),Ag(this.initialized,r),this.browserStorage.setInteractionInProgress(!0,ac)}catch(e){return kg.reject(e)}const n=this.getAllAccounts();let o;n.length>0?this.eventHandler.emitEvent(yd,wc.Popup,e):this.eventHandler.emitEvent(pd,wc.Popup,e);const i=this.getPreGeneratedPkceCodes(t);return o=this.canUsePlatformBroker(e)?this.acquireTokenNative({...e,correlationId:t},Cc).then(e=>(r.end({success:!0,isNativeBroker:!0,accountType:Ig(e.account)}),e)).catch(r=>{if(r instanceof Fh&&Bh(r))return this.platformAuthProvider=void 0,this.createPopupClient(t).acquireToken(e,i);if(r instanceof Yu)return this.logger.verbose("acquireTokenPopup - Resolving interaction required error thrown by native broker by falling back to web flow"),this.createPopupClient(t).acquireToken(e,i);throw r}):this.createPopupClient(t).acquireToken(e,i),o.then(e=>(n.length<this.getAllAccounts().length?this.eventHandler.emitEvent(fd,wc.Popup,e):this.eventHandler.emitEvent(vd,wc.Popup,e),r.end({success:!0,accessTokenSize:e.accessToken.length,idTokenSize:e.idToken.length,accountType:Ig(e.account)}),e)).catch(e=>(n.length>0?this.eventHandler.emitEvent(bd,wc.Popup,null,e):this.eventHandler.emitEvent(md,wc.Popup,null,e),r.end({success:!1},e),kg.reject(e))).finally(async()=>{this.browserStorage.setInteractionInProgress(!1),this.config.system.asyncPopups&&await this.preGeneratePkceCodes(t)})}trackPageVisibilityWithMeasurement(){const e=this.ssoSilentMeasurement||this.acquireTokenByCodeAsyncMeasurement;e&&(this.logger.info("Perf: Visibility change detected in ",e.event.name),e.increment({visibilityChangeCount:1}))}async ssoSilent(e){const t=this.getRequestCorrelationId(e),r={...e,prompt:e.prompt,correlationId:t};let n;return this.ssoSilentMeasurement=this.performanceClient.startMeasurement(ma,t),this.ssoSilentMeasurement?.add({scenarioId:e.scenarioId,accountType:Ig(e.account)}),Ag(this.initialized,this.ssoSilentMeasurement),this.ssoSilentMeasurement?.increment({visibilityChangeCount:0}),document.addEventListener("visibilitychange",this.trackPageVisibilityWithMeasurement),this.logger.verbose("ssoSilent called",t),this.eventHandler.emitEvent("msal:ssoSilentStart",wc.Silent,r),n=this.canUsePlatformBroker(r)?this.acquireTokenNative(r,863).catch(e=>{if(e instanceof Fh&&Bh(e))return this.platformAuthProvider=void 0,this.createSilentIframeClient(r.correlationId).acquireToken(r);throw e}):this.createSilentIframeClient(r.correlationId).acquireToken(r),n.then(e=>(this.eventHandler.emitEvent("msal:ssoSilentSuccess",wc.Silent,e),this.ssoSilentMeasurement?.end({success:!0,isNativeBroker:e.fromNativeBroker,accessTokenSize:e.accessToken.length,idTokenSize:e.idToken.length,accountType:Ig(e.account)}),e)).catch(e=>{throw this.eventHandler.emitEvent("msal:ssoSilentFailure",wc.Silent,null,e),this.ssoSilentMeasurement?.end({success:!1},e),e}).finally(()=>{document.removeEventListener("visibilitychange",this.trackPageVisibilityWithMeasurement)})}async acquireTokenByCode(e){const t=this.getRequestCorrelationId(e);this.logger.trace("acquireTokenByCode called",t);const r=this.performanceClient.startMeasurement(ia,t);Ag(this.initialized,r),this.eventHandler.emitEvent("msal:acquireTokenByCodeStart",wc.Silent,e),r.add({scenarioId:e.scenarioId});try{if(e.code&&e.nativeAccountId)throw Sl(ll);if(e.code){const n=e.code;let o=this.hybridAuthCodeResponses.get(n);return o?(this.logger.verbose("Existing acquireTokenByCode request found",t),r.discard()):(this.logger.verbose("Initiating new acquireTokenByCode request",t),o=this.acquireTokenByCodeAsync({...e,correlationId:t}).then(e=>(this.eventHandler.emitEvent("msal:acquireTokenByCodeSuccess",wc.Silent,e),this.hybridAuthCodeResponses.delete(n),r.end({success:!0,isNativeBroker:e.fromNativeBroker,accessTokenSize:e.accessToken.length,idTokenSize:e.idToken.length,accountType:Ig(e.account)}),e)).catch(e=>{throw this.hybridAuthCodeResponses.delete(n),this.eventHandler.emitEvent(Cd,wc.Silent,null,e),r.end({success:!1},e),e}),this.hybridAuthCodeResponses.set(n,o)),await o}if(e.nativeAccountId){if(this.canUsePlatformBroker(e,e.nativeAccountId)){const n=await this.acquireTokenNative({...e,correlationId:t},866,e.nativeAccountId).catch(e=>{throw e instanceof Fh&&Bh(e)&&(this.platformAuthProvider=void 0),e});return r.end({accountType:Ig(n.account),success:!0}),n}throw Sl(dl)}throw Sl(cl)}catch(e){throw this.eventHandler.emitEvent(Cd,wc.Silent,null,e),r.end({success:!1},e),e}}async acquireTokenByCodeAsync(e){this.logger.trace("acquireTokenByCodeAsync called",e.correlationId),this.acquireTokenByCodeAsyncMeasurement=this.performanceClient.startMeasurement(gs,e.correlationId),this.acquireTokenByCodeAsyncMeasurement?.increment({visibilityChangeCount:0}),document.addEventListener("visibilitychange",this.trackPageVisibilityWithMeasurement);const t=this.createSilentAuthCodeClient(e.correlationId);return await t.acquireToken(e).then(e=>(this.acquireTokenByCodeAsyncMeasurement?.end({success:!0,fromCache:e.fromCache,isNativeBroker:e.fromNativeBroker}),e)).catch(e=>{throw this.acquireTokenByCodeAsyncMeasurement?.end({success:!1},e),e}).finally(()=>{document.removeEventListener("visibilitychange",this.trackPageVisibilityWithMeasurement)})}async acquireTokenFromCache(e,t){switch(this.performanceClient.addQueueMeasurement(Ea,e.correlationId),t){case 0:case 1:case 2:const t=this.createSilentCacheClient(e.correlationId);return Lu(t.acquireToken.bind(t),ga,this.logger,this.performanceClient,e.correlationId)(e);default:throw Ho(So)}}async acquireTokenByRefreshToken(e,t){switch(this.performanceClient.addQueueMeasurement(aa,e.correlationId),t){case 0:case 2:case 3:case 4:const t=this.createSilentRefreshClient(e.correlationId);return Lu(t.acquireToken.bind(t),fa,this.logger,this.performanceClient,e.correlationId)(e);default:throw Ho(So)}}async acquireTokenBySilentIframe(e){this.performanceClient.addQueueMeasurement(Ra,e.correlationId);const t=this.createSilentIframeClient(e.correlationId);return Lu(t.acquireToken.bind(t),pa,this.logger,this.performanceClient,e.correlationId)(e)}async logout(e){const t=this.getRequestCorrelationId(e);return this.logger.warning("logout API is deprecated and will be removed in msal-browser v3.0.0. Use logoutRedirect instead.",t),this.logoutRedirect({correlationId:t,...e})}async logoutRedirect(e){const t=this.getRequestCorrelationId(e);return wu(this.initialized,this.config),this.browserStorage.setInteractionInProgress(!0,sc),this.createRedirectClient(t).logout(e)}logoutPopup(e){try{const t=this.getRequestCorrelationId(e);return Cu(this.initialized),this.browserStorage.setInteractionInProgress(!0,sc),this.createPopupClient(t).logout(e).finally(()=>{this.browserStorage.setInteractionInProgress(!1)})}catch(e){return kg.reject(e)}}async clearCache(e){if(!this.isBrowserEnvironment)return void this.logger.info("in non-browser environment, returning early.");const t=this.getRequestCorrelationId(e);return this.createSilentCacheClient(t).logout(e)}getAllAccounts(e){const t=this.getRequestCorrelationId();return function(e,t,r,n,o){return e.verbose("getAllAccounts called"),r?t.getAllAccounts(o||{},n):[]}(this.logger,this.browserStorage,this.isBrowserEnvironment,t,e)}getAccount(e){const t=this.getRequestCorrelationId();return function(e,t,r,n){if(t.trace("getAccount called"),0===Object.keys(e).length)return t.warning("getAccount: No accountFilter provided"),null;const o=r.getAccountInfoFilteredBy(e,n);return o?(t.verbose("getAccount: Account matching provided filter found, returning"),o):(t.verbose("getAccount: No matching account found, returning null"),null)}(e,this.logger,this.browserStorage,t)}getAccountByUsername(e){const t=this.getRequestCorrelationId();return function(e,t,r,n){if(t.trace("getAccountByUsername called"),!e)return t.warning("getAccountByUsername: No username provided"),null;const o=r.getAccountInfoFilteredBy({username:e},n);return o?(t.verbose("getAccountByUsername: Account matching username found, returning"),t.verbosePii(`getAccountByUsername: Returning signed-in accounts matching username: ${e}`),o):(t.verbose("getAccountByUsername: No matching account found, returning null"),null)}(e,this.logger,this.browserStorage,t)}getAccountByHomeId(e){const t=this.getRequestCorrelationId();return function(e,t,r,n){if(t.trace("getAccountByHomeId called"),!e)return t.warning("getAccountByHomeId: No homeAccountId provided"),null;const o=r.getAccountInfoFilteredBy({homeAccountId:e},n);return o?(t.verbose("getAccountByHomeId: Account matching homeAccountId found, returning"),t.verbosePii(`getAccountByHomeId: Returning signed-in accounts matching homeAccountId: ${e}`),o):(t.verbose("getAccountByHomeId: No matching account found, returning null"),null)}(e,this.logger,this.browserStorage,t)}getAccountByLocalId(e){const t=this.getRequestCorrelationId();return function(e,t,r,n){if(t.trace("getAccountByLocalId called"),!e)return t.warning("getAccountByLocalId: No localAccountId provided"),null;const o=r.getAccountInfoFilteredBy({localAccountId:e},n);return o?(t.verbose("getAccountByLocalId: Account matching localAccountId found, returning"),t.verbosePii(`getAccountByLocalId: Returning signed-in accounts matching localAccountId: ${e}`),o):(t.verbose("getAccountByLocalId: No matching account found, returning null"),null)}(e,this.logger,this.browserStorage,t)}setActiveAccount(e){const t=this.getRequestCorrelationId();!function(e,t,r){t.setActiveAccount(e,r)}(e,this.browserStorage,t)}getActiveAccount(){const e=this.getRequestCorrelationId();return function(e,t){return e.getActiveAccount(t)}(this.browserStorage,e)}async hydrateCache(e,t){this.logger.verbose("hydrateCache called");const r=ji.createFromAccountInfo(e.account,e.cloudGraphHostName,e.msGraphHost);return await this.browserStorage.setAccount(r,e.correlationId),e.fromNativeBroker?(this.logger.verbose("Response was from native broker, storing in-memory"),this.nativeInternalStorage.hydrateCache(e,t)):this.browserStorage.hydrateCache(e,t)}async acquireTokenNative(e,t,r,n){if(this.logger.trace("acquireTokenNative called"),!this.platformAuthProvider)throw Sl(pl);return new Uh(this.config,this.browserStorage,this.browserCrypto,this.logger,this.eventHandler,this.navigationClient,t,this.performanceClient,this.platformAuthProvider,r||this.getNativeAccountId(e),this.nativeInternalStorage,e.correlationId).acquireToken(e,n)}canUsePlatformBroker(e,t){if(this.logger.trace("canUsePlatformBroker called"),!this.platformAuthProvider)return this.logger.trace("canUsePlatformBroker: platform broker unavilable, returning false"),!1;if(!eg(this.config,this.logger,this.platformAuthProvider,e.authenticationScheme))return this.logger.trace("canUsePlatformBroker: isBrokerAvailable returned false, returning false"),!1;if(e.prompt)switch(e.prompt){case kn:case wn:case Cn:this.logger.trace("canUsePlatformBroker: prompt is compatible with platform broker flow");break;default:return this.logger.trace(`canUsePlatformBroker: prompt = ${e.prompt} is not compatible with platform broker flow, returning false`),!1}return!(!t&&!this.getNativeAccountId(e)&&(this.logger.trace("canUsePlatformBroker: nativeAccountId is not available, returning false"),1))}getNativeAccountId(e){const t=e.account||this.getAccount({loginHint:e.loginHint,sid:e.sid})||this.getActiveAccount();return t&&t.nativeAccountId||""}createPopupClient(e){return new rg(this.config,this.browserStorage,this.browserCrypto,this.logger,this.eventHandler,this.navigationClient,this.performanceClient,this.nativeInternalStorage,this.platformAuthProvider,e)}createRedirectClient(e){return new og(this.config,this.browserStorage,this.browserCrypto,this.logger,this.eventHandler,this.navigationClient,this.performanceClient,this.nativeInternalStorage,this.platformAuthProvider,e)}createSilentIframeClient(e){return new pg(this.config,this.browserStorage,this.browserCrypto,this.logger,this.eventHandler,this.navigationClient,863,this.performanceClient,this.nativeInternalStorage,this.platformAuthProvider,e)}createSilentCacheClient(e){return new Lh(this.config,this.browserStorage,this.browserCrypto,this.logger,this.eventHandler,this.navigationClient,this.performanceClient,this.platformAuthProvider,e)}createSilentRefreshClient(e){return new yg(this.config,this.browserStorage,this.browserCrypto,this.logger,this.eventHandler,this.navigationClient,this.performanceClient,this.platformAuthProvider,e)}createSilentAuthCodeClient(e){return new wg(this.config,this.browserStorage,this.browserCrypto,this.logger,this.eventHandler,this.navigationClient,866,this.performanceClient,this.platformAuthProvider,e)}addEventCallback(e,t){return this.eventHandler.addEventCallback(e,t)}removeEventCallback(e){this.eventHandler.removeEventCallback(e)}addPerformanceCallback(e){return vu(),this.performanceClient.addPerformanceCallback(e)}removePerformanceCallback(e){return this.performanceClient.removePerformanceCallback(e)}enableAccountStorageEvents(){this.config.cache.cacheLocation===nc?this.eventHandler.subscribeCrossTab():this.logger.info("Account storage events are only available when cacheLocation is set to localStorage")}disableAccountStorageEvents(){this.config.cache.cacheLocation===nc?this.eventHandler.unsubscribeCrossTab():this.logger.info("Account storage events are only available when cacheLocation is set to localStorage")}getTokenCache(){return this.tokenCache}getLogger(){return this.logger}setLogger(e){this.logger=e}initializeWrapperLibrary(e,t){this.browserStorage.setWrapperMetadata(e,t)}setNavigationClient(e){this.navigationClient=e}getConfiguration(){return this.config}getPerformanceClient(){return this.performanceClient}isBrowserEnv(){return this.isBrowserEnvironment}getRequestCorrelationId(e){return e?.correlationId?e.correlationId:this.isBrowserEnvironment?Zl():sn.EMPTY_STRING}async loginRedirect(e){const t=this.getRequestCorrelationId(e);return this.logger.verbose("loginRedirect called",t),this.acquireTokenRedirect({correlationId:t,...e||kc})}loginPopup(e){const t=this.getRequestCorrelationId(e);return this.logger.verbose("loginPopup called",t),this.acquireTokenPopup({correlationId:t,...e||kc})}async acquireTokenSilent(e){const t=this.getRequestCorrelationId(e),r=this.performanceClient.startMeasurement(sa,t);r.add({cacheLookupPolicy:e.cacheLookupPolicy,scenarioId:e.scenarioId}),Ag(this.initialized,r),this.logger.verbose("acquireTokenSilent called",t);const n=e.account||this.getActiveAccount();if(!n)throw Sl(Gc);return r.add({accountType:Ig(n)}),this.acquireTokenSilentDeduped(e,n,t).then(n=>(r.end({success:!0,fromCache:n.fromCache,isNativeBroker:n.fromNativeBroker,accessTokenSize:n.accessToken.length,idTokenSize:n.idToken.length}),{...n,state:e.state,correlationId:t})).catch(e=>{throw e instanceof Kn&&e.setCorrelationId(t),r.end({success:!1},e),e})}async acquireTokenSilentDeduped(e,t,r){const n=ed(this.config.auth.clientId,{...e,authority:e.authority||this.config.auth.authority,correlationId:r},t.homeAccountId),o=JSON.stringify(n),i=this.activeSilentTokenRequests.get(o);if(void 0===i){this.logger.verbose("acquireTokenSilent called for the first time, storing active request",r),this.performanceClient.addFields({deduped:!1},r);const n=Lu(this.acquireTokenSilentAsync.bind(this),ca,this.logger,this.performanceClient,r)({...e,correlationId:r},t);return this.activeSilentTokenRequests.set(o,n),n.finally(()=>{this.activeSilentTokenRequests.delete(o)})}return this.logger.verbose("acquireTokenSilent has been called previously, returning the result from the first call",r),this.performanceClient.addFields({deduped:!0},r),i}async acquireTokenSilentAsync(e,t){const r=()=>this.trackPageVisibility(e.correlationId);this.performanceClient.addQueueMeasurement(ca,e.correlationId),this.eventHandler.emitEvent(yd,wc.Silent,e),e.correlationId&&this.performanceClient.incrementFields({visibilityChangeCount:0},e.correlationId),document.addEventListener("visibilitychange",r);const n=await Lu(Eh,Ma,this.logger,this.performanceClient,e.correlationId)(e,t,this.config,this.performanceClient,this.logger),o=e.cacheLookupPolicy||0;return this.acquireTokenSilentNoIframe(n,o).catch(async e=>{const t=function(e,t){const r=!(e instanceof Yu&&e.subError!==Gu),n=e.errorCode===Js||e.errorCode===So,o=r&&n||e.errorCode===$u||e.errorCode===Ku,i=Tc.includes(t);return o&&i}(e,o);if(t){if(this.activeIframeRequest){if(5!==o){const[t,r]=this.activeIframeRequest;this.logger.verbose(`Iframe request is already in progress, awaiting resolution for request with correlationId: ${r}`,n.correlationId);const i=this.performanceClient.startMeasurement("awaitConcurrentIframe",n.correlationId);i.add({awaitIframeCorrelationId:r});const a=await t;if(i.end({success:a}),a)return this.logger.verbose(`Parallel iframe request with correlationId: ${r} succeeded. Retrying cache and/or RT redemption`,n.correlationId),this.acquireTokenSilentNoIframe(n,o);throw this.logger.info(`Iframe request with correlationId: ${r} failed. Interaction is required.`),e}return this.logger.warning("Another iframe request is currently in progress and CacheLookupPolicy is set to Skip. This may result in degraded performance and/or reliability for both calls. Please consider changing the CacheLookupPolicy to take advantage of request queuing and token cache.",n.correlationId),Lu(this.acquireTokenBySilentIframe.bind(this),Ra,this.logger,this.performanceClient,n.correlationId)(n)}{let e;return this.activeIframeRequest=[new kg(t=>{e=t}),n.correlationId],this.logger.verbose("Refresh token expired/invalid or CacheLookupPolicy is set to Skip, attempting acquire token by iframe.",n.correlationId),Lu(this.acquireTokenBySilentIframe.bind(this),Ra,this.logger,this.performanceClient,n.correlationId)(n).then(t=>(e(!0),t)).catch(t=>{throw e(!1),t}).finally(()=>{this.activeIframeRequest=void 0})}}throw e}).then(t=>(this.eventHandler.emitEvent(vd,wc.Silent,t),e.correlationId&&this.performanceClient.addFields({fromCache:t.fromCache,isNativeBroker:t.fromNativeBroker},e.correlationId),t)).catch(e=>{throw this.eventHandler.emitEvent(bd,wc.Silent,null,e),e}).finally(()=>{document.removeEventListener("visibilitychange",r)})}async acquireTokenSilentNoIframe(e,t){return eg(this.config,this.logger,this.platformAuthProvider,e.authenticationScheme)&&e.account.nativeAccountId?(this.logger.verbose("acquireTokenSilent - attempting to acquire token from native platform"),this.acquireTokenNative(e,61,e.account.nativeAccountId,t).catch(async e=>{if(e instanceof Fh&&Bh(e))throw this.logger.verbose("acquireTokenSilent - native platform unavailable, falling back to web flow"),this.platformAuthProvider=void 0,Ho(So);throw e})):(this.logger.verbose("acquireTokenSilent - attempting to acquire token from web flow"),1===t&&this.logger.verbose("acquireTokenSilent - cache lookup policy set to AccessToken, attempting to acquire token from local cache"),Lu(this.acquireTokenFromCache.bind(this),Ea,this.logger,this.performanceClient,e.correlationId)(e,t).catch(r=>{if(1===t)throw r;return this.eventHandler.emitEvent("msal:acquireTokenFromNetworkStart",wc.Silent,e),Lu(this.acquireTokenByRefreshToken.bind(this),aa,this.logger,this.performanceClient,e.correlationId)(e,t)}))}async preGeneratePkceCodes(e){return this.logger.verbose("Generating new PKCE codes"),this.pkceCode=await Lu(Vh,Is,this.logger,this.performanceClient,e)(this.performanceClient,this.logger,e),kg.resolve()}getPreGeneratedPkceCodes(e){this.logger.verbose("Attempting to pick up pre-generated PKCE codes");const t=this.pkceCode?{...this.pkceCode}:void 0;return this.pkceCode=void 0,this.logger.verbose((t?"Found":"Did not find")+" pre-generated PKCE codes"),this.performanceClient.addFields({usePreGeneratedPkce:!!t},e),t}logMultipleInstances(e){const t=this.config.auth.clientId;window&&(window.msal=window.msal||{},window.msal.clientIds=window.msal.clientIds||[],window.msal.clientIds.length>0&&this.logger.verbose("There is already an instance of MSAL.js in the window."),window.msal.clientIds.push(t),function(e,t,r){const n=window.msal?.clientIds||[],o=n.length,i=n.filter(t=>t===e).length;i>1&&r.warning("There is already an instance of MSAL.js in the window with the same client id."),t.add({msalInstanceCount:o,sameClientIdInstanceCount:i})}(t,e,this.logger))}}r(64583).Promise;class Sg{static async createPublicClientApplication(e){const t=await async function(e){const t=new Tu(e);return await t.initialize(),Tg.createController(t,void 0)}(e);return new Sg(e,t)}constructor(e,t){this.isBroker=!1,this.controller=t||new Tg(new Tu(e))}async initialize(e){return this.controller.initialize(e,this.isBroker)}async acquireTokenPopup(e){return this.controller.acquireTokenPopup(e)}acquireTokenRedirect(e){return this.controller.acquireTokenRedirect(e)}acquireTokenSilent(e){return this.controller.acquireTokenSilent(e)}acquireTokenByCode(e){return this.controller.acquireTokenByCode(e)}addEventCallback(e,t){return this.controller.addEventCallback(e,t)}removeEventCallback(e){return this.controller.removeEventCallback(e)}addPerformanceCallback(e){return this.controller.addPerformanceCallback(e)}removePerformanceCallback(e){return this.controller.removePerformanceCallback(e)}enableAccountStorageEvents(){this.controller.enableAccountStorageEvents()}disableAccountStorageEvents(){this.controller.disableAccountStorageEvents()}getAccount(e){return this.controller.getAccount(e)}getAccountByHomeId(e){return this.controller.getAccountByHomeId(e)}getAccountByLocalId(e){return this.controller.getAccountByLocalId(e)}getAccountByUsername(e){return this.controller.getAccountByUsername(e)}getAllAccounts(e){return this.controller.getAllAccounts(e)}handleRedirectPromise(e){return this.controller.handleRedirectPromise(e)}loginPopup(e){return this.controller.loginPopup(e)}loginRedirect(e){return this.controller.loginRedirect(e)}logout(e){return this.controller.logout(e)}logoutRedirect(e){return this.controller.logoutRedirect(e)}logoutPopup(e){return this.controller.logoutPopup(e)}ssoSilent(e){return this.controller.ssoSilent(e)}getTokenCache(){return this.controller.getTokenCache()}getLogger(){return this.controller.getLogger()}setLogger(e){this.controller.setLogger(e)}setActiveAccount(e){this.controller.setActiveAccount(e)}getActiveAccount(){return this.controller.getActiveAccount()}initializeWrapperLibrary(e,t){return this.controller.initializeWrapperLibrary(e,t)}setNavigationClient(e){this.controller.setNavigationClient(e)}getConfiguration(){return this.controller.getConfiguration()}async hydrateCache(e,t){return this.controller.hydrateCache(e,t)}clearCache(e){return this.controller.clearCache(e)}}var Eg=r(64583).Promise,_g=function(e,t,r,n){return new(r||(r=Eg))(function(o,i){function a(e){try{c(n.next(e))}catch(e){i(e)}}function s(e){try{c(n.throw(e))}catch(e){i(e)}}function c(e){var t;e.done?o(e.value):(t=e.value,t instanceof r?t:new r(function(e){e(t)})).then(a,s)}c((n=n.apply(e,t||[])).next())})},Pg=function(e,t){var r,n,o,i={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]},a=Object.create(("function"==typeof Iterator?Iterator:Object).prototype);return a.next=s(0),a.throw=s(1),a.return=s(2),"function"==typeof Symbol&&(a[Symbol.iterator]=function(){return this}),a;function s(s){return function(c){return function(s){if(r)throw new TypeError("Generator is already executing.");for(;a&&(a=0,s[0]&&(i=0)),i;)try{if(r=1,n&&(o=2&s[0]?n.return:s[0]?n.throw||((o=n.return)&&o.call(n),0):n.next)&&!(o=o.call(n,s[1])).done)return o;switch(n=0,o&&(s=[2&s[0],o.value]),s[0]){case 0:case 1:o=s;break;case 4:return i.label++,{value:s[1],done:!1};case 5:i.label++,n=s[1],s=[0];continue;case 7:s=i.ops.pop(),i.trys.pop();continue;default:if(!((o=(o=i.trys).length>0&&o[o.length-1])||6!==s[0]&&2!==s[0])){i=0;continue}if(3===s[0]&&(!o||s[1]>o[0]&&s[1]<o[3])){i.label=s[1];break}if(6===s[0]&&i.label<o[1]){i.label=o[1],o=s;break}if(o&&i.label<o[2]){i.label=o[2],i.ops.push(s);break}o[2]&&i.ops.pop(),i.trys.pop();continue}s=t.call(e,i)}catch(e){s=[6,e],n=0}finally{r=o=0}if(5&s[0])throw s[1];return{value:s[0]?s[1]:void 0,done:!0}}([s,c])}}},Rg=function(e,t,r){if(r||2===arguments.length)for(var n,o=0,i=t.length;o<i;o++)!n&&o in t||(n||(n=Array.prototype.slice.call(t,0,o)),n[o]=t[o]);return e.concat(n||Array.prototype.slice.call(t))},Og="8314c8ba-c25a-4a02-bf25-d6238949ac8f",Mg="5f59364d-9808-4d26-8e04-2527b4fc403e",Ng=new Sg({auth:{clientId:"a8f0615d-19b4-4c1d-b578-3f754d19e56c",authority:"https://login.microsoftonline.com/common",redirectUri:"https://electricsupply-addin.vercel.app/"},cache:{cacheLocation:"localStorage"}}),xg=function(){var e=(0,n.useState)(""),t=e[0],r=e[1],o=(0,n.useState)([]),i=o[0],a=o[1],s=(0,n.useState)([]),c=s[0],l=s[1],u=(0,n.useState)([]),d=u[0],h=u[1],g=(0,n.useState)(""),p=g[0],f=g[1];(0,n.useEffect)(function(){Office.onReady(function(e){return _g(void 0,void 0,void 0,function(){var t;return Pg(this,function(r){switch(r.label){case 0:return e.host!==Office.HostType.Outlook?[3,2]:[4,new Eg(function(e){var t=function(){var r,n;(null===(n=null===(r=Office.context)||void 0===r?void 0:r.mailbox)||void 0===n?void 0:n.item)?e():setTimeout(t,100)};t()})];case 1:r.sent(),(t=Office.context.mailbox.item).body.getAsync(Office.CoercionType.Html,function(e){return _g(void 0,void 0,void 0,function(){var r,n,o;return Pg(this,function(i){switch(i.label){case 0:return e.status!==Office.AsyncResultStatus.Succeeded?[3,3]:(r=e.value,n=r.match(/CONVERSATION_ID:([a-zA-Z0-9\-]+)/),(o=(null==n?void 0:n[1])||t.conversationId)?(f(o),[4,v(o)]):[3,2]);case 1:i.sent(),i.label=2;case 2:return[3,4];case 3:console.error("Failed to get body:",e.error),i.label=4;case 4:return[2]}})})}),r.label=2;case 2:return[2]}})})})},[]),(0,n.useEffect)(function(){y()},[]);var m=function(){return _g(void 0,void 0,void 0,function(){var e,t;return Pg(this,function(r){switch(r.label){case 0:return[4,_g(void 0,void 0,void 0,function(){return Pg(this,function(e){switch(e.label){case 0:return[4,Ng.initialize()];case 1:return e.sent(),[2]}})})];case 1:return r.sent(),0!==(e=Ng.getAllAccounts()).length?[3,3]:[4,Ng.loginPopup({scopes:["User.Read","Mail.ReadWrite","Sites.ReadWrite.All"]})];case 2:t=r.sent(),e=[t.account],r.label=3;case 3:return[4,Ng.acquireTokenSilent({scopes:["User.Read","Mail.ReadWrite","Sites.ReadWrite.All"],account:e[0]})];case 4:return[2,r.sent().accessToken]}})})},y=function(){return _g(void 0,void 0,void 0,function(){var e,t,r,n;return Pg(this,function(o){switch(o.label){case 0:return o.trys.push([0,4,,5]),[4,m()];case 1:return e=o.sent(),[4,fetch("https://graph.microsoft.com/v1.0/users?$top=50",{headers:{Authorization:"Bearer ".concat(e)}})];case 2:return[4,o.sent().json()];case 3:return t=o.sent(),r=t.value.map(function(e){return{id:e.mail||e.userPrincipalName,display:e.displayName,email:e.mail||e.userPrincipalName}}),l(r),[3,5];case 4:return n=o.sent(),console.error("Error fetching users:",n),[3,5];case 5:return[2]}})})},v=function(e){return _g(void 0,void 0,void 0,function(){var t,r,n,o,i,s,c,l,u,d;return Pg(this,function(h){switch(h.label){case 0:return(t=e||p)?[4,m()]:[2];case 1:return r=h.sent(),n=encodeURIComponent(t),o="https://graph.microsoft.com/v1.0/sites/".concat(Og,"/lists/").concat(Mg,"/items?expand=fields&$filter=fields/EmailID eq '").concat(n,"'&$orderby=createdDateTime asc"),[4,fetch(o,{headers:{Authorization:"Bearer ".concat(r)}})];case 2:return(i=h.sent()).ok?[3,4]:(c=(s=console).error,l=["Fetch comments failed:"],[4,i.text()]);case 3:return c.apply(s,l.concat([h.sent()])),[2];case 4:return[4,i.json()];case 5:return u=h.sent(),d=u.value.map(function(e){return e.fields}).sort(function(e,t){return new Date(e.CreatedDate).getTime()-new Date(t.CreatedDate).getTime()}),a(d),[2]}})})};return n.createElement("div",{style:{padding:"1rem",fontFamily:"Segoe UI, sans-serif",fontSize:"14px"}},n.createElement("h2",null,"Email Comment"),n.createElement("div",{style:{marginBottom:"1rem",background:"#f9f9f9",padding:"10px",borderRadius:"6px",maxHeight:"450px",overflowY:"auto"}},i.length>0?i.map(function(e,t){var r;return n.createElement("div",{key:t,style:{display:"flex",alignItems:"flex-start",marginBottom:"15px",padding:"10px",borderRadius:"8px",backgroundColor:"#f4f6f9"}},n.createElement("div",{style:{width:40,height:40,borderRadius:"50%",backgroundColor:"#dfe1e5",textAlign:"center",lineHeight:"30px",fontWeight:"bold",fontSize:"16px",marginRight:"10px"}},null===(r=e.CreatedBy)||void 0===r?void 0:r.charAt(0).toUpperCase()),n.createElement("div",null,n.createElement("div",{style:{fontWeight:600}},e.CreatedBy),n.createElement("div",{style:{margin:"5px 0"}},e.Comment),e.MentionedUsers&&n.createElement("div",{style:{fontSize:"12px"}},e.MentionedUsers.split(",").map(function(e,t){return n.createElement("span",{key:t,style:{backgroundColor:"#e6f0ff",color:"#1a73e8",padding:"2px 6px",borderRadius:"4px",marginRight:"5px"}},"@",e.trim())})),n.createElement("div",{style:{fontSize:"11px",color:"#888",marginTop:"4px"}},new Date(e.CreatedDate).toLocaleString())))}):n.createElement("div",{style:{color:"#888"}},"No comments yet.")),n.createElement("div",{style:{marginBottom:"10px",borderRadius:"10px"}},n.createElement(nn,{value:t,onChange:function(e){return r(e.target.value)},placeholder:"Add internal comment...",style:{control:{backgroundColor:"#fff",fontSize:14,padding:"8px",borderRadius:"10px",border:"1px solid #ccc",minHeight:"40px",maxHeight:"60px",overflowY:"auto"},input:{margin:0,paddingLeft:"10px",borderRadius:"10px",outline:"none",border:"none"},highlighter:{overflow:"hidden"},suggestions:{list:{backgroundColor:"#fff",border:"1px solid #ccc",fontSize:14},item:{padding:"5px 10px",borderBottom:"1px solid #eee","&focused":{backgroundColor:"#e6f0ff"}}}}},n.createElement(an,{trigger:"@",data:c,displayTransform:function(e,t){return"@".concat(t)},appendSpaceOnAdd:!0,onAdd:function(e){d.includes(e)||h(Rg(Rg([],d,!0),[e],!1))}}))),n.createElement("button",{onClick:function(){return _g(void 0,void 0,void 0,function(){return Pg(this,function(e){switch(e.label){case 0:return t.trim()?[4,_g(void 0,void 0,void 0,function(){var e,r,n,o,i,a;return Pg(this,function(s){switch(s.label){case 0:return[4,m()];case 1:return e=s.sent(),r=t.replace(/@\[[^\]]+\]\([^)]+\)/g,"").trim(),n=function(e){for(var t,r=/@\[([^\]]+)\]\(([^)]+)\)/g,n=[],o=[];null!==(t=r.exec(e));)n.push(t[1]),o.push(t[2]);return{displayNames:n,emails:o}}(t),o=n.displayNames,i=n.emails,a={Title:"Email Comment",EmailID:p,Comment:r,MentionedUsers:o.join(", "),CreatedBy:Office.context.mailbox.userProfile.displayName,CreatedDate:(new Date).toISOString()},[4,fetch("https://graph.microsoft.com/v1.0/sites/".concat(Og,"/lists/").concat(Mg,"/items"),{method:"POST",headers:{Authorization:"Bearer ".concat(e),"Content-Type":"application/json"},body:JSON.stringify({fields:a})})];case 2:return s.sent(),h(i),[2]}})})]:(alert("Please add a comment before saving."),[2]);case 1:return e.sent(),setTimeout(function(){return v()},1e3),d.length>0?[4,_g(void 0,void 0,void 0,function(){var e;return Pg(this,function(t){switch(t.label){case 0:return 0===d.length?[2]:[4,m()];case 1:return e=t.sent(),Office.context.mailbox.item.body.getAsync(Office.CoercionType.Html,function(t){return _g(void 0,void 0,void 0,function(){var r,n,o,i,a,s,c,l;return Pg(this,function(u){switch(u.label){case 0:return t.status!==Office.AsyncResultStatus.Succeeded?(console.error("Failed to get email body:",t.error),[2]):((r=t.value).includes("CONVERSATION_ID:")||(r+='<div style="display:none">CONVERSATION_ID:'.concat(p,"</div>")),n=Office.context.mailbox.item.subject,o=(null===(l=Office.context.mailbox.item.from)||void 0===l?void 0:l.emailAddress)||"noreply@domain.com",i=d.map(function(e){return{emailAddress:{address:e}}}),a={message:{subject:"FWD: ".concat(n),body:{contentType:"HTML",content:"\n            <p>Hello,</p>\n            <p>You were mentioned in a conversation. Here's the original email:</p>\n            <hr />\n            <p><strong>From:</strong> ".concat(o,"</p>\n            <p><strong>Subject:</strong> ").concat(n,"</p>\n            <hr />\n            ").concat(r,"\n            <hr />\n            <p>You can open the Outlook Add-in to view and add comments.</p>\n          ")},toRecipients:i},saveToSentItems:!0},[4,fetch("https://graph.microsoft.com/v1.0/me/sendMail",{method:"POST",headers:{Authorization:"Bearer ".concat(e),"Content-Type":"application/json"},body:JSON.stringify(a)})]);case 1:return(s=u.sent()).ok?[3,3]:[4,s.text()];case 2:return c=u.sent(),console.error("Failed to send mail:",c),[3,4];case 3:console.log("Successfully sent forward-style email to mentioned users."),u.label=4;case 4:return[2]}})})}),[2]}})})]:[3,3];case 2:e.sent(),e.label=3;case 3:return r(""),h([]),[2]}})})},style:{backgroundColor:"#0078D4",color:"#fff",border:"none",padding:"10px 16px",borderRadius:"5px",float:"right"}},"Send"))},Fg=function(){const e=function(e,t=a){const r=t();let n=null,o=null,i=null,s=null;return function(t){const{dir:a,renderer:c}=t;null===n&&([n,o]=function(e,t=""){const r={},n={};for(const o in e){const i=e[o],[a,s]=ut(i,t);r[o]=a,Object.keys(s).forEach(e=>{n[e]=(n[e]||[]).concat(s[e])})}return[r,n]}(e,c.classNameHashSalt));const l="ltr"===a;return l?null===i&&(i=gt(n,a)):null===s&&(s=gt(n,a)),r(c,o),l?i:s}}({root:{minHeight:"100vh"}},ft);return function(){const t=n.useContext(Tt),r=At();return e({dir:t,renderer:r})}}(),Bg=function(e){var t=Fg();return n.createElement("div",{className:t.root},n.createElement(xg,null))};const Dg=Symbol.for("fui.slotRenderFunction"),qg=Symbol.for("fui.slotElementType"),Lg=Symbol.for("fui.slotClassNameProp");function Hg(e){return Boolean(null==e?void 0:e.hasOwnProperty(qg))}function Ug(e,t){return function(r,n,o,i,a){return Hg(n)?t(function(e,t){return{...t,[qg]:e}}(r,n),null,o,i,a):Hg(r)?t(r,n,o,i,a):e(r,n,o,i,a)}}function jg(e){const{as:t,[Lg]:r,[qg]:n,[Dg]:o,...i}=e,a=i,s="string"==typeof n&&null!=t?t:n;return"string"!=typeof s&&t&&(a.as=t),{elementType:s,props:a,renderFunction:o}}r(44363);var $g=r(74848);const zg=r.t($g,2),Kg=Ug(zg.jsx,(e,t,r)=>{const{elementType:o,renderFunction:i,props:a}=jg(e),s={...a,...t};return i?zg.jsx(n.Fragment,{children:i(o,s)},r):zg.jsx(o,s,r)}),Wg=Ug(zg.jsxs,(e,t,r)=>{const{elementType:o,renderFunction:i,props:a}=jg(e),s={...a,...t};return i?zg.jsx(n.Fragment,{children:i(o,{...s,children:zg.jsxs(n.Fragment,{children:s.children},void 0)})},r):zg.jsxs(o,s,r)});function Gg(){return"undefined"!=typeof window&&!(!window.document||!window.document.createElement)}const Vg=n.createContext(void 0),Qg={targetDocument:"object"==typeof document?document:void 0,dir:"ltr"},Jg=Vg.Provider;function Yg(){var e;return null!==(e=n.useContext(Vg))&&void 0!==e?e:Qg}const Xg=n.createContext(void 0),Zg=Xg.Provider,ep=n.createContext(void 0).Provider,tp=n.createContext(void 0),rp=tp.Provider,np=n.createContext(void 0).Provider,op=n.createContext(void 0),ip=op.Provider,ap=n.createContext(void 0).Provider;function sp(e,t){var r;const n=e;var o;return Boolean((null==n||null===(r=n.ownerDocument)||void 0===r?void 0:r.defaultView)&&n instanceof n.ownerDocument.defaultView[null!==(o=null==t?void 0:t.constructorName)&&void 0!==o?o:"HTMLElement"])}var cp="undefined"!=typeof WeakRef,lp=class{constructor(e){cp&&"object"==typeof e?this._weakRef=new WeakRef(e):this._instance=e}deref(){var e,t;let r;return this._weakRef?(r=null==(e=this._weakRef)?void 0:e.deref(),r||delete this._weakRef):(r=this._instance,(null==(t=null==r?void 0:r.isDisposed)?void 0:t.call(r))&&delete this._instance),r}},up="keyborg:focusin",dp=!1,hp=0,gp=class{constructor(e,t){this._isNavigatingWithKeyboard_DO_NOT_USE=!1,this._onFocusIn=e=>{if(this._isMouseOrTouchUsedTimer)return;if(this.isNavigatingWithKeyboard)return;const t=e.detail;t.relatedTarget&&(t.isFocusedProgrammatically||void 0===t.isFocusedProgrammatically||(this.isNavigatingWithKeyboard=!0))},this._onMouseDown=e=>{0===e.buttons||0===e.clientX&&0===e.clientY&&0===e.screenX&&0===e.screenY||this._onMouseOrTouch()},this._onMouseOrTouch=()=>{const e=this._win;e&&(this._isMouseOrTouchUsedTimer&&e.clearTimeout(this._isMouseOrTouchUsedTimer),this._isMouseOrTouchUsedTimer=e.setTimeout(()=>{delete this._isMouseOrTouchUsedTimer},1e3)),this.isNavigatingWithKeyboard=!1},this._onKeyDown=e=>{this.isNavigatingWithKeyboard?this._shouldDismissKeyboardNavigation(e)&&this._scheduleDismiss():this._shouldTriggerKeyboardNavigation(e)&&(this.isNavigatingWithKeyboard=!0)},this.id="c"+ ++hp,this._win=e;const r=e.document;if(t){const e=t.triggerKeys,r=t.dismissKeys;(null==e?void 0:e.length)&&(this._triggerKeys=new Set(e)),(null==r?void 0:r.length)&&(this._dismissKeys=new Set(r))}r.addEventListener(up,this._onFocusIn,!0),r.addEventListener("mousedown",this._onMouseDown,!0),e.addEventListener("keydown",this._onKeyDown,!0),r.addEventListener("touchstart",this._onMouseOrTouch,!0),r.addEventListener("touchend",this._onMouseOrTouch,!0),r.addEventListener("touchcancel",this._onMouseOrTouch,!0),function(e){const t=e;dp||(dp=function(e){const t=e.HTMLElement,r=t.prototype.focus;let n=!1;return t.prototype.focus=function(){n=!0},e.document.createElement("button").focus(),t.prototype.focus=r,n}(t));const r=t.HTMLElement.prototype.focus;if(r.__keyborgNativeFocus)return;t.HTMLElement.prototype.focus=c;const n=new Set,o=e=>{const t=e.target;if(!t)return;const r=new CustomEvent("keyborg:focusout",{cancelable:!0,bubbles:!0,composed:!0,detail:{originalEvent:e}});t.dispatchEvent(r)},i=e=>{const t=e.target;if(!t)return;let r=e.composedPath()[0];const s=new Set;for(;r;)r.nodeType===Node.DOCUMENT_FRAGMENT_NODE?(s.add(r),r=r.host):r=r.parentNode;for(const e of n){const t=e.deref();t&&s.has(t)||(n.delete(e),t&&(t.removeEventListener("focusin",i,!0),t.removeEventListener("focusout",o,!0)))}a(t,e.relatedTarget||void 0)},a=(e,t,r)=>{var a;const c=e.shadowRoot;if(c){for(const e of n)if(e.deref()===c)return;return c.addEventListener("focusin",i,!0),c.addEventListener("focusout",o,!0),void n.add(new lp(c))}const l={relatedTarget:t,originalEvent:r},u=new CustomEvent(up,{cancelable:!0,bubbles:!0,composed:!0,detail:l});u.details=l,(dp||s.lastFocusedProgrammatically)&&(l.isFocusedProgrammatically=e===(null==(a=s.lastFocusedProgrammatically)?void 0:a.deref()),s.lastFocusedProgrammatically=void 0),e.dispatchEvent(u)},s=t.__keyborgData={focusInHandler:i,focusOutHandler:o,shadowTargets:n};function c(){const e=t.__keyborgData;return e&&(e.lastFocusedProgrammatically=new lp(this)),r.apply(this,arguments)}t.document.addEventListener("focusin",t.__keyborgData.focusInHandler,!0),t.document.addEventListener("focusout",t.__keyborgData.focusOutHandler,!0);let l=t.document.activeElement;for(;l&&l.shadowRoot;)a(l),l=l.shadowRoot.activeElement;c.__keyborgNativeFocus=r}(e)}get isNavigatingWithKeyboard(){return this._isNavigatingWithKeyboard_DO_NOT_USE}set isNavigatingWithKeyboard(e){this._isNavigatingWithKeyboard_DO_NOT_USE!==e&&(this._isNavigatingWithKeyboard_DO_NOT_USE=e,this.update())}dispose(){const e=this._win;if(e){this._isMouseOrTouchUsedTimer&&(e.clearTimeout(this._isMouseOrTouchUsedTimer),this._isMouseOrTouchUsedTimer=void 0),this._dismissTimer&&(e.clearTimeout(this._dismissTimer),this._dismissTimer=void 0),function(e){const t=e,r=t.HTMLElement.prototype,n=r.focus.__keyborgNativeFocus,o=t.__keyborgData;if(o){t.document.removeEventListener("focusin",o.focusInHandler,!0),t.document.removeEventListener("focusout",o.focusOutHandler,!0);for(const e of o.shadowTargets){const t=e.deref();t&&(t.removeEventListener("focusin",o.focusInHandler,!0),t.removeEventListener("focusout",o.focusOutHandler,!0))}o.shadowTargets.clear(),delete t.__keyborgData}n&&(r.focus=n)}(e);const t=e.document;t.removeEventListener(up,this._onFocusIn,!0),t.removeEventListener("mousedown",this._onMouseDown,!0),e.removeEventListener("keydown",this._onKeyDown,!0),t.removeEventListener("touchstart",this._onMouseOrTouch,!0),t.removeEventListener("touchend",this._onMouseOrTouch,!0),t.removeEventListener("touchcancel",this._onMouseOrTouch,!0),delete this._win}}isDisposed(){return!!this._win}update(){var e,t;const r=null==(t=null==(e=this._win)?void 0:e.__keyborg)?void 0:t.refs;if(r)for(const e of Object.keys(r))pp.update(r[e],this.isNavigatingWithKeyboard)}_shouldTriggerKeyboardNavigation(e){var t;if("Tab"===e.key)return!0;const r=null==(t=this._win)?void 0:t.document.activeElement,n=!this._triggerKeys||this._triggerKeys.has(e.keyCode),o=r&&("INPUT"===r.tagName||"TEXTAREA"===r.tagName||r.isContentEditable);return n&&!o}_shouldDismissKeyboardNavigation(e){var t;return null==(t=this._dismissKeys)?void 0:t.has(e.keyCode)}_scheduleDismiss(){const e=this._win;if(e){this._dismissTimer&&(e.clearTimeout(this._dismissTimer),this._dismissTimer=void 0);const t=e.document.activeElement;this._dismissTimer=e.setTimeout(()=>{this._dismissTimer=void 0;const r=e.document.activeElement;t&&r&&t===r&&(this.isNavigatingWithKeyboard=!1)},500)}}},pp=class e{constructor(e,t){this._cb=[],this._id="k"+ ++hp,this._win=e;const r=e.__keyborg;r?(this._core=r.core,r.refs[this._id]=this):(this._core=new gp(e,t),e.__keyborg={core:this._core,refs:{[this._id]:this}})}static create(t,r){return new e(t,r)}static dispose(e){e.dispose()}static update(e,t){e._cb.forEach(e=>e(t))}dispose(){var e;const t=null==(e=this._win)?void 0:e.__keyborg;(null==t?void 0:t.refs[this._id])&&(delete t.refs[this._id],0===Object.keys(t.refs).length&&(t.core.dispose(),delete this._win.__keyborg)),this._cb=[],delete this._core,delete this._win}isNavigatingWithKeyboard(){var e;return!!(null==(e=this._core)?void 0:e.isNavigatingWithKeyboard)}subscribe(e){this._cb.push(e)}unsubscribe(e){const t=this._cb.indexOf(e);t>=0&&this._cb.splice(t,1)}setVal(e){this._core&&(this._core.isNavigatingWithKeyboard=e)}};const fp="data-fui-focus-visible";function mp(e,t){if(yp(e))return()=>{};const r={current:void 0},n=(o=t,pp.create(o,undefined));var o;function i(e){n.isNavigatingWithKeyboard()&&sp(e)&&(r.current=e,e.setAttribute(fp,""))}function a(){r.current&&(r.current.removeAttribute(fp),r.current=void 0)}n.subscribe(e=>{e?i(t.document.activeElement):a()});const s=e=>{a(),i(e.composedPath()[0])},c=t=>{(!t.relatedTarget||sp(t.relatedTarget)&&!e.contains(t.relatedTarget))&&a()};return e.addEventListener(up,s),e.addEventListener("focusout",c),e.focusVisible=!0,e.contains(t.document.activeElement)&&i(t.document.activeElement),()=>{var t;a(),e.removeEventListener(up,s),e.removeEventListener("focusout",c),e.focusVisible=void 0,t=n,pp.dispose(t)}}function yp(e){return!!e&&(!!e.focusVisible||yp(null==e?void 0:e.parentElement))}function vp(e={}){const t=Yg(),r=n.useRef(null);var o;const i=null!==(o=e.targetDocument)&&void 0!==o?o:t.targetDocument;return n.useEffect(()=>{if((null==i?void 0:i.defaultView)&&r.current)return mp(r.current,i.defaultView)},[r,i]),r}function bp(e,t){const{defaultProps:r,elementType:o}=t,i=function(e){return"string"==typeof e||"number"==typeof e||Cp(e)||n.isValidElement(e)?{children:e}:e}(e),a={...r,...i,[qg]:o,[Lg]:null==i?void 0:i.className};return i&&"function"==typeof i.children&&(a[Dg]=i.children,a.children=null==r?void 0:r.children),a}const Cp=e=>"object"==typeof e&&null!==e&&Symbol.iterator in e,wp=(...e)=>{const t={};for(const r of e){const e=Array.isArray(r)?r:Object.keys(r);for(const r of e)t[r]=1}return t},kp=wp(["onAuxClick","onAnimationEnd","onAnimationStart","onCopy","onCut","onPaste","onCompositionEnd","onCompositionStart","onCompositionUpdate","onFocus","onFocusCapture","onBlur","onBlurCapture","onChange","onInput","onSubmit","onLoad","onError","onKeyDown","onKeyDownCapture","onKeyPress","onKeyUp","onAbort","onCanPlay","onCanPlayThrough","onDurationChange","onEmptied","onEncrypted","onEnded","onLoadedData","onLoadedMetadata","onLoadStart","onPause","onPlay","onPlaying","onProgress","onRateChange","onSeeked","onSeeking","onStalled","onSuspend","onTimeUpdate","onVolumeChange","onWaiting","onClick","onClickCapture","onContextMenu","onDoubleClick","onDrag","onDragEnd","onDragEnter","onDragExit","onDragLeave","onDragOver","onDragStart","onDrop","onMouseDown","onMouseDownCapture","onMouseEnter","onMouseLeave","onMouseMove","onMouseOut","onMouseOver","onMouseUp","onMouseUpCapture","onSelect","onTouchCancel","onTouchEnd","onTouchMove","onTouchStart","onScroll","onWheel","onPointerCancel","onPointerDown","onPointerEnter","onPointerLeave","onPointerMove","onPointerOut","onPointerOver","onPointerUp","onGotPointerCapture","onLostPointerCapture"]),Ip=wp(["accessKey","children","className","contentEditable","dir","draggable","hidden","htmlFor","id","lang","ref","role","style","tabIndex","title","translate","spellCheck","name"]),Ap=wp(["itemID","itemProp","itemRef","itemScope","itemType"]),Tp=wp(Ip,kp,Ap),Sp=wp(Tp,["form"]),Ep=wp(Tp,["height","loop","muted","preload","src","width"]),_p=wp(Ep,["poster"]),Pp=wp(Tp,["start"]),Rp=wp(Tp,["value"]),Op=wp(Tp,["download","href","hrefLang","media","rel","target","type"]),Mp=wp(Tp,["dateTime"]),Np=wp(Tp,["autoFocus","disabled","form","formAction","formEncType","formMethod","formNoValidate","formTarget","type","value"]),xp={label:Sp,audio:Ep,video:_p,ol:Pp,li:Rp,a:Op,button:Np,input:wp(Np,["accept","alt","autoCorrect","autoCapitalize","autoComplete","checked","dirname","form","height","inputMode","list","max","maxLength","min","minLength","multiple","pattern","placeholder","readOnly","required","src","step","size","type","value","width"]),textarea:wp(Np,["autoCapitalize","cols","dirname","form","maxLength","placeholder","readOnly","required","rows","wrap"]),select:wp(Np,["form","multiple","required"]),option:wp(Tp,["selected","value"]),table:wp(Tp,["cellPadding","cellSpacing"]),tr:Tp,th:wp(Tp,["colSpan","rowSpan","scope"]),td:wp(Tp,["colSpan","headers","rowSpan","scope"]),colGroup:wp(Tp,["span"]),col:wp(Tp,["span"]),fieldset:wp(Tp,["disabled","form"]),form:wp(Tp,["acceptCharset","action","encType","encType","method","noValidate","target"]),iframe:wp(Tp,["allow","allowFullScreen","allowPaymentRequest","allowTransparency","csp","height","importance","referrerPolicy","sandbox","src","srcDoc","width"]),img:wp(Tp,["alt","crossOrigin","height","src","srcSet","useMap","width"]),time:Mp,dialog:wp(Tp,["open","onCancel","onClose"])};const Fp=(e,t,r)=>{var n;return function(e,t,r){const n=e&&xp[e]||Tp;return n.as=1,function(e,t,r){const n=Array.isArray(t),o={},i=Object.keys(e);for(const a of i)!(!n&&t[a]||n&&t.indexOf(a)>=0||0===a.indexOf("data-")||0===a.indexOf("aria-"))||r&&-1!==(null==r?void 0:r.indexOf(a))||(o[a]=e[a]);return o}(t,n,r)}(null!==(n=t.as)&&void 0!==n?n:e,t,r)};function Bp(...e){const t=n.useCallback(r=>{t.current=r;for(const t of e)"function"==typeof t?t(r):t&&(t.current=r)},[...e]);return t}const Dp=Gg()?n.useLayoutEffect:n.useEffect,qp={current:0},Lp=n.createContext(void 0);const Hp=n.createContext(void 0);function Up(e="fui-",t){const r=null!==(s=n.useContext(Lp))&&void 0!==s?s:qp,i=n.useContext(Hp)||"",a=o.useId;var s;if(a){const r=a(),o=n.useMemo(()=>r.replace(/:/g,""),[r]);return t||`${i}${e}${o}`}return n.useMemo(()=>t||`${i}${e}${++r.current}`,[i,e,t,r])}function jp(e,t,r=a){const n=r();let o=null,i=null;return function(r){const{dir:a,renderer:s}=r,c="ltr"===a;return c?null===o&&(o=gt(e,a)):null===i&&(i=gt(e,a)),n(s,t),c?o:i}}Hp.Provider;const $p={},zp="fui-FluentProvider",Kp=jp({root:{sj55zd:"f19n0e5",De3pzq:"fxugw4r",fsow6f:["f1o700av","fes3tcz"],Bahqtrf:"fk6fouc",Be2twd7:"fkhj508",Bhrd7zp:"figsok6",Bg96gwp:"f1i3iumi"}},{d:[".f19n0e5{color:var(--colorNeutralForeground1);}",".fxugw4r{background-color:var(--colorNeutralBackground1);}",".f1o700av{text-align:left;}",".fes3tcz{text-align:right;}",".fk6fouc{font-family:var(--fontFamilyBase);}",".fkhj508{font-size:var(--fontSizeBase300);}",".figsok6{font-weight:var(--fontWeightRegular);}",".f1i3iumi{line-height:var(--lineHeightBase300);}"]}),Wp=o.useInsertionEffect?o.useInsertionEffect:Dp,Gp={},Vp={},Qp=(e,t)=>{const r=Yg(),o=n.useContext(Xg),i=null!==(a=n.useContext(op))&&void 0!==a?a:{};var a;const s=n.useContext(tp)||Gp,{applyStylesToPortals:c=!0,customStyleHooks_unstable:l,dir:u=r.dir,targetDocument:d=r.targetDocument,theme:h,overrides_unstable:g={}}=e,p=Jp(o,h),f=Jp(i,g),m=Jp(s,l),y=At();var v;const{styleTagId:b,rule:C}=(e=>{const{targetDocument:t,theme:r,rendererAttributes:o}=e,i=n.useRef(),a=Up(zp),s=o,c=n.useMemo(()=>function(e,t){return t?`${e} { ${Object.keys(t).reduce((e,r)=>`${e}--${r}: ${t[r]}; `,"")} }`:`${e} {}`}(`.${a}`,r),[r,a]);return function(e,t){n.useState(()=>{if(!e)return;const r=e.getElementById(t);r&&e.head.append(r)})}(t,a),Wp(()=>{const e=null==t?void 0:t.getElementById(a);return e?i.current=e:(i.current=((e,t)=>{if(!(null==e?void 0:e.head))return;const r=e.createElement("style");return Object.keys(t).forEach(e=>{r.setAttribute(e,t[e])}),e.head.appendChild(r),r})(t,{...s,id:a}),i.current&&((e,t)=>{const r=e.sheet;r&&(r.cssRules.length>0&&r.deleteRule(0),r.insertRule(t,0))})(i.current,c)),()=>{var e;null===(e=i.current)||void 0===e||e.remove()}},[a,t,c,s]),{styleTagId:a,rule:c}})({theme:p,targetDocument:d,rendererAttributes:null!==(v=y.styleElementAttributes)&&void 0!==v?v:Vp});return{applyStylesToPortals:c,customStyleHooks_unstable:m,dir:u,targetDocument:d,theme:p,overrides_unstable:f,themeClassName:b,components:{root:"div"},root:bp(Fp("div",{...e,dir:u,ref:Bp(t,vp({targetDocument:d}))}),{elementType:"div"}),serverStyleProps:{cssRule:C,attributes:{...y.styleElementAttributes,id:b}}}};function Jp(e,t){return e&&t?{...e,...t}:e||t}const Yp=n.forwardRef((e,t)=>{const r=Qp(e,t);(e=>{const t=At(),r=Kp({dir:e.dir,renderer:t});e.root.className=function(){let e=null,t="",r="";const n=new Array(arguments.length);for(let e=0;e<arguments.length;e++){const o=arguments[e];if("string"==typeof o&&""!==o){const i=o.indexOf("___");if(-1===i)t+=o+" ";else{const a=o.substr(i,10);i>0&&(t+=o.slice(0,i)),r+=a,n[e]=a}}}if(""===r)return t.slice(0,-1);const o=$p[r];if(void 0!==o)return t+o;const i=[];for(let t=0;t<arguments.length;t++){const r=n[t];if(r){const t=T[r];t&&(i.push(t[0]),e=t[1])}}const a=Object.assign.apply(Object,[{}].concat(i)),[s,c]=ht(a,e),l=dt(c,e,n),u=l+" "+s;return $p[r]=u,T[l]=[a,e],t+u}(zp,e.themeClassName,r.root,e.root.className)})(r);const o=function(e){const{applyStylesToPortals:t,customStyleHooks_unstable:r,dir:o,root:i,targetDocument:a,theme:s,themeClassName:c,overrides_unstable:l}=e,u=n.useMemo(()=>({dir:o,targetDocument:a}),[o,a]),[d]=n.useState(()=>({})),h=n.useMemo(()=>({textDirection:o}),[o]);return{customStyleHooks_unstable:r,overrides_unstable:l,provider:u,textDirection:o,iconDirection:h,tooltip:d,theme:s,themeClassName:t?i.className:c}}(r);return((e,t)=>Kg(Jg,{value:t.provider,children:Kg(Zg,{value:t.theme,children:Kg(ep,{value:t.themeClassName,children:Kg(rp,{value:t.customStyleHooks_unstable,children:Kg(np,{value:t.tooltip,children:Kg(St,{dir:t.textDirection,children:Kg(ap,{value:t.iconDirection,children:Kg(ip,{value:t.overrides_unstable,children:Wg(e.root,{children:[Gg()?null:Kg("style",{dangerouslySetInnerHTML:{__html:e.serverStyleProps.cssRule},...e.serverStyleProps.attributes}),e.root.children]})})})})})})})})}))(r,o)});Yp.displayName="FluentProvider";const Xp="#242424",Zp="#424242",ef="#616161",tf="#bdbdbd",rf="#e0e0e0",nf="#e6e6e6",of="#ebebeb",af="#f0f0f0",sf="#f5f5f5",cf="#fafafa",lf="rgba(255, 255, 255, 0.4)",uf="rgba(255, 255, 255, 0.5)",df="rgba(0, 0, 0, 0.05)",hf="rgba(0, 0, 0, 0.1)",gf="#ffffff",pf={shade50:"#200205",shade40:"#3b0509",shade30:"#6e0811",shade20:"#960b18",shade10:"#b10e1c",primary:"#c50f1f",tint10:"#cc2635",tint20:"#d33f4c",tint30:"#dc626d",tint40:"#eeacb2",tint50:"#f6d1d5",tint60:"#fdf3f4"},ff={shade50:"#031403",shade40:"#052505",shade30:"#094509",shade20:"#0c5e0c",shade10:"#0e700e",primary:"#107c10",tint10:"#218c21",tint20:"#359b35",tint30:"#54b054",tint40:"#9fd89f",tint50:"#c9eac9",tint60:"#f1faf1"},mf={red:{shade50:"#210809",shade40:"#3f1011",shade30:"#751d1f",shade20:"#9f282b",shade10:"#bc2f32",primary:"#d13438",tint10:"#d7494c",tint20:"#dc5e62",tint30:"#e37d80",tint40:"#f1bbbc",tint50:"#f8dadb",tint60:"#fdf6f6"},green:ff,darkOrange:{shade50:"#230900",shade40:"#411200",shade30:"#7a2101",shade20:"#a62d01",shade10:"#c43501",primary:"#da3b01",tint10:"#de501c",tint20:"#e36537",tint30:"#e9835e",tint40:"#f4bfab",tint50:"#f9dcd1",tint60:"#fdf6f3"},yellow:{shade50:"#282400",shade40:"#4c4400",shade30:"#817400",shade20:"#c0ad00",shade10:"#e4cc00",primary:"#fde300",tint10:"#fde61e",tint20:"#fdea3d",tint30:"#feee66",tint40:"#fef7b2",tint50:"#fffad6",tint60:"#fffef5"},berry:{shade50:"#1f091d",shade40:"#3a1136",shade30:"#6d2064",shade20:"#932b88",shade10:"#af33a1",primary:"#c239b3",tint10:"#c94cbc",tint20:"#d161c4",tint30:"#da7ed0",tint40:"#edbbe7",tint50:"#f5daf2",tint60:"#fdf5fc"},lightGreen:{shade50:"#031a02",shade40:"#063004",shade30:"#0b5a08",shade20:"#0e7a0b",shade10:"#11910d",primary:"#13a10e",tint10:"#27ac22",tint20:"#3db838",tint30:"#5ec75a",tint40:"#a7e3a5",tint50:"#cef0cd",tint60:"#f2fbf2"},marigold:{shade50:"#251a00",shade40:"#463100",shade30:"#835b00",shade20:"#b27c00",shade10:"#d39300",primary:"#eaa300",tint10:"#edad1c",tint20:"#efb839",tint30:"#f2c661",tint40:"#f9e2ae",tint50:"#fcefd3",tint60:"#fefbf4"}},yf={darkRed:{shade50:"#130204",shade40:"#230308",shade30:"#420610",shade20:"#590815",shade10:"#690a19",primary:"#750b1c",tint10:"#861b2c",tint20:"#962f3f",tint30:"#ac4f5e",tint40:"#d69ca5",tint50:"#e9c7cd",tint60:"#f9f0f2"},cranberry:pf,pumpkin:{shade50:"#200d03",shade40:"#3d1805",shade30:"#712d09",shade20:"#9a3d0c",shade10:"#b6480e",primary:"#ca5010",tint10:"#d06228",tint20:"#d77440",tint30:"#df8e64",tint40:"#efc4ad",tint50:"#f7dfd2",tint60:"#fdf7f4"},peach:{shade50:"#291600",shade40:"#4d2a00",shade30:"#8f4e00",shade20:"#c26a00",shade10:"#e67e00",primary:"#ff8c00",tint10:"#ff9a1f",tint20:"#ffa83d",tint30:"#ffba66",tint40:"#ffddb3",tint50:"#ffedd6",tint60:"#fffaf5"},gold:{shade50:"#1f1900",shade40:"#3a2f00",shade30:"#6c5700",shade20:"#937700",shade10:"#ae8c00",primary:"#c19c00",tint10:"#c8a718",tint20:"#d0b232",tint30:"#dac157",tint40:"#ecdfa5",tint50:"#f5eece",tint60:"#fdfbf2"},brass:{shade50:"#181202",shade40:"#2e2103",shade30:"#553e06",shade20:"#745408",shade10:"#89640a",primary:"#986f0b",tint10:"#a47d1e",tint20:"#b18c34",tint30:"#c1a256",tint40:"#e0cea2",tint50:"#efe4cb",tint60:"#fbf8f2"},brown:{shade50:"#170e07",shade40:"#2b1a0e",shade30:"#50301a",shade20:"#6c4123",shade10:"#804d29",primary:"#8e562e",tint10:"#9c663f",tint20:"#a97652",tint30:"#bb8f6f",tint40:"#ddc3b0",tint50:"#edded3",tint60:"#faf7f4"},forest:{shade50:"#0c1501",shade40:"#162702",shade30:"#294903",shade20:"#376304",shade10:"#427505",primary:"#498205",tint10:"#599116",tint20:"#6ba02b",tint30:"#85b44c",tint40:"#bdd99b",tint50:"#dbebc7",tint60:"#f6faf0"},seafoam:{shade50:"#002111",shade40:"#003d20",shade30:"#00723b",shade20:"#009b51",shade10:"#00b85f",primary:"#00cc6a",tint10:"#19d279",tint20:"#34d889",tint30:"#5ae0a0",tint40:"#a8f0cd",tint50:"#cff7e4",tint60:"#f3fdf8"},darkGreen:{shade50:"#021102",shade40:"#032003",shade30:"#063b06",shade20:"#085108",shade10:"#0a5f0a",primary:"#0b6a0b",tint10:"#1a7c1a",tint20:"#2d8e2d",tint30:"#4da64d",tint40:"#9ad29a",tint50:"#c6e7c6",tint60:"#f0f9f0"},lightTeal:{shade50:"#001d1f",shade40:"#00373a",shade30:"#00666d",shade20:"#008b94",shade10:"#00a5af",primary:"#00b7c3",tint10:"#18bfca",tint20:"#32c8d1",tint30:"#58d3db",tint40:"#a6e9ed",tint50:"#cef3f5",tint60:"#f2fcfd"},teal:{shade50:"#001516",shade40:"#012728",shade30:"#02494c",shade20:"#026467",shade10:"#037679",primary:"#038387",tint10:"#159195",tint20:"#2aa0a4",tint30:"#4cb4b7",tint40:"#9bd9db",tint50:"#c7ebec",tint60:"#f0fafa"},steel:{shade50:"#000f12",shade40:"#001b22",shade30:"#00333f",shade20:"#004555",shade10:"#005265",primary:"#005b70",tint10:"#0f6c81",tint20:"#237d92",tint30:"#4496a9",tint40:"#94c8d4",tint50:"#c3e1e8",tint60:"#eff7f9"},blue:{shade50:"#001322",shade40:"#002440",shade30:"#004377",shade20:"#005ba1",shade10:"#006cbf",primary:"#0078d4",tint10:"#1a86d9",tint20:"#3595de",tint30:"#5caae5",tint40:"#a9d3f2",tint50:"#d0e7f8",tint60:"#f3f9fd"},royalBlue:{shade50:"#000c16",shade40:"#00172a",shade30:"#002c4e",shade20:"#003b6a",shade10:"#00467e",primary:"#004e8c",tint10:"#125e9a",tint20:"#286fa8",tint30:"#4a89ba",tint40:"#9abfdc",tint50:"#c7dced",tint60:"#f0f6fa"},cornflower:{shade50:"#0d1126",shade40:"#182047",shade30:"#2c3c85",shade20:"#3c51b4",shade10:"#4760d5",primary:"#4f6bed",tint10:"#637cef",tint20:"#778df1",tint30:"#93a4f4",tint40:"#c8d1fa",tint50:"#e1e6fc",tint60:"#f7f9fe"},navy:{shade50:"#00061d",shade40:"#000c36",shade30:"#001665",shade20:"#001e89",shade10:"#0023a2",primary:"#0027b4",tint10:"#173bbd",tint20:"#3050c6",tint30:"#546fd2",tint40:"#a3b2e8",tint50:"#ccd5f3",tint60:"#f2f4fc"},lavender:{shade50:"#120f25",shade40:"#221d46",shade30:"#3f3682",shade20:"#5649b0",shade10:"#6656d1",primary:"#7160e8",tint10:"#8172eb",tint20:"#9184ee",tint30:"#a79cf1",tint40:"#d2ccf8",tint50:"#e7e4fb",tint60:"#f9f8fe"},purple:{shade50:"#0f0717",shade40:"#1c0e2b",shade30:"#341a51",shade20:"#46236e",shade10:"#532982",primary:"#5c2e91",tint10:"#6b3f9e",tint20:"#7c52ab",tint30:"#9470bd",tint40:"#c6b1de",tint50:"#e0d3ed",tint60:"#f7f4fb"},grape:{shade50:"#160418",shade40:"#29072e",shade30:"#4c0d55",shade20:"#671174",shade10:"#7a1589",primary:"#881798",tint10:"#952aa4",tint20:"#a33fb1",tint30:"#b55fc1",tint40:"#d9a7e0",tint50:"#eaceef",tint60:"#faf2fb"},lilac:{shade50:"#1c0b1f",shade40:"#35153a",shade30:"#63276d",shade20:"#863593",shade10:"#9f3faf",primary:"#b146c2",tint10:"#ba58c9",tint20:"#c36bd1",tint30:"#cf87da",tint40:"#e6bfed",tint50:"#f2dcf5",tint60:"#fcf6fd"},pink:{shade50:"#24091b",shade40:"#441232",shade30:"#80215d",shade20:"#ad2d7e",shade10:"#cd3595",primary:"#e43ba6",tint10:"#e750b0",tint20:"#ea66ba",tint30:"#ef85c8",tint40:"#f7c0e3",tint50:"#fbddf0",tint60:"#fef6fb"},magenta:{shade50:"#1f0013",shade40:"#390024",shade30:"#6b0043",shade20:"#91005a",shade10:"#ac006b",primary:"#bf0077",tint10:"#c71885",tint20:"#ce3293",tint30:"#d957a8",tint40:"#eca5d1",tint50:"#f5cee6",tint60:"#fcf2f9"},plum:{shade50:"#13000c",shade40:"#240017",shade30:"#43002b",shade20:"#5a003b",shade10:"#6b0045",primary:"#77004d",tint10:"#87105d",tint20:"#98246f",tint30:"#ad4589",tint40:"#d696c0",tint50:"#e9c4dc",tint60:"#faf0f6"},beige:{shade50:"#141313",shade40:"#252323",shade30:"#444241",shade20:"#5d5958",shade10:"#6e6968",primary:"#7a7574",tint10:"#8a8584",tint20:"#9a9594",tint30:"#afabaa",tint40:"#d7d4d4",tint50:"#eae8e8",tint60:"#faf9f9"},mink:{shade50:"#0f0e0e",shade40:"#1c1b1a",shade30:"#343231",shade20:"#474443",shade10:"#54514f",primary:"#5d5a58",tint10:"#706d6b",tint20:"#84817e",tint30:"#9e9b99",tint40:"#cecccb",tint50:"#e5e4e3",tint60:"#f8f8f8"},platinum:{shade50:"#111314",shade40:"#1f2426",shade30:"#3b4447",shade20:"#505c60",shade10:"#5f6d71",primary:"#69797e",tint10:"#79898d",tint20:"#89989d",tint30:"#a0adb2",tint40:"#cdd6d8",tint50:"#e4e9ea",tint60:"#f8f9fa"},anchor:{shade50:"#090a0b",shade40:"#111315",shade30:"#202427",shade20:"#2b3135",shade10:"#333a3f",primary:"#394146",tint10:"#4d565c",tint20:"#626c72",tint30:"#808a90",tint40:"#bcc3c7",tint50:"#dbdfe1",tint60:"#f6f7f8"}},vf={cranberry:pf,green:ff,orange:{shade50:"#271002",shade40:"#4a1e04",shade30:"#8a3707",shade20:"#bc4b09",shade10:"#de590b",primary:"#f7630c",tint10:"#f87528",tint20:"#f98845",tint30:"#faa06b",tint40:"#fdcfb4",tint50:"#fee5d7",tint60:"#fff9f5"}},bf={success:"green",warning:"orange",danger:"cranberry"},Cf=["red","green","darkOrange","yellow","berry","lightGreen","marigold"].reduce((e,t)=>{const r=t.slice(0,1).toUpperCase()+t.slice(1),n={[`colorPalette${r}Background1`]:mf[t].tint60,[`colorPalette${r}Background2`]:mf[t].tint40,[`colorPalette${r}Background3`]:mf[t].primary,[`colorPalette${r}Foreground1`]:mf[t].shade10,[`colorPalette${r}Foreground2`]:mf[t].shade30,[`colorPalette${r}Foreground3`]:mf[t].primary,[`colorPalette${r}BorderActive`]:mf[t].primary,[`colorPalette${r}Border1`]:mf[t].tint40,[`colorPalette${r}Border2`]:mf[t].primary};return Object.assign(e,n)},{});Cf.colorPaletteYellowForeground1=mf.yellow.shade30,Cf.colorPaletteRedForegroundInverted=mf.red.tint20,Cf.colorPaletteGreenForegroundInverted=mf.green.tint20,Cf.colorPaletteYellowForegroundInverted=mf.yellow.tint40;const wf=["darkRed","cranberry","pumpkin","peach","gold","brass","brown","forest","seafoam","darkGreen","lightTeal","teal","steel","blue","royalBlue","cornflower","navy","lavender","purple","grape","lilac","pink","magenta","plum","beige","mink","platinum","anchor"].reduce((e,t)=>{const r=t.slice(0,1).toUpperCase()+t.slice(1),n={[`colorPalette${r}Background2`]:yf[t].tint40,[`colorPalette${r}Foreground2`]:yf[t].shade30,[`colorPalette${r}BorderActive`]:yf[t].primary};return Object.assign(e,n)},{}),kf={...Cf,...wf},If=Object.entries(bf).reduce((e,[t,r])=>{const n=t.slice(0,1).toUpperCase()+t.slice(1),o={[`colorStatus${n}Background1`]:vf[r].tint60,[`colorStatus${n}Background2`]:vf[r].tint40,[`colorStatus${n}Background3`]:vf[r].primary,[`colorStatus${n}Foreground1`]:vf[r].shade10,[`colorStatus${n}Foreground2`]:vf[r].shade30,[`colorStatus${n}Foreground3`]:vf[r].primary,[`colorStatus${n}ForegroundInverted`]:vf[r].tint30,[`colorStatus${n}BorderActive`]:vf[r].primary,[`colorStatus${n}Border1`]:vf[r].tint40,[`colorStatus${n}Border2`]:vf[r].primary};return Object.assign(e,o)},{});If.colorStatusDangerBackground3Hover=vf[bf.danger].shade10,If.colorStatusDangerBackground3Pressed=vf[bf.danger].shade20,If.colorStatusWarningForeground1=vf[bf.warning].shade20,If.colorStatusWarningForeground3=vf[bf.warning].shade20,If.colorStatusWarningBorder2=vf[bf.warning].shade20;const Af={borderRadiusNone:"0",borderRadiusSmall:"2px",borderRadiusMedium:"4px",borderRadiusLarge:"6px",borderRadiusXLarge:"8px",borderRadiusCircular:"10000px"},Tf={fontSizeBase100:"10px",fontSizeBase200:"12px",fontSizeBase300:"14px",fontSizeBase400:"16px",fontSizeBase500:"20px",fontSizeBase600:"24px",fontSizeHero700:"28px",fontSizeHero800:"32px",fontSizeHero900:"40px",fontSizeHero1000:"68px"},Sf={lineHeightBase100:"14px",lineHeightBase200:"16px",lineHeightBase300:"20px",lineHeightBase400:"22px",lineHeightBase500:"28px",lineHeightBase600:"32px",lineHeightHero700:"36px",lineHeightHero800:"40px",lineHeightHero900:"52px",lineHeightHero1000:"92px"},Ef={fontWeightRegular:400,fontWeightMedium:500,fontWeightSemibold:600,fontWeightBold:700},_f={fontFamilyBase:"'Segoe UI', 'Segoe UI Web (West European)', -apple-system, BlinkMacSystemFont, Roboto, 'Helvetica Neue', sans-serif",fontFamilyMonospace:"Consolas, 'Courier New', Courier, monospace",fontFamilyNumeric:"Bahnschrift, 'Segoe UI', 'Segoe UI Web (West European)', -apple-system, BlinkMacSystemFont, Roboto, 'Helvetica Neue', sans-serif"},Pf={strokeWidthThin:"1px",strokeWidthThick:"2px",strokeWidthThicker:"3px",strokeWidthThickest:"4px"};function Rf(e,t,r=""){return{[`shadow2${r}`]:`0 0 2px ${e}, 0 1px 2px ${t}`,[`shadow4${r}`]:`0 0 2px ${e}, 0 2px 4px ${t}`,[`shadow8${r}`]:`0 0 2px ${e}, 0 4px 8px ${t}`,[`shadow16${r}`]:`0 0 2px ${e}, 0 8px 16px ${t}`,[`shadow28${r}`]:`0 0 8px ${e}, 0 14px 28px ${t}`,[`shadow64${r}`]:`0 0 8px ${e}, 0 32px 64px ${t}`}}const Of={durationUltraFast:"50ms",durationFaster:"100ms",durationFast:"150ms",durationNormal:"200ms",durationGentle:"250ms",durationSlow:"300ms",durationSlower:"400ms",durationUltraSlow:"500ms"},Mf={curveAccelerateMax:"cubic-bezier(0.9,0.1,1,0.2)",curveAccelerateMid:"cubic-bezier(1,0,1,1)",curveAccelerateMin:"cubic-bezier(0.8,0,0.78,1)",curveDecelerateMax:"cubic-bezier(0.1,0.9,0.2,1)",curveDecelerateMid:"cubic-bezier(0,0,0,1)",curveDecelerateMin:"cubic-bezier(0.33,0,0.1,1)",curveEasyEaseMax:"cubic-bezier(0.8,0,0.2,1)",curveEasyEase:"cubic-bezier(0.33,0,0.67,1)",curveLinear:"cubic-bezier(0,0,1,1)"},Nf="10px",xf="12px",Ff="16px",Bf="20px",Df="24px",qf="32px",Lf={spacingHorizontalNone:"0",spacingHorizontalXXS:"2px",spacingHorizontalXS:"4px",spacingHorizontalSNudge:"6px",spacingHorizontalS:"8px",spacingHorizontalMNudge:Nf,spacingHorizontalM:xf,spacingHorizontalL:Ff,spacingHorizontalXL:Bf,spacingHorizontalXXL:Df,spacingHorizontalXXXL:qf},Hf={spacingVerticalNone:"0",spacingVerticalXXS:"2px",spacingVerticalXS:"4px",spacingVerticalSNudge:"6px",spacingVerticalS:"8px",spacingVerticalMNudge:Nf,spacingVerticalM:xf,spacingVerticalL:Ff,spacingVerticalXL:Bf,spacingVerticalXXL:Df,spacingVerticalXXXL:qf},Uf=(()=>{const e=(e=>({colorNeutralForeground1:Xp,colorNeutralForeground1Hover:Xp,colorNeutralForeground1Pressed:Xp,colorNeutralForeground1Selected:Xp,colorNeutralForeground2:Zp,colorNeutralForeground2Hover:Xp,colorNeutralForeground2Pressed:Xp,colorNeutralForeground2Selected:Xp,colorNeutralForeground2BrandHover:e[80],colorNeutralForeground2BrandPressed:e[70],colorNeutralForeground2BrandSelected:e[80],colorNeutralForeground3:ef,colorNeutralForeground3Hover:Zp,colorNeutralForeground3Pressed:Zp,colorNeutralForeground3Selected:Zp,colorNeutralForeground3BrandHover:e[80],colorNeutralForeground3BrandPressed:e[70],colorNeutralForeground3BrandSelected:e[80],colorNeutralForeground4:"#707070",colorNeutralForegroundDisabled:tf,colorNeutralForegroundInvertedDisabled:lf,colorBrandForegroundLink:e[70],colorBrandForegroundLinkHover:e[60],colorBrandForegroundLinkPressed:e[40],colorBrandForegroundLinkSelected:e[70],colorNeutralForeground2Link:Zp,colorNeutralForeground2LinkHover:Xp,colorNeutralForeground2LinkPressed:Xp,colorNeutralForeground2LinkSelected:Xp,colorCompoundBrandForeground1:e[80],colorCompoundBrandForeground1Hover:e[70],colorCompoundBrandForeground1Pressed:e[60],colorBrandForeground1:e[80],colorBrandForeground2:e[70],colorBrandForeground2Hover:e[60],colorBrandForeground2Pressed:e[30],colorNeutralForeground1Static:Xp,colorNeutralForegroundStaticInverted:gf,colorNeutralForegroundInverted:gf,colorNeutralForegroundInvertedHover:gf,colorNeutralForegroundInvertedPressed:gf,colorNeutralForegroundInvertedSelected:gf,colorNeutralForegroundInverted2:gf,colorNeutralForegroundOnBrand:gf,colorNeutralForegroundInvertedLink:gf,colorNeutralForegroundInvertedLinkHover:gf,colorNeutralForegroundInvertedLinkPressed:gf,colorNeutralForegroundInvertedLinkSelected:gf,colorBrandForegroundInverted:e[100],colorBrandForegroundInvertedHover:e[110],colorBrandForegroundInvertedPressed:e[100],colorBrandForegroundOnLight:e[80],colorBrandForegroundOnLightHover:e[70],colorBrandForegroundOnLightPressed:e[50],colorBrandForegroundOnLightSelected:e[60],colorNeutralBackground1:gf,colorNeutralBackground1Hover:sf,colorNeutralBackground1Pressed:rf,colorNeutralBackground1Selected:of,colorNeutralBackground2:cf,colorNeutralBackground2Hover:af,colorNeutralBackground2Pressed:"#dbdbdb",colorNeutralBackground2Selected:nf,colorNeutralBackground3:sf,colorNeutralBackground3Hover:of,colorNeutralBackground3Pressed:"#d6d6d6",colorNeutralBackground3Selected:rf,colorNeutralBackground4:af,colorNeutralBackground4Hover:cf,colorNeutralBackground4Pressed:sf,colorNeutralBackground4Selected:gf,colorNeutralBackground5:of,colorNeutralBackground5Hover:sf,colorNeutralBackground5Pressed:af,colorNeutralBackground5Selected:cf,colorNeutralBackground6:nf,colorNeutralBackgroundInverted:"#292929",colorNeutralBackgroundStatic:"#333333",colorNeutralBackgroundAlpha:uf,colorNeutralBackgroundAlpha2:"rgba(255, 255, 255, 0.8)",colorSubtleBackground:"transparent",colorSubtleBackgroundHover:sf,colorSubtleBackgroundPressed:rf,colorSubtleBackgroundSelected:of,colorSubtleBackgroundLightAlphaHover:"rgba(255, 255, 255, 0.7)",colorSubtleBackgroundLightAlphaPressed:uf,colorSubtleBackgroundLightAlphaSelected:"transparent",colorSubtleBackgroundInverted:"transparent",colorSubtleBackgroundInvertedHover:hf,colorSubtleBackgroundInvertedPressed:"rgba(0, 0, 0, 0.3)",colorSubtleBackgroundInvertedSelected:"rgba(0, 0, 0, 0.2)",colorTransparentBackground:"transparent",colorTransparentBackgroundHover:"transparent",colorTransparentBackgroundPressed:"transparent",colorTransparentBackgroundSelected:"transparent",colorNeutralBackgroundDisabled:af,colorNeutralBackgroundInvertedDisabled:"rgba(255, 255, 255, 0.1)",colorNeutralStencil1:nf,colorNeutralStencil2:cf,colorNeutralStencil1Alpha:hf,colorNeutralStencil2Alpha:df,colorBackgroundOverlay:"rgba(0, 0, 0, 0.4)",colorScrollbarOverlay:"rgba(0, 0, 0, 0.5)",colorBrandBackground:e[80],colorBrandBackgroundHover:e[70],colorBrandBackgroundPressed:e[40],colorBrandBackgroundSelected:e[60],colorCompoundBrandBackground:e[80],colorCompoundBrandBackgroundHover:e[70],colorCompoundBrandBackgroundPressed:e[60],colorBrandBackgroundStatic:e[80],colorBrandBackground2:e[160],colorBrandBackground2Hover:e[150],colorBrandBackground2Pressed:e[130],colorBrandBackground3Static:e[60],colorBrandBackground4Static:e[40],colorBrandBackgroundInverted:gf,colorBrandBackgroundInvertedHover:e[160],colorBrandBackgroundInvertedPressed:e[140],colorBrandBackgroundInvertedSelected:e[150],colorNeutralCardBackground:cf,colorNeutralCardBackgroundHover:gf,colorNeutralCardBackgroundPressed:sf,colorNeutralCardBackgroundSelected:of,colorNeutralCardBackgroundDisabled:af,colorNeutralStrokeAccessible:ef,colorNeutralStrokeAccessibleHover:"#575757",colorNeutralStrokeAccessiblePressed:"#4d4d4d",colorNeutralStrokeAccessibleSelected:e[80],colorNeutralStroke1:"#d1d1d1",colorNeutralStroke1Hover:"#c7c7c7",colorNeutralStroke1Pressed:"#b3b3b3",colorNeutralStroke1Selected:tf,colorNeutralStroke2:rf,colorNeutralStroke3:af,colorNeutralStrokeSubtle:rf,colorNeutralStrokeOnBrand:gf,colorNeutralStrokeOnBrand2:gf,colorNeutralStrokeOnBrand2Hover:gf,colorNeutralStrokeOnBrand2Pressed:gf,colorNeutralStrokeOnBrand2Selected:gf,colorBrandStroke1:e[80],colorBrandStroke2:e[140],colorBrandStroke2Hover:e[120],colorBrandStroke2Pressed:e[80],colorBrandStroke2Contrast:e[140],colorCompoundBrandStroke:e[80],colorCompoundBrandStrokeHover:e[70],colorCompoundBrandStrokePressed:e[60],colorNeutralStrokeDisabled:rf,colorNeutralStrokeInvertedDisabled:lf,colorTransparentStroke:"transparent",colorTransparentStrokeInteractive:"transparent",colorTransparentStrokeDisabled:"transparent",colorNeutralStrokeAlpha:df,colorNeutralStrokeAlpha2:"rgba(255, 255, 255, 0.2)",colorStrokeFocus1:gf,colorStrokeFocus2:"#000000",colorNeutralShadowAmbient:"rgba(0,0,0,0.12)",colorNeutralShadowKey:"rgba(0,0,0,0.14)",colorNeutralShadowAmbientLighter:"rgba(0,0,0,0.06)",colorNeutralShadowKeyLighter:"rgba(0,0,0,0.07)",colorNeutralShadowAmbientDarker:"rgba(0,0,0,0.20)",colorNeutralShadowKeyDarker:"rgba(0,0,0,0.24)",colorBrandShadowAmbient:"rgba(0,0,0,0.30)",colorBrandShadowKey:"rgba(0,0,0,0.25)"}))({10:"#061724",20:"#082338",30:"#0a2e4a",40:"#0c3b5e",50:"#0e4775",60:"#0f548c",70:"#115ea3",80:"#0f6cbd",90:"#2886de",100:"#479ef5",110:"#62abf5",120:"#77b7f7",130:"#96c6fa",140:"#b4d6fa",150:"#cfe4fa",160:"#ebf3fc"});return{...Af,...Tf,...Sf,..._f,...Ef,...Pf,...Lf,...Hf,...Of,...Mf,...e,...kf,...If,...Rf(e.colorNeutralShadowAmbient,e.colorNeutralShadowKey),...Rf(e.colorBrandShadowAmbient,e.colorBrandShadowKey,"Brand")}})();var jf=document.getElementById("container"),$f=jf?(0,i.H)(jf):void 0;Office.onReady(function(){null==$f||$f.render(n.createElement(Yp,{theme:Uf},n.createElement(Bg,{title:"Contoso Task Pane Add-in"})))})},74848:function(e,t,r){"use strict";e.exports=r(21020)}},function(e){var t=function(t){return e(e.s=t)};t(48561),t(39046)}]);
//# sourceMappingURL=taskpane.js.map